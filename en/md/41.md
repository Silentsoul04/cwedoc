# ID: 41 - Improper Resolution of Path Equivalence
<h5>Name</h5>Improper Resolution of Path Equivalence
<h5>Weakness</h5>Base
<h5>Status</h5>Incomplete
<h5>Description</h5>The system or application is vulnerable to file system contents disclosure through path equivalence. Path equivalence involves the use of special characters in file and directory names. The associated manipulations are intended to generate multiple names for the same object.
<h5>ExtendedDescription</h5>Path equivalence is usually employed in order to circumvent access controls expressed using an incomplete set of file name or file path representations. This is different from path traversal, wherein the manipulations are performed to generate a name for a different object.
<h5>RelatedWeaknesses</h5>::NATURE:ChildOf:CWE ID:706:VIEW ID:1000:ORDINAL:Primary::
<h5>WeaknessOrdinalities</h5>null
<h5>ApplicablePlatforms</h5>:::LANGUAGE CLASS:Language-Independent:LANGUAGE PREVALENCE:Undetermined::
<h5>BackgroundDetails</h5>null
<h5>AlternateTerms</h5>null
<h5>ModesOfIntroduction</h5>:::PHASE:Implementation:DESCRIPTION:::
<h5>ExploitationFactors</h5>null
<h5>LikelihoodofExploit</h5>null
<h5>CommonConsequences</h5>::SCOPE:Confidentiality:SCOPE:Integrity:SCOPE:Access Control:TECHNICAL IMPACT:Read Files or Directories Modify Files or Directories Bypass Protection Mechanism:NOTE:Confidentiality Integrity Access Control Read Files or Directories Modify Files or Directories Bypass Protection Mechanism An attacker may be able to traverse the file system to unintended locations and read or overwrite the contents of unexpected files. If the files are used for a security mechanism than an attacker may be able to bypass the mechanism.::
<h5>DetectionMethods</h5>::METHOD:Automated Static Analysis - Binary or Bytecode:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Bytecode Weakness Analysis - including disassembler + source code weakness analysis::METHOD:Manual Static Analysis - Binary or Bytecode:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Binary / Bytecode disassembler - then use manual analysis for vulnerabilities & anomalies::METHOD:Dynamic Analysis with Automated Results Interpretation:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Web Application Scanner Web Services Scanner Database Scanners::METHOD:Dynamic Analysis with Manual Results Interpretation:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Fuzz Tester Framework-based Fuzzer::METHOD:Manual Static Analysis - Source Code:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Focused Manual Spotcheck - Focused manual analysis of source Manual Source Code Review (not inspections)::METHOD:Automated Static Analysis - Source Code:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Source code Weakness Analyzer Context-configured Source Code Weakness Analyzer::METHOD:Architecture or Design Review:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Formal Methods / Correct-By-Construction Cost effective for partial coverage: Inspection (IEEE 1028 standard) (can apply to requirements, design, source code, etc.)::
<h5>PotentialMitigations</h5>::PHASE:Implementation:STRATEGY:Input Validation:EFFECTIVENESS::DESCRIPTION:Assume all input is malicious. Use an accept known good input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does. When performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, boat may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as red or blue. Do not rely exclusively on looking for malicious or malformed inputs (i.e., do not rely on a blacklist). A blacklist is likely to miss at least one undesirable input, especially if the code's environment changes. This can give attackers enough room to bypass the intended validation. However, blacklists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.::PHASE:Implementation:STRATEGY:Output Encoding:EFFECTIVENESS::DESCRIPTION:Use and specify an output encoding that can be handled by the downstream component that is reading the output. Common encodings include ISO-8859-1, UTF-7, and UTF-8. When an encoding is not specified, a downstream component may choose a different encoding, either by assuming a default encoding or automatically inferring which encoding is being used, which can be erroneous. When the encodings are inconsistent, the downstream component might treat some character or byte sequences as special, even if they are not special in the original encoding. Attackers might then be able to exploit this discrepancy and conduct injection attacks; they even might be able to bypass protection mechanisms that assume the original encoding is also being used by the downstream component.::PHASE:Implementation:STRATEGY:Input Validation:EFFECTIVENESS::DESCRIPTION:Inputs should be decoded and canonicalized to the application's current internal representation before being validated (CWE-180). Make sure that the application does not decode the same input twice (CWE-174). Such errors could be used to bypass whitelist validation schemes by introducing dangerous inputs after they have been checked.::
<h5>ObservedExamples</h5>::REFERENCE:CVE-2000-1114:DESCRIPTION:Source code disclosure using trailing dot:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1114REFERENCE:CVE-2002-1986,:DESCRIPTION:Source code disclosure using trailing dot:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1986,REFERENCE:CVE-2004-2213:DESCRIPTION:Source code disclosure using trailing dot or trailing encoding space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2213REFERENCE:CVE-2005-3293:DESCRIPTION:Source code disclosure using trailing dot:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3293REFERENCE:CVE-2004-0061:DESCRIPTION:Bypass directory access restrictions using trailing dot in URL:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0061REFERENCE:CVE-2000-1133:DESCRIPTION:Bypass directory access restrictions using trailing dot in URL:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1133REFERENCE:CVE-2001-1386:DESCRIPTION:Bypass check for .lnk extension using .lnk.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1386REFERENCE:CVE-2001-0693:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0693REFERENCE:CVE-2001-0778:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0778REFERENCE:CVE-2001-1248:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1248REFERENCE:CVE-2004-0280:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0280REFERENCE:CVE-2005-0622:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0622REFERENCE:CVE-2005-1656:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1656REFERENCE:CVE-2002-1603:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1603REFERENCE:CVE-2001-0054:DESCRIPTION:Multi-Factor Vulnerability (MVF). directory traversal and other issues in FTP server using Web encodings such as %20; certain manipulations have unusual side effects.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0054REFERENCE:CVE-2002-1451:DESCRIPTION:Trailing space (+ in query string) leads to source code disclosure.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1451REFERENCE:CVE-2000-0293:DESCRIPTION:Filenames with spaces allow arbitrary file deletion when the product does not properly quote them; some overlap with path traversal.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0293REFERENCE:CVE-2001-1567:DESCRIPTION:+ characters in query string converted to spaces before sensitive file/extension (internal space), leading to bypass of access restrictions to the file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1567REFERENCE:CVE-2002-0253:DESCRIPTION:Overlaps infoleak:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0253REFERENCE:CVE-2001-0446:DESCRIPTION:Application server allows remote attackers to read source code for .jsp files by appending a / to the requested URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0446REFERENCE:CVE-2004-0334:DESCRIPTION:Bypass Basic Authentication for files using trailing /:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0334REFERENCE:CVE-2001-0893:DESCRIPTION:Read sensitive files with trailing /:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0893REFERENCE:CVE-2001-0892:DESCRIPTION:Web server allows remote attackers to view sensitive files under the document root (such as .htpasswd) via a GET request with a trailing /.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0892REFERENCE:CVE-2004-1814:DESCRIPTION:Directory traversal vulnerability in server allows remote attackers to read protected files via .. (dot dot) sequences in an HTTP request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1814REFERENCE:BID:3518:DESCRIPTION:Source code disclosure:LINK:http://www.securityfocus.com/bid/3518REFERENCE:CVE-2002-1483:DESCRIPTION:Read files with full pathname using multiple internal slash.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1483REFERENCE:CVE-1999-1456:DESCRIPTION:Server allows remote attackers to read arbitrary files via a GET request with more than one leading / (slash) character in the filename.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1456REFERENCE:CVE-2004-0578:DESCRIPTION:Server allows remote attackers to read arbitrary files via leading slash (//) characters in a URL request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0578REFERENCE:CVE-2002-0275:DESCRIPTION:Server allows remote attackers to bypass authentication and read restricted files via an extra / (slash) in the requested URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0275REFERENCE:CVE-2004-1032:DESCRIPTION:Product allows local users to delete arbitrary files or create arbitrary empty files via a target filename with a large number of leading slash (/) characters.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1032REFERENCE:CVE-2002-1238:DESCRIPTION:Server allows remote attackers to bypass access restrictions for files via an HTTP request with a sequence of multiple / (slash) characters such as http://www.example.com///file/.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1238REFERENCE:CVE-2004-1878:DESCRIPTION:Product allows remote attackers to bypass authentication, obtain sensitive information, or gain access via a direct request to admin/user.pl preceded by // (double leading slash).:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1878REFERENCE:CVE-2005-1365:DESCRIPTION:Server allows remote attackers to execute arbitrary commands via a URL with multiple leading / (slash) characters and .. sequences.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1365REFERENCE:CVE-2000-1050:DESCRIPTION:Access directory using multiple leading slash.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1050REFERENCE:CVE-2001-1072:DESCRIPTION:Bypass access restrictions via multiple leading slash, which causes a regular expression to fail.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1072REFERENCE:CVE-2004-0235:DESCRIPTION:Archive extracts to arbitrary files using multiple leading slash in filenames in the archive.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0235REFERENCE:CVE-2002-1078:DESCRIPTION:Directory listings in web server using multiple trailing slash:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1078REFERENCE:CVE-2004-0847:DESCRIPTION:ASP.NET allows remote attackers to bypass authentication for .aspx files in restricted directories via a request containing a (1) (backslash) or (2) %5C (encoded backslash), aka Path Validation Vulnerability.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0847REFERENCE:CVE-2000-0004:DESCRIPTION:Server allows remote attackers to read source code for executable files by inserting a . (dot) into the URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0004REFERENCE:CVE-2002-0304:DESCRIPTION:Server allows remote attackers to read password-protected files via a /./ in the HTTP request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0304REFERENCE:BID:6042:DESCRIPTION:Input Validation error:LINK:http://www.securityfocus.com/bid/6042REFERENCE:CVE-1999-1083:DESCRIPTION:Possibly (could be a cleansing error):LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1083REFERENCE:CVE-2004-0815:DESCRIPTION:/./////etc cleansed to .///etc then /etc:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0815REFERENCE:CVE-2002-0112:DESCRIPTION:Server allows remote attackers to view password protected files via /./ in the URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0112REFERENCE:CVE-2004-0696:DESCRIPTION:List directories using desired path and *:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0696REFERENCE:CVE-2002-0433:DESCRIPTION:List files in web server using *.ext:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0433REFERENCE:CVE-2001-1152:DESCRIPTION:Proxy allows remote attackers to bypass blacklist restrictions and connect to unauthorized web servers by modifying the requested URL, including (1) a // (double slash), (2) a /SUBDIR/.. where the desired file is in the parentdir, (3) a /./, or (4) URL-encoded characters.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1152REFERENCE:CVE-2000-0191:DESCRIPTION:application check access for restricted URL before canonicalization:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0191REFERENCE:CVE-2005-1366:DESCRIPTION:CGI source disclosure using dirname/../cgi-bin:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1366REFERENCE:CVE-1999-0012:DESCRIPTION:Multiple web servers allow restriction bypass using 8.3 names instead of long names:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0012REFERENCE:CVE-2001-0795:DESCRIPTION:Source code disclosure using 8.3 file name.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0795REFERENCE:CVE-2005-0471:DESCRIPTION:Multi-Factor Vulnerability. Product generates temporary filenames using long filenames, which become predictable in 8.3 format.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0471
<h5>FunctionalAreas</h5>null
<h5>AffectedResources</h5>File or Directory::
<h5>TaxonomyMappings</h5>TAXONOMY NAME:PLOVER:ENTRY NAME:Path Equivalence::::TAXONOMY NAME:CERT C Secure Coding:ENTRY ID:FIO02-C:ENTRY NAME:Canonicalize path names originating from untrusted sources::
<h5>RelatedAttackPatterns</h5>::3::4::
<h5>Notes</h5>TYPE:Relationship:NOTE:Some of these manipulations could be effective in path traversal issues, too.::

