# ID: 823 - Use of Out-of-range Pointer Offset
<h5>Name</h5>Use of Out-of-range Pointer Offset
<h5>Weakness</h5>Base
<h5>Status</h5>Incomplete
<h5>Description</h5>The program performs pointer arithmetic on a valid pointer, but it uses an offset that can point outside of the intended range of valid memory locations for the resulting pointer.
<h5>ExtendedDescription</h5>While a pointer can contain a reference to any arbitrary memory location, a program typically only intends to use the pointer to access limited portions of memory, such as contiguous memory used to access an individual array. Programs may use offsets in order to access fields or sub-elements stored within structured data. The offset might be out-of-range if it comes from an untrusted source, is the result of an incorrect calculation, or occurs because of another error. If an attacker can control or influence the offset so that it points outside of the intended boundaries of the structure, then the attacker may be able to read or write to memory locations that are used elsewhere in the program. As a result, the attack might change the state of the software as accessed through program variables, cause a crash or instable behavior, and possibly lead to code execution.
<h5>RelatedWeaknesses</h5>::NATURE:ChildOf:CWE ID:119:VIEW ID:1000:ORDINAL:Primary::NATURE:ChildOf:CWE ID:119:VIEW ID:699:ORDINAL:Primary::NATURE:CanPrecede:CWE ID:125:VIEW ID:1000::NATURE:CanPrecede:CWE ID:787:VIEW ID:1000::
<h5>WeaknessOrdinalities</h5>null
<h5>ApplicablePlatforms</h5>null
<h5>BackgroundDetails</h5>null
<h5>AlternateTerms</h5>::TERM:Untrusted pointer offset:DESCRIPTION:This term is narrower than the concept of out-of-range offset, since the offset might be the result of a calculation or other error that does not depend on any externally-supplied values.::
<h5>ModesOfIntroduction</h5>null
<h5>ExploitationFactors</h5>null
<h5>LikelihoodofExploit</h5>null
<h5>CommonConsequences</h5>::SCOPE:Confidentiality:TECHNICAL IMPACT:Read Memory:NOTE:Confidentiality Read Memory If the untrusted pointer is used in a read operation, an attacker might be able to read sensitive portions of memory.::SCOPE:Availability:TECHNICAL IMPACT:DoS: Crash, Exit, or Restart:NOTE:Availability DoS: Crash, Exit, or Restart If the untrusted pointer references a memory location that is not accessible to the program, or points to a location that is malformed or larger than expected by a read or write operation, the application may terminate unexpectedly.::SCOPE:Integrity:SCOPE:Confidentiality:SCOPE:Availability:TECHNICAL IMPACT:Execute Unauthorized Code or Commands Modify Memory:NOTE:Integrity Confidentiality Availability Execute Unauthorized Code or Commands Modify Memory If the untrusted pointer is used in a function call, or points to unexpected data in a write operation, then code execution may be possible.::
<h5>DetectionMethods</h5>null
<h5>PotentialMitigations</h5>null
<h5>ObservedExamples</h5>::REFERENCE:CVE-2010-2160:DESCRIPTION:Invalid offset in undocumented opcode leads to memory corruption.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2160REFERENCE:CVE-2010-1281:DESCRIPTION:Multimedia player uses untrusted value from a file when using file-pointer calculations.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1281REFERENCE:CVE-2009-3129:DESCRIPTION:Spreadsheet program processes a record with an invalid size field, which is later used as an offset.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3129REFERENCE:CVE-2009-2694:DESCRIPTION:Instant messaging library does not validate an offset value specified in a packet.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2694REFERENCE:CVE-2009-2687:DESCRIPTION:Language interpreter does not properly handle invalid offsets in JPEG image, leading to out-of-bounds memory access and crash.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2687REFERENCE:CVE-2009-0690:DESCRIPTION:negative offset leads to out-of-bounds read:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0690REFERENCE:CVE-2008-4114:DESCRIPTION:untrusted offset in kernel:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4114REFERENCE:CVE-2010-2873:DESCRIPTION:blind trust of an offset value while writing heap memory allows corruption of function pointer,leading to code execution:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2873REFERENCE:CVE-2010-2866:DESCRIPTION:negative value (signed) causes pointer miscalculation:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2866REFERENCE:CVE-2010-2872:DESCRIPTION:signed values cause incorrect pointer calculation:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2872REFERENCE:CVE-2007-5657:DESCRIPTION:values used as pointer offsets:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5657REFERENCE:CVE-2010-2867:DESCRIPTION:a return value from a function is sign-extended if the value is signed, then used as an offset for pointer arithmetic:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2867REFERENCE:CVE-2009-1097:DESCRIPTION:portions of a GIF image used as offsets, causing corruption of an object pointer.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1097REFERENCE:CVE-2008-1807:DESCRIPTION:invalid numeric field leads to a free of arbitrary memory locations, then code execution.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1807REFERENCE:CVE-2007-2500:DESCRIPTION:large number of elements leads to a free of an arbitrary address:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-2500REFERENCE:CVE-2008-1686:DESCRIPTION:array index issue (CWE-129) with negative offset, used to dereference a function pointer:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1686REFERENCE:CVE-2010-2878:DESCRIPTION:buffer seek value - basically an offset?:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2878
<h5>FunctionalAreas</h5>null
<h5>AffectedResources</h5>null
<h5>TaxonomyMappings</h5>null
<h5>RelatedAttackPatterns</h5>null
<h5>Notes</h5>TYPE:Maintenance:NOTE:There are close relationships between incorrect pointer dereferences and other weaknesses related to buffer operations. There may not be sufficient community agreement regarding these relationships. Further study is needed to determine when these relationships are chains, composites, perspective/layering, or other types of relationships. As of September 2010, most of the relationships are being captured as chains.::::TYPE:Terminology:NOTE:Many weaknesses related to pointer dereferences fall under the general term of memory corruption or memory safety. As of September 2010, there is no commonly-used terminology that covers the lower-level variants.::::TYPE:Research Gap:NOTE:Under-studied and probably under-reported as of September 2010. This weakness has been reported in high-visibility software, but applied vulnerability researchers have only been investigating it since approximately 2008, and there are only a few public reports. Few reports identify weaknesses at such a low level, which makes it more difficult to find and study real-world code examples.::

