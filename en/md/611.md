# ID: 611 - Improper Restriction of XML External Entity Reference ('XXE')
<h5>Name</h5>Improper Restriction of XML External Entity Reference ('XXE')
<h5>Weakness</h5>Variant
<h5>Status</h5>Draft
<h5>Description</h5>The software processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.
<h5>ExtendedDescription</h5>XML documents optionally contain a Document Type Definition (DTD), which, among other features, enables the definition of XML entities. It is possible to define an entity by providing a substitution string in the form of a URI. The XML parser can access the contents of this URI and embed these contents back into the XML document for further processing. By submitting an XML file that defines an external entity with a file:// URI, an attacker can cause the processing application to read the contents of a local file. For example, a URI such as file:///c:/winnt/win.ini designates (in Windows) the file C:Winntwin.ini, or file:///etc/passwd designates the password file in Unix-based systems. Using URIs with other schemes such as http://, the attacker can force the application to make outgoing requests to servers that the attacker cannot reach directly, which can be used to bypass firewall restrictions or hide the source of attacks such as port scanning. Once the content of the URI is read, it is fed back into the application that is processing the XML. This application may echo back the data (e.g. in an error message), thereby exposing the file contents.
<h5>RelatedWeaknesses</h5>::NATURE:ChildOf:CWE ID:610:VIEW ID:1000:ORDINAL:Primary::NATURE:ChildOf:CWE ID:610:VIEW ID:1003:ORDINAL:Primary::NATURE:PeerOf:CWE ID:441:VIEW ID:1000::
<h5>WeaknessOrdinalities</h5>null
<h5>ApplicablePlatforms</h5>::LANGUAGE NAME:XML:LANGUAGE PREVALENCE:Undetermined::PARADIGN NAME:Web Based:PARADIGN PREVALENCE:Undetermined::
<h5>BackgroundDetails</h5>null
<h5>AlternateTerms</h5>::TERM:XXE:DESCRIPTION:XXE is an acronym used for the term XML eXternal Entities::
<h5>ModesOfIntroduction</h5>:::PHASE:Implementation:DESCRIPTION:::
<h5>ExploitationFactors</h5>null
<h5>LikelihoodofExploit</h5>null
<h5>CommonConsequences</h5>::SCOPE:Confidentiality:TECHNICAL IMPACT:Read Application Data Read Files or Directories:NOTE:Confidentiality Read Application Data Read Files or Directories If the attacker is able to include a crafted DTD and a default entity resolver is enabled, the attacker may be able to access arbitrary files on the system.::SCOPE:Integrity:TECHNICAL IMPACT:Bypass Protection Mechanism:NOTE:Integrity Bypass Protection Mechanism The DTD may include arbitrary HTTP requests that the server may execute. This could lead to other attacks leveraging the server's trust relationship with other entities.::SCOPE:Availability:TECHNICAL IMPACT:DoS: Resource Consumption (CPU) DoS: Resource Consumption (Memory):NOTE:Availability DoS: Resource Consumption (CPU) DoS: Resource Consumption (Memory) The software could consume excessive CPU cycles or memory using a URI that points to a large file, or a device that always returns data such as /dev/random. Alternately, the URI could reference a file that contains many nested or recursive entity references to further slow down parsing.::
<h5>DetectionMethods</h5>null
<h5>PotentialMitigations</h5>::PHASE:Implementation System Configuration:STRATEGY::EFFECTIVENESS::DESCRIPTION:Many XML parsers and validators can be configured to disable external entity expansion.::
<h5>ObservedExamples</h5>::REFERENCE:CVE-2005-1306:DESCRIPTION:A browser control can allow remote attackers to determine the existence of files via Javascript containing XML script.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1306REFERENCE:CVE-2012-5656:DESCRIPTION:XXE during SVG image conversion:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5656REFERENCE:CVE-2012-2239:DESCRIPTION:XXE in PHP application allows reading the application's configuration file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2239REFERENCE:CVE-2012-3489:DESCRIPTION:XXE in database server:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3489REFERENCE:CVE-2012-4399:DESCRIPTION:XXE in rapid web application development framework allows reading arbitrary files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4399REFERENCE:CVE-2012-3363:DESCRIPTION:XXE via XML-RPC request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3363REFERENCE:CVE-2012-0037:DESCRIPTION:XXE in office document product using RDF.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0037REFERENCE:CVE-2011-4107:DESCRIPTION:XXE in web-based administration tool for database.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4107REFERENCE:CVE-2010-3322:DESCRIPTION:XXE in product that performs large-scale data analysis.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3322REFERENCE:CVE-2009-1699:DESCRIPTION:XXE in XSL stylesheet functionality in a common library used by some web browsers.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1699
<h5>FunctionalAreas</h5>null
<h5>AffectedResources</h5>null
<h5>TaxonomyMappings</h5>TAXONOMY NAME:WASC:ENTRY ID:43:ENTRY NAME:XML External Entities::::TAXONOMY NAME:Software Fault Patterns:ENTRY ID:SFP24:ENTRY NAME:Tainted input to command::
<h5>RelatedAttackPatterns</h5>null
<h5>Notes</h5>TYPE:Relationship:NOTE:CWE-918 (SSRF) and CWE-611 (XXE) are closely related, because they both involve web-related technologies and can launch outbound requests to unexpected destinations. However, XXE can be performed client-side, or in other contexts in which the software is not acting directly as a server, so the Server portion of the SSRF acronym does not necessarily apply.::

