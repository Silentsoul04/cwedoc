# ID: 61 - UNIX Symbolic Link (Symlink) Following
<h5>Name</h5>UNIX Symbolic Link (Symlink) Following
<h5>Weakness</h5>Compound
<h5>Status</h5>Incomplete
<h5>Description</h5>The software, when opening a file or directory, does not sufficiently account for when the file is a symbolic link that resolves to a target outside of the intended control sphere. This could allow an attacker to cause the software to operate on unauthorized files.
<h5>ExtendedDescription</h5>A software system that allows UNIX symbolic links (symlink) as part of paths whether in internal code or through user input can allow an attacker to spoof the symbolic link and traverse the file system to unintended locations or access arbitrary files. The symbolic link can permit an attacker to read/write/corrupt a file that they originally did not have permissions to access.
<h5>RelatedWeaknesses</h5>::NATURE:ChildOf:CWE ID:59:VIEW ID:1000:ORDINAL:Primary::NATURE:ChildOf:CWE ID:59:VIEW ID:699:ORDINAL:Primary::NATURE:Requires:CWE ID:362:VIEW ID:1000::NATURE:Requires:CWE ID:340:VIEW ID:1000::NATURE:Requires:CWE ID:216:VIEW ID:1000::NATURE:Requires:CWE ID:386:VIEW ID:1000::NATURE:Requires:CWE ID:732:VIEW ID:1000::
<h5>WeaknessOrdinalities</h5>::ORDINALITY:Resultant:DESCRIPTION:::
<h5>ApplicablePlatforms</h5>:::LANGUAGE CLASS:Language-Independent:LANGUAGE PREVALENCE:Undetermined::
<h5>BackgroundDetails</h5>null
<h5>AlternateTerms</h5>::TERM:Symlink following:DESCRIPTION:::TERM:symlink vulnerability:DESCRIPTION:::
<h5>ModesOfIntroduction</h5>:::PHASE:Implementation:DESCRIPTION:::
<h5>ExploitationFactors</h5>null
<h5>LikelihoodofExploit</h5>null
<h5>CommonConsequences</h5>::SCOPE:Confidentiality:SCOPE:Integrity:TECHNICAL IMPACT:Read Files or Directories Modify Files or Directories::
<h5>DetectionMethods</h5>null
<h5>PotentialMitigations</h5>::PHASE:Implementation:STRATEGY::EFFECTIVENESS::DESCRIPTION:Symbolic link attacks often occur when a program creates a tmp directory that stores files/links. Access to the directory should be restricted to the program as to prevent attackers from manipulating the files.::PHASE:Architecture and Design:STRATEGY:Separation of Privilege:EFFECTIVENESS::DESCRIPTION:Follow the principle of least privilege when assigning access rights to entities in a software system. Denying access to a file can prevent an attacker from replacing that file with a link to a sensitive file. Ensure good compartmentalization in the system to provide protected areas that can be trusted.::
<h5>ObservedExamples</h5>::REFERENCE:CVE-1999-1386:DESCRIPTION:Some versions of Perl follows symbolic links when running with the -e option, which allows local users to overwrite arbitrary files via a symlink attack.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1386REFERENCE:CVE-2000-1178:DESCRIPTION:Text editor follows symbolic links when creating a rescue copy during an abnormal exit, which allows local users to overwrite the files of other users.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1178REFERENCE:CVE-2004-0217:DESCRIPTION:Antivirus update allows local users to create or append to arbitrary files via a symlink attack on a logfile.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0217REFERENCE:CVE-2003-0517:DESCRIPTION:Symlink attack allows local users to overwrite files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0517REFERENCE:CVE-2004-0689:DESCRIPTION:Possible interesting example:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0689REFERENCE:CVE-2005-1879:DESCRIPTION:Second-order symlink vulnerabilities:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1879REFERENCE:CVE-2005-1880:DESCRIPTION:Second-order symlink vulnerabilities:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1880REFERENCE:CVE-2005-1916:DESCRIPTION:Symlink in Python program:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1916REFERENCE:CVE-2000-0972:DESCRIPTION:Setuid product allows file reading by replacing a file being edited with a symlink to the targeted file, leaking the result in error messages when parsing fails.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0972REFERENCE:CVE-2005-0824:DESCRIPTION:Signal causes a dump that follows symlinks.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0824
<h5>FunctionalAreas</h5>null
<h5>AffectedResources</h5>null
<h5>TaxonomyMappings</h5>TAXONOMY NAME:PLOVER:ENTRY NAME:UNIX symbolic link following::
<h5>RelatedAttackPatterns</h5>::27::
<h5>Notes</h5>TYPE:Research Gap:NOTE:Symlink vulnerabilities are regularly found in C and shell programs, but all programming languages can have this problem. Even shell programs are probably under-reported. Second-order symlink vulnerabilities may exist in programs that invoke other programs that follow symlinks. They are rarely reported but are likely to be fairly common when process invocation is used. Reference: [Christey2005]::

