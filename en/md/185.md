# ID: 185 - Incorrect Regular Expression
<h5>Name</h5>Incorrect Regular Expression
<h5>Weakness</h5>Class
<h5>Status</h5>Draft
<h5>Description</h5>The software specifies a regular expression in a way that causes data to be improperly matched or compared.
<h5>ExtendedDescription</h5>When the regular expression is used in protection mechanisms such as filtering or validation, this may allow an attacker to bypass the intended restrictions on the incoming data.
<h5>RelatedWeaknesses</h5>::NATURE:ChildOf:CWE ID:697:VIEW ID:1000:ORDINAL:Primary::NATURE:CanPrecede:CWE ID:187:VIEW ID:1000::NATURE:CanPrecede:CWE ID:182:VIEW ID:1000::
<h5>WeaknessOrdinalities</h5>null
<h5>ApplicablePlatforms</h5>:::LANGUAGE CLASS:Language-Independent:LANGUAGE PREVALENCE:Undetermined::
<h5>BackgroundDetails</h5>null
<h5>AlternateTerms</h5>null
<h5>ModesOfIntroduction</h5>:::PHASE:Implementation:DESCRIPTION:::
<h5>ExploitationFactors</h5>null
<h5>LikelihoodofExploit</h5>null
<h5>CommonConsequences</h5>::SCOPE:Other:TECHNICAL IMPACT:Unexpected State Varies by Context:NOTE:Other Unexpected State Varies by Context When the regular expression is not correctly specified, data might have a different format or type than the rest of the program expects, producing resultant weaknesses or errors.::SCOPE:Access Control:TECHNICAL IMPACT:Bypass Protection Mechanism:NOTE:Access Control Bypass Protection Mechanism In PHP, regular expression checks can sometimes be bypassed with a null byte, leading to any number of weaknesses.::
<h5>DetectionMethods</h5>null
<h5>PotentialMitigations</h5>::PHASE:Architecture and Design:STRATEGY:Refactoring:EFFECTIVENESS::DESCRIPTION:Regular expressions can become error prone when defining a complex language even for those experienced in writing grammars. Determine if several smaller regular expressions simplify one large regular expression. Also, subject the regular expression to thorough testing techniques such as equivalence partitioning, boundary value analysis, and robustness. After testing and a reasonable confidence level is achieved, a regular expression may not be foolproof. If an exploit is allowed to slip through, then record the exploit and refactor the regular expression.::
<h5>ObservedExamples</h5>::REFERENCE:CVE-2002-2109:DESCRIPTION:Regexp isn't anchored to the beginning or end, which allows spoofed values that have trusted values as substrings.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-2109REFERENCE:CVE-2005-1949:DESCRIPTION:Regexp for IP address isn't anchored at the end, allowing appending of shell metacharacters.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1949REFERENCE:CVE-2001-1072:DESCRIPTION:Bypass access restrictions via multiple leading slash, which causes a regular expression to fail.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1072REFERENCE:CVE-2000-0115:DESCRIPTION:Local user DoS via invalid regular expressions.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0115REFERENCE:CVE-2002-1527:DESCRIPTION:chain: Malformed input generates a regular expression error that leads to information exposure.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1527REFERENCE:CVE-2005-1061:DESCRIPTION:Certain strings are later used in a regexp, leading to a resultant crash.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1061REFERENCE:CVE-2005-2169:DESCRIPTION:MFV. Regular expression intended to protect against directory traversal reduces .../...// to ../.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2169REFERENCE:CVE-2005-0603:DESCRIPTION:Malformed regexp syntax leads to information exposure in error message.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0603REFERENCE:CVE-2005-1820:DESCRIPTION:Code injection due to improper quoting of regular expression.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1820REFERENCE:CVE-2005-3153:DESCRIPTION:Null byte bypasses PHP regexp check.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3153REFERENCE:CVE-2005-4155:DESCRIPTION:Null byte bypasses PHP regexp check.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4155
<h5>FunctionalAreas</h5>null
<h5>AffectedResources</h5>null
<h5>TaxonomyMappings</h5>TAXONOMY NAME:PLOVER:ENTRY NAME:Regular Expression Error::
<h5>RelatedAttackPatterns</h5>::15::174::6::79::
<h5>Notes</h5>TYPE:Relationship:NOTE:While there is some overlap with whitelist/blacklist problems, this entry is intended to deal with incorrectly written regular expressions, regardless of their intended use. Not every regular expression is intended for use as a whitelist or blacklist. In addition, whitelists and blacklists can be implemented using other mechanisms besides regular expressions.::::TYPE:Research Gap:NOTE:Regexp errors are likely a primary factor in many MFVs, especially those that require multiple manipulations to exploit. However, they are rarely diagnosed at this level of detail.::

