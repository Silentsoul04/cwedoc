# ID: 59 - Improper Link Resolution Before File Access ('Link Following')
<h5>Name</h5>Improper Link Resolution Before File Access ('Link Following')
<h5>Weakness</h5>Base
<h5>Status</h5>Draft
<h5>Description</h5>The software attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.
<h5>ExtendedDescription</h5>null
<h5>RelatedWeaknesses</h5>::NATURE:ChildOf:CWE ID:706:VIEW ID:1000:ORDINAL:Primary::
<h5>WeaknessOrdinalities</h5>::ORDINALITY:Resultant:DESCRIPTION:::
<h5>ApplicablePlatforms</h5>:::LANGUAGE CLASS:Language-Independent:LANGUAGE PREVALENCE:Undetermined:::OPERATING SYSTEM CLASS:Windows:OPERATING SYSTEM PREVALENCE:Sometimes:::OPERATING SYSTEM CLASS:Unix:OPERATING SYSTEM PREVALENCE:Often::
<h5>BackgroundDetails</h5>::Soft links are a UNIX term that is synonymous with simple shortcuts on windows based platforms.::
<h5>AlternateTerms</h5>::TERM:insecure temporary file:DESCRIPTION:Some people use the phrase insecure temporary file when referring to a link following weakness, but other weaknesses can produce insecure temporary files without any symlink involvement at all.::
<h5>ModesOfIntroduction</h5>:::PHASE:Implementation:DESCRIPTION:::
<h5>ExploitationFactors</h5>null
<h5>LikelihoodofExploit</h5>null
<h5>CommonConsequences</h5>::SCOPE:Confidentiality:SCOPE:Integrity:SCOPE:Access Control:TECHNICAL IMPACT:Read Files or Directories Modify Files or Directories Bypass Protection Mechanism:NOTE:Confidentiality Integrity Access Control Read Files or Directories Modify Files or Directories Bypass Protection Mechanism An attacker may be able to traverse the file system to unintended locations and read or overwrite the contents of unexpected files. If the files are used for a security mechanism then an attacker may be able to bypass the mechanism.::SCOPE:Other:TECHNICAL IMPACT:Execute Unauthorized Code or Commands:NOTE:Other Execute Unauthorized Code or Commands Windows simple shortcuts, sometimes referred to as soft links, can be exploited remotely since a .LNK file can be uploaded like a normal file. This can enable remote execution.::
<h5>DetectionMethods</h5>::METHOD:Automated Static Analysis - Binary or Bytecode:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Bytecode Weakness Analysis - including disassembler + source code weakness analysis::METHOD:Manual Static Analysis - Binary or Bytecode:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Binary / Bytecode disassembler - then use manual analysis for vulnerabilities & anomalies::METHOD:Dynamic Analysis with Automated Results Interpretation:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Web Application Scanner Web Services Scanner Database Scanners::METHOD:Dynamic Analysis with Manual Results Interpretation:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Fuzz Tester Framework-based Fuzzer::METHOD:Manual Static Analysis - Source Code:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Focused Manual Spotcheck - Focused manual analysis of source Manual Source Code Review (not inspections)::METHOD:Automated Static Analysis - Source Code:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Source code Weakness Analyzer Context-configured Source Code Weakness Analyzer::METHOD:Architecture or Design Review:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Formal Methods / Correct-By-Construction Cost effective for partial coverage: Inspection (IEEE 1028 standard) (can apply to requirements, design, source code, etc.)::
<h5>PotentialMitigations</h5>::PHASE:Architecture and Design:STRATEGY:Separation of Privilege:EFFECTIVENESS::DESCRIPTION:Follow the principle of least privilege when assigning access rights to entities in a software system. Denying access to a file can prevent an attacker from replacing that file with a link to a sensitive file. Ensure good compartmentalization in the system to provide protected areas that can be trusted.::
<h5>ObservedExamples</h5>::REFERENCE:CVE-1999-1386:DESCRIPTION:Some versions of Perl follows symbolic links when running with the -e option, which allows local users to overwrite arbitrary files via a symlink attack.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1386REFERENCE:CVE-2000-1178:DESCRIPTION:Text editor follows symbolic links when creating a rescue copy during an abnormal exit, which allows local users to overwrite the files of other users.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1178REFERENCE:CVE-2004-0217:DESCRIPTION:Antivirus update allows local users to create or append to arbitrary files via a symlink attack on a logfile.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0217REFERENCE:CVE-2003-0517:DESCRIPTION:Symlink attack allows local users to overwrite files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0517REFERENCE:CVE-2004-0689:DESCRIPTION:Window manager does not properly handle when certain symbolic links point to stale locations, which could allow local users to create or truncate arbitrary files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0689REFERENCE:CVE-2005-1879:DESCRIPTION:Second-order symlink vulnerabilities:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1879REFERENCE:CVE-2005-1880:DESCRIPTION:Second-order symlink vulnerabilities:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1880REFERENCE:CVE-2005-1916:DESCRIPTION:Symlink in Python program:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1916REFERENCE:CVE-2000-0972:DESCRIPTION:Setuid product allows file reading by replacing a file being edited with a symlink to the targeted file, leaking the result in error messages when parsing fails.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0972REFERENCE:CVE-2005-0824:DESCRIPTION:Signal causes a dump that follows symlinks.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0824REFERENCE:CVE-2001-1494:DESCRIPTION:Hard link attack, file overwrite; interesting because program checks against soft links:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1494REFERENCE:CVE-2002-0793:DESCRIPTION:Hard link and possibly symbolic link following vulnerabilities in embedded operating system allow local users to overwrite arbitrary files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0793REFERENCE:CVE-2003-0578:DESCRIPTION:Server creates hard links and unlinks files as root, which allows local users to gain privileges by deleting and overwriting arbitrary files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0578REFERENCE:CVE-1999-0783:DESCRIPTION:Operating system allows local users to conduct a denial of service by creating a hard link from a device special file to a file on an NFS file system.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0783REFERENCE:CVE-2004-1603:DESCRIPTION:Web hosting manager follows hard links, which allows local users to read or modify arbitrary files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1603REFERENCE:CVE-2004-1901:DESCRIPTION:Package listing system allows local users to overwrite arbitrary files via a hard link attack on the lockfiles.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1901REFERENCE:CVE-2005-1111:DESCRIPTION:Hard link race condition:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1111REFERENCE:CVE-2000-0342:DESCRIPTION:Mail client allows remote attackers to bypass the user warning for executable attachments such as .exe, .com, and .bat by using a .lnk file that refers to the attachment, aka Stealth Attachment.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0342REFERENCE:CVE-2001-1042:DESCRIPTION:FTP server allows remote attackers to read arbitrary files and directories by uploading a .lnk (link) file that points to the target file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1042REFERENCE:CVE-2001-1043:DESCRIPTION:FTP server allows remote attackers to read arbitrary files and directories by uploading a .lnk (link) file that points to the target file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1043REFERENCE:CVE-2005-0587:DESCRIPTION:Browser allows remote malicious web sites to overwrite arbitrary files by tricking the user into downloading a .LNK (link) file twice, which overwrites the file that was referenced in the first .LNK file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0587REFERENCE:CVE-2001-1386:DESCRIPTION:.LNK. - .LNK with trailing dot:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1386REFERENCE:CVE-2003-1233:DESCRIPTION:Rootkits can bypass file access restrictions to Windows kernel directories using NtCreateSymbolicLinkObject function to create symbolic link:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1233REFERENCE:CVE-2002-0725:DESCRIPTION:File system allows local attackers to hide file usage activities via a hard link to the target file, which causes the link to be recorded in the audit trail instead of the target file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0725REFERENCE:CVE-2003-0844:DESCRIPTION:Web server plugin allows local users to overwrite arbitrary files via a symlink attack on predictable temporary filenames.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0844
<h5>FunctionalAreas</h5>::File Processing
<h5>AffectedResources</h5>File or Directory::
<h5>TaxonomyMappings</h5>TAXONOMY NAME:PLOVER:ENTRY NAME:Link Following::::TAXONOMY NAME:CERT C Secure Coding:ENTRY ID:FIO02-C:ENTRY NAME:Canonicalize path names originating from untrusted sources::::TAXONOMY NAME:CERT C Secure Coding:ENTRY ID:POS01-C:ENTRY NAME:Check for the existence of links when dealing with files::::TAXONOMY NAME:CERT Perl Secure Coding:ENTRY ID:FIO01-PL:ENTRY NAME:Do not operate on files that can be modified by untrusted users:MAPPING FIT:CWE More Specific::::TAXONOMY NAME:Software Fault Patterns:ENTRY ID:SFP18:ENTRY NAME:Link in resource name resolution::
<h5>RelatedAttackPatterns</h5>::132::17::35::76::
<h5>Notes</h5>TYPE:Relationship:NOTE:Link following vulnerabilities are Multi-factor Vulnerabilities (MFV). They are the combination of multiple elements: file or directory permissions, filename predictability, race conditions, and in some cases, a design limitation in which there is no mechanism for performing atomic file creation operations. Some potential factors are race conditions, permissions, and predictability.::::TYPE:Research Gap:NOTE:UNIX hard links, and Windows hard/soft links are under-studied and under-reported.::

