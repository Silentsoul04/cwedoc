# ID: 942 - Overly Permissive Cross-domain Whitelist
<h5>Name</h5>Overly Permissive Cross-domain Whitelist
<h5>Weakness</h5>Variant
<h5>Status</h5>Incomplete
<h5>Description</h5>The software uses a cross-domain policy file that includes domains that should not be trusted.
<h5>ExtendedDescription</h5>A cross-domain policy file (crossdomain.xml in Flash and clientaccesspolicy.xml in Silverlight) defines a whitelist of domains from which a server is allowed to make cross-domain requests. When making a cross-domain request, the Flash or Silverlight client will first look for the policy file on the target server. If it is found, and the domain hosting the application is explicitly allowed to make requests, the request is made. Therefore, if a cross-domain policy file includes domains that should not be trusted, such as when using wildcards, then the application could be attacked by these untrusted domains. An overly permissive policy file allows many of the same attacks seen in Cross-Site Scripting (CWE-79). Once the user has executed a malicious Flash or Silverlight application, they are vulnerable to a variety of attacks. The attacker could transfer private information, such as cookies that may include session information, from the victim's machine to the attacker. The attacker could send malicious requests to a web site on behalf of the victim, which could be especially dangerous to the site if the victim has administrator privileges to manage that site. In many cases, the attack can be launched without the victim even being aware of it.
<h5>RelatedWeaknesses</h5>::NATURE:ChildOf:CWE ID:284:VIEW ID:1000:ORDINAL:Primary::NATURE:ChildOf:CWE ID:284:VIEW ID:699:ORDINAL:Primary::NATURE:ChildOf:CWE ID:183:VIEW ID:1000::NATURE:ChildOf:CWE ID:668:VIEW ID:1000::
<h5>WeaknessOrdinalities</h5>null
<h5>ApplicablePlatforms</h5>:::LANGUAGE CLASS:Language-Independent:LANGUAGE PREVALENCE:Undetermined::PARADIGN NAME:Web Based:PARADIGN PREVALENCE:Undetermined::
<h5>BackgroundDetails</h5>null
<h5>AlternateTerms</h5>null
<h5>ModesOfIntroduction</h5>:::PHASE:Implementation:DESCRIPTION::::PHASE:Architecture and Design:DESCRIPTION:::
<h5>ExploitationFactors</h5>null
<h5>LikelihoodofExploit</h5>null
<h5>CommonConsequences</h5>::SCOPE:Confidentiality:SCOPE:Integrity:SCOPE:Availability:SCOPE:Access Control:TECHNICAL IMPACT:Execute Unauthorized Code or Commands Bypass Protection Mechanism Read Application Data Varies by Context:NOTE:Confidentiality Integrity Availability Access Control Execute Unauthorized Code or Commands Bypass Protection Mechanism Read Application Data Varies by Context An attacker may be able to bypass the web browser's same-origin policy. An attacker can exploit the weakness to manipulate or steal cookies, create requests that can be mistaken for those of a valid user, compromise confidential information, or execute malicious code on the end user systems for a variety of nefarious purposes. Other damaging attacks include the disclosure of end user files, installation of Trojan horse programs, redirecting the user to some other page or site, running ActiveX controls (under Microsoft Internet Explorer) from sites that a user perceives as trustworthy, and modifying presentation of content.::
<h5>DetectionMethods</h5>null
<h5>PotentialMitigations</h5>::PHASE:Architecture and Design:STRATEGY:Attack Surface Reduction:EFFECTIVENESS::DESCRIPTION:Avoid using wildcards in the cross-domain policy file. Any domain matching the wildcard expression will be implicitly trusted, and can perform two-way interaction with the target server.::PHASE:Architecture and Design Operation:STRATEGY:Environment Hardening:EFFECTIVENESS::DESCRIPTION:For Flash, modify crossdomain.xml to use meta-policy options such as 'master-only' or 'none' to reduce the possibility of an attacker planting extraneous cross-domain policy files on a server.::PHASE:Architecture and Design Operation:STRATEGY:Attack Surface Reduction:EFFECTIVENESS::DESCRIPTION:For Flash, modify crossdomain.xml to use meta-policy options such as 'master-only' or 'none' to reduce the possibility of an attacker planting extraneous cross-domain policy files on a server.::
<h5>ObservedExamples</h5>::REFERENCE:CVE-2012-2292:DESCRIPTION:Product has a Silverlight cross-domain policy that does not restrict access to another application, which allows remote attackers to bypass the Same Origin Policy.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2292REFERENCE:CVE-2014-2049:DESCRIPTION:The default Flash Cross Domain policies in a product allows remote attackers to access user files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2049REFERENCE:CVE-2007-6243:DESCRIPTION:Chain: Adobe Flash Player does not sufficiently restrict the interpretation and usage of cross-domain policy files, which makes it easier for remote attackers to conduct cross-domain and cross-site scripting (XSS) attacks.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6243REFERENCE:CVE-2008-4822:DESCRIPTION:Chain: Adobe Flash Player and earlier does not properly interpret policy files, which allows remote attackers to bypass a non-root domain policy.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4822REFERENCE:CVE-2010-3636:DESCRIPTION:Chain: Adobe Flash Player does not properly handle unspecified encodings during the parsing of a cross-domain policy file, which allows remote web servers to bypass intended access restrictions via unknown vectors.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3636
<h5>FunctionalAreas</h5>null
<h5>AffectedResources</h5>null
<h5>TaxonomyMappings</h5>null
<h5>RelatedAttackPatterns</h5>null
<h5>Notes</h5>null

