# ID: 271 - Privilege Dropping / Lowering Errors
<h5>Name</h5>Privilege Dropping / Lowering Errors
<h5>Weakness</h5>Class
<h5>Status</h5>Incomplete
<h5>Description</h5>The software does not drop privileges before passing control of a resource to an actor that does not have those privileges.
<h5>ExtendedDescription</h5>In some contexts, a system executing with elevated permissions will hand off a process/file/etc. to another process or user. If the privileges of an entity are not reduced, then elevated privileges are spread throughout a system and possibly to an attacker.
<h5>RelatedWeaknesses</h5>::NATURE:ChildOf:CWE ID:269:VIEW ID:1000:ORDINAL:Primary::
<h5>WeaknessOrdinalities</h5>::ORDINALITY:Primary:DESCRIPTION:::
<h5>ApplicablePlatforms</h5>:::LANGUAGE CLASS:Language-Independent:LANGUAGE PREVALENCE:Undetermined::
<h5>BackgroundDetails</h5>null
<h5>AlternateTerms</h5>null
<h5>ModesOfIntroduction</h5>:::PHASE:Architecture and Design:DESCRIPTION::::PHASE:Implementation:DESCRIPTION::::PHASE:Operation:DESCRIPTION:::
<h5>ExploitationFactors</h5>null
<h5>LikelihoodofExploit</h5>null
<h5>CommonConsequences</h5>::SCOPE:Access Control:TECHNICAL IMPACT:Gain Privileges or Assume Identity:NOTE:Access Control Gain Privileges or Assume Identity If privileges are not dropped, neither are access rights of the user. Often these rights can be prevented from being dropped.::SCOPE:Access Control:SCOPE:Non-Repudiation:TECHNICAL IMPACT:Gain Privileges or Assume Identity Hide Activities:NOTE:Access Control Non-Repudiation Gain Privileges or Assume Identity Hide Activities If privileges are not dropped, in some cases the system may record actions as the user which is being impersonated rather than the impersonator.::
<h5>DetectionMethods</h5>null
<h5>PotentialMitigations</h5>::PHASE:Architecture and Design:STRATEGY:Separation of Privilege:EFFECTIVENESS::DESCRIPTION:Compartmentalize the system to have safe areas where trust boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the trust boundary and always be careful when interfacing with a compartment outside of the safe area. Ensure that appropriate compartmentalization is built into the system design and that the compartmentalization serves to allow for and further reinforce privilege separation functionality. Architects and designers should rely on the principle of least privilege to decide when it is appropriate to use and to drop system privileges.::PHASE:Architecture and Design Operation:STRATEGY::EFFECTIVENESS::DESCRIPTION:Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software.::PHASE:Architecture and Design:STRATEGY:Separation of Privilege:EFFECTIVENESS::DESCRIPTION:Consider following the principle of separation of privilege. Require multiple conditions to be met before permitting access to a system resource.::
<h5>ObservedExamples</h5>::REFERENCE:CVE-2000-1213:DESCRIPTION:Program does not drop privileges after acquiring the raw socket.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1213REFERENCE:CVE-2001-0559:DESCRIPTION:Setuid program does not drop privileges after a parsing error occurs, then calls another program to handle the error.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0559REFERENCE:CVE-2001-0787:DESCRIPTION:Does not drop privileges in related groups when lowering privileges.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0787REFERENCE:CVE-2002-0080:DESCRIPTION:Does not drop privileges in related groups when lowering privileges.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0080REFERENCE:CVE-2001-1029:DESCRIPTION:Does not drop privileges before determining access to certain files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1029REFERENCE:CVE-1999-0813:DESCRIPTION:Finger daemon does not drop privileges when executing programs on behalf of the user being fingered.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0813REFERENCE:CVE-1999-1326:DESCRIPTION:FTP server does not drop privileges if a connection is aborted during file transfer.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1326REFERENCE:CVE-2000-0172:DESCRIPTION:Program only uses seteuid to drop privileges.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0172REFERENCE:CVE-2004-2504:DESCRIPTION:Windows program running as SYSTEM does not drop privileges before executing other programs (many others like this, especially involving the Help facility).:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2504REFERENCE:CVE-2004-0213:DESCRIPTION:Utility Manager launches winhlp32.exe while running with raised privileges, which allows local users to gain system privileges.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0213REFERENCE:CVE-2004-0806:DESCRIPTION:Setuid program does not drop privileges before executing program specified in an environment variable.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0806REFERENCE:CVE-2004-0828:DESCRIPTION:Setuid program does not drop privileges before processing file specified on command line.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0828REFERENCE:CVE-2004-2070:DESCRIPTION:Service on Windows does not drop privileges before using view file option, allowing code execution.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2070
<h5>FunctionalAreas</h5>null
<h5>AffectedResources</h5>null
<h5>TaxonomyMappings</h5>TAXONOMY NAME:PLOVER:ENTRY NAME:Privilege Dropping / Lowering Errors::
<h5>RelatedAttackPatterns</h5>null
<h5>Notes</h5>TYPE:Maintenance:NOTE:CWE-271, CWE-272, and CWE-250 are all closely related and possibly overlapping. CWE-271 is probably better suited as a category.::

