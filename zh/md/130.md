# ID: 130 - 长度参数不一致处理不当
<h5>名称</h5>长度参数不一致处理不当
<h5>弱点抽象</h5>底座
<h5>状态</h5>不完全
<h5>描述</h5>该软件解析格式化的消息或结构，但它不会处理或错误地处理与关联数据的实际长度不一致的长度字段。
<h5>扩展描述</h5>如果攻击者可以操作与输入关联的长度参数，使其与输入的实际长度不一致，则可以利用此参数使目标应用程序以意外的、甚至可能是恶意的方式运行。这样做的一个可能动机是向应用程序输入任意大的输入。另一个可能的动机是修改应用程序状态，包括应用程序后续属性的无效数据。这些弱点通常会导致攻击，例如缓冲区溢出和任意代码的执行。
<h5>相关的弱点</h5>*性质：子女：CWE ID：240：视图ID：1000：序数：初级：自然：子女：CWE ID：119：视图ID：699：序号：PRIMARE：CWE ID：CWE ID：805：View ID：1000：
<h5>弱点规律</h5>*序号：主要：说明：
<h5>适用的平台</h5>*语言名称：C：语言流行率：有时：语言名称：C+：语言流行率：语言类别：语言-独立：语言流行率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>*术语：长度操纵：描述：术语：长度篡改：描述：
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：其他：技术影响：因情况而异：
<h5>检测方法</h5>空
<h5>潜在的缓解措施</h5>：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：When processing structured incoming data containing a size field followed by raw data，ensure that you identify and resolve any inconsistencies between the size field and the actual size of the data.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Do not let the user control the size of the buffer.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Validate that the length of the user-supplied data is consistent with the buffer size.：：
<h5>观察到的例子</h5>::REFERENCE:CVE-2014-0160:DESCRIPTION:Chain: Heartbleed bug receives an inconsistent length parameter (CWE-130) enabling an out-of-bounds read (CWE-126), returning memory that could include private cryptographic keys and other sensitive data.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160REFERENCE:CVE-2009-2299:DESCRIPTION:Web application firewall consumes excessive memory when an HTTP request contains a large Content-Length value but no POST data.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2299REFERENCE:CVE-2001-0825:DESCRIPTION:Buffer overflow in internal string handling routine allows remote attackers to execute arbitrary commands via a length argument of zero or less, which disables the length check.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0825REFERENCE:CVE-2001-1186:DESCRIPTION:Web server allows remote attackers to cause a denial of service via an HTTP request with a content-length value that is larger than the size of the request, which prevents server from timing out the connection.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1186REFERENCE:CVE-2001-0191:DESCRIPTION:Service does not properly check the specified length of a cookie, which allows remote attackers to execute arbitrary commands via a buffer overflow, or brute force authentication by using a short cookie length.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0191REFERENCE:CVE-2003-0429:DESCRIPTION:Traffic analyzer allows remote attackers to cause a denial of service and possibly execute arbitrary code via invalid IPv4 or IPv6 prefix lengths, possibly triggering a buffer overflow.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0429REFERENCE:CVE-2000-0655:DESCRIPTION:Chat client allows remote attackers to cause a denial of service or execute arbitrary commands via a JPEG image containing a comment with an illegal field length of 1.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0655REFERENCE:CVE-2004-0492:DESCRIPTION:Server allows remote attackers to cause a denial of service and possibly execute arbitrary code via a negative Content-Length HTTP header field causing a heap-based buffer overflow.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0492REFERENCE:CVE-2004-0201:DESCRIPTION:Help program allows remote attackers to execute arbitrary commands via a heap-based buffer overflow caused by a .CHM file with a large length field:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0201REFERENCE:CVE-2003-0825:DESCRIPTION:Name services does not properly validate the length of certain packets, which allows attackers to cause a denial of service and possibly execute arbitrary code. Can overlap zero-length issues:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0825REFERENCE:CVE-2004-0095:DESCRIPTION:Policy manager allows remote attackers to cause a denial of service (memory consumption and crash) and possibly execute arbitrary code via an HTTP POST request with an invalid Content-Length value.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0095REFERENCE:CVE-2004-0826:DESCRIPTION:Heap-based buffer overflow in library allows remote attackers to execute arbitrary code via a modified record length field in an SSLv2 client hello message.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0826REFERENCE:CVE-2004-0808:DESCRIPTION:When domain logons are enabled, server allows remote attackers to cause a denial of service via a SAM_UAS_CHANGE request with a length value that is larger than the number of structures that are provided.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0808REFERENCE:CVE-2002-1357:DESCRIPTION:Multiple SSH2 servers and clients do not properly handle packets or data elements with incorrect length specifiers, which may allow remote attackers to cause a denial of service or possibly execute arbitrary code.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1357REFERENCE:CVE-2004-0774:DESCRIPTION:Server allows remote attackers to cause a denial of service (CPU and memory exhaustion) via a POST request with a Content-Length header set to -1.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0774REFERENCE:CVE-2004-0989:DESCRIPTION:Multiple buffer overflows in xml library that may allow remote attackers to execute arbitrary code via long URLs.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0989REFERENCE:CVE-2004-0568:DESCRIPTION:Application does not properly validate the length of a value that is saved in a session file, which allows remote attackers to execute arbitrary code via a malicious session file (.ht), web site, or Telnet URL contained in an e-mail message, triggering a buffer overflow.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0568REFERENCE:CVE-2003-0327:DESCRIPTION:Server allows remote attackers to cause a denial of service via a remote password array with an invalid length, which triggers a heap-based buffer overflow.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0327REFERENCE:CVE-2003-0345:DESCRIPTION:Product allows remote attackers to cause a denial of service and possibly execute arbitrary code via an SMB packet that specifies a smaller buffer length than is required.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0345REFERENCE:CVE-2004-0430:DESCRIPTION:Server allows remote attackers to execute arbitrary code via a LoginExt packet for a Cleartext Password User Authentication Method (UAM) request with a PathName argument that includes an AFPName type string that is longer than the associated length field.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0430REFERENCE:CVE-2005-0064:DESCRIPTION:PDF viewer allows remote attackers to execute arbitrary code via a PDF file with a large /Encrypt /Length keyLength value.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0064REFERENCE:CVE-2004-0413:DESCRIPTION:SVN client trusts the length field of SVN protocol URL strings, which allows remote attackers to cause a denial of service and possibly execute arbitrary code via an integer overflow that leads to a heap-based buffer overflow.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0413REFERENCE:CVE-2004-0940:DESCRIPTION:Is effectively an accidental double increment of a counter that prevents a length check conditional from exiting a loop.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0940REFERENCE:CVE-2002-1235:DESCRIPTION:Length field of a request not verified.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1235REFERENCE:CVE-2005-3184:DESCRIPTION:Buffer overflow by modifying a length value.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3184REFERENCE:SECUNIA:18747:DESCRIPTION:Length field inconsistency crashes cell phone.:LINK:http://secunia.com/advisories/18747/
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类法名称：plover：条目名：长度参数不一致：
<h5>相关的攻击模式</h5>*47：
<h5>笔记</h5>类型：关系：注：这可能与其他类别重叠，包括零长度问题。：

