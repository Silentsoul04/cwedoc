# ID: 502 - 不可信数据的反序列化
<h5>名称</h5>不可信数据的反序列化
<h5>弱点抽象</h5>变体
<h5>状态</h5>草案
<h5>描述</h5>应用程序反序列化不受信任的数据，而不充分验证结果数据是否有效。
<h5>扩展描述</h5>通常情况下，序列化对象以进行通信或将其保存以供以后使用非常方便。但是，如果反序列化数据或代码不使用加密技术来保护自身，则无需使用提供的访问器函数就可以修改数据或代码。此外，任何密码技术都仍然是客户端安全-这是一个危险的安全假设。不受信任的数据不能被信任为格式良好.当开发人员不对小工具链或在反序列化过程中可以自执行的一系列实例和方法调用(即在对象返回给调用方之前)设置限制时，攻击者有时可以利用它们执行未经授权的操作，比如生成一个shell。
<h5>相关的弱点</h5>*性质：子女：CWE ID：913：视图ID：1000：序数：原生：自然：子女：CWE ID：913：视图ID：699：主：自然：子：CWE ID：913：视图ID：1003：序数：主：自然：PeerOf：CWE ID：915：View ID：1000：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言名称：Java：语言流行率：未确定的语言名称：Ruby：语言流行率：语言名称：PHP：语言流行率：语言名称：Python：语言流行率：语言名称：JavaScript：语言流行率：未定：
<h5>背景细节</h5>*序列化和反序列化是指接收程序内部与对象有关的数据，以允许外部存储或传输(序列化)的方式封装数据的过程，然后提取序列化数据以重建原始对象(反序列化)：
<h5>替代条款</h5>*术语：封送处理、解封送处理：描述：封送处理和解封送处理实际上分别是序列化和反序列化的同义词。：术语：酸洗，解酸洗：描述：在Python中，泡菜功能用于执行序列化和反序列化。：
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Integrity：TECHNICAL IMPACT：Modify Application Data Unexpected State：NOTE：Integrity Modify Application Data Unexpected State Attackers can modify unexpected objects or data that was assumed to be safe from modification.：：SCOPE：Availability：TECHNICAL IMPACT：DoS：Resource Consumption(CPU)：NOTE：Availability DoS：Resource Consumption(CPU)If a function is making an assumption on when to terminate，based on a sentry in a string，it could easily never terminate.：：SCOPE：Other：TECHNICAL IMPACT：Varies by Context：NOTE：Other Varies by Context The consequences can vary widely，because it取决于正在反序列化的对象或方法以及它们的使用方式。假设反序列化对象中的代码是有效的，这是危险的，可以利用：
<h5>检测方法</h5>空
<h5>潜在的缓解措施</h5>阶段：可用的体系结构和设计Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：If，使用编程语言的签名/密封功能，以确保反序列化数据不受污染。例如，可以使用基于哈希的消息身份验证代码(Hmac)来确保数据不是modified.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：When反序列化数据，而是填充一个新对象而不仅仅是反序列化。结果是，数据流通过安全输入验证，函数为safe.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Explicitly，定义了一个防止反序列化的最终对象()。：相位：体系结构和设计Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Make字段瞬态，以保护它们不被反序列化。如果试图序列化包含瞬态字段的类，然后反序列化类，则会导致出现瞬态数据的NULL。这是一种很好的方法，可以防止时间、基于环境或敏感的变量被转移和使用improperly.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Avoid，这些类型或小工具具有不必要的可用类型或小工具，可以用于恶意目的。这限制了攻击者利用意外或未经授权的类型和小工具的可能性。白名单可接受的课程。注意：不断地发现新的小工具，因此这本身并不是一个足够的缓解措施。：
<h5>观察到的例子</h5>：：REFERENCE：CVE-2015-8103：DESCRIPTION：Deserialization issue in commonly-used Java library allows remote execution.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2015-8103REFERENCE：CVE-2015-4852：DESCRIPTION：Deserialization issue in commonly-used Java library allows remote execution.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2015-4852REFERENCE：CVE-2013-1465：DESCRIPTION：Use of PHP unserialize function on untrusted input allows attacker to modify application configuration.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2013-1465REFERENCE：CVE-2012-3527：DESCRIPTION：Use of PHP unserialize function on untrusted input in content management system might allow code execution.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2012-3527REFERENCE：CVE-2012-0911：DESCRIPTION：Use of PHP unserialize function on untrusted input in content management system allows code execution using a crafted cookie value.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2012-0911REFERENCE：CVE-2012-0911：DESCRIPTION：Content management system written in PHP allowsunserialize of arbitrary objects，possibly allowing code execution.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2012-0911REFERENCE：CVE-2011-2520：DESCRIPTION：Python script allows local users to execute code via pickled data.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2011-2520REFERENCE：CVE-2012-4406：DESCRIPTION：Unsafe deserialization using pickle in a Python script.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2012-4406REFERENCE：CVE-2003-0791：DESCRIPTION：Web browser allows execution of native methods via a crafted string to a JavaScript function that deserializes the string.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2003-0791
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：CLASP：ENTRY NAME：Deserialization of untrusted data：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：SER01-J：ENTRY NAME：Do not deviate from the proper signatures of serialization methods：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：SER03-J：ENTRY NAME：Do not serialize unencrypted，sensitive data：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：SER06-J：ENTRY NAME：Make defensive copies of private mutable components during deserialization：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：SER08-J：ENTRY NAME：Do not use the default serialized form for implementation defined invariants：TAXONOMY NAME：Software Fault Patterns：ENTRY ID：SFP25：ENTRY NAME：Tainted input to variable：：
<h5>相关的攻击模式</h5>空
<h5>笔记</h5>类型：维护：注意：CWE-502和CWE-915之间的关系需要进一步探讨.CWE-915对象修改的范围更窄，不一定用于反序列化。

