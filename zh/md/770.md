# ID: 770 - 资源的无限制分配或节流
<h5>名称</h5>资源的无限制分配或节流
<h5>弱点抽象</h5>底座
<h5>状态</h5>不完全
<h5>描述</h5>该软件代表一个参与者分配一个可重用资源或一组资源，而不对可分配多少资源施加任何限制，这违反了该参与者的预期安全策略。
<h5>扩展描述</h5>空
<h5>相关的弱点</h5>*性质：子女：CWE ID：665：视图ID：1000：序数：基本：自然：子女：400：视图ID：1000：自然：CWE ID：400：视图ID：699：序数：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：PHASE：Operation：DESCRIPTION：PHASE：System配置：说明：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：可用性：技术影响：DoS：资源消耗(CPU)DoS：资源消耗(内存)DoS：资源消耗(其他)：注意：可用性DoS：资源消耗(CPU)DoS：资源消耗(内存)DoS：资源消耗(其他)当不受限制地分配资源时，攻击者可以阻止其他系统、应用程序或进程访问同一类型的资源：
<h5>检测方法</h5>*方法：手动静态分析：有效性：描述：手动静态分析可能有助于发现这一弱点，但它可能无法在有限的时间限制内实现所需的代码覆盖。如果拒绝服务被认为不是很大的风险，或者如果非常强调代码执行等后果，那么手工分析可能不会集中在all.：：METHOD：Fuzzing：EFFECTIVENESS：Opportunistic：DESCRIPTION：While的这个弱点上，模糊化通常是为了查找低级别的实现错误，它可能无意中发现不受控制的资源分配问题。当Fuzzer生成大量测试用例但在测试用例之间没有重新启动目标软件时，就会发生这种情况。如果单个测试用例产生崩溃，但不可靠，则无法限制资源分配可能是原因。当分配直接受到数字输入的影响时，模糊可能会显示出这一弱点。：方法：自动动态分析：有效性：描述：某些自动动态分析技术可能有效地产生不受控制的资源分配问题的副作用，特别是在进程、内存和连接等资源中。该技术可能涉及在短时间内产生对软件的大量请求。可能需要手动分析来解释结果。：方法：可能需要自动静态Analysis：EFFECTIVENESS：：DESCRIPTION：Specialized配置或调优来训练自动工具以识别这一弱点。自动静态分析在识别无限分配问题方面的效用通常有限，除非缺少独立于程序的系统资源，如文件、套接字和进程，或者内存中未检查的参数。对于系统资源，自动静态分析可能能够检测资源过期后没有释放的情况，或者如果一次请求过多的资源，可能会发生在内存中。自动分析配置文件可以检测没有指定最大值的设置。自动静态分析工具不适用于检测客户资源的用尽，例如一项预定的安全策略，其中只允许公告板用户每天发布数量有限的帖子：
<h5>潜在的缓解措施</h5>::PHASE:Requirements:STRATEGY::EFFECTIVENESS::DESCRIPTION:Clearly specify the minimum and maximum expectations for capabilities, and dictate which behaviors are acceptable when resource allocation reaches limits.::PHASE:Architecture and Design:STRATEGY::EFFECTIVENESS::DESCRIPTION:Limit the amount of resources that are accessible to unprivileged users. Set per-user limits for resources. Allow the system administrator to define these limits. Be careful to avoid CWE-410.::PHASE:Architecture and Design:STRATEGY::EFFECTIVENESS::DESCRIPTION:Design throttling mechanisms into the system architecture. The best protection is to limit the amount of resources that an unauthorized user can cause to be expended. A strong authentication and access control model will help prevent such attacks from occurring in the first place, and it will help the administrator to identify who is committing the abuse. The login application should be protected against DoS attacks as much as possible. Limiting the database access, perhaps by caching result sets, can help minimize the resources expended. To further limit the potential for a DoS attack, consider tracking the rate of requests received from users and blocking requests that exceed a defined rate threshold.::PHASE:Implementation:STRATEGY:Input Validation:EFFECTIVENESS::DESCRIPTION:Assume all input is malicious. Use an accept known good input validation strategy, i.e., use a whitelist of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does. When performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, boat may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as red or blue. Do not rely exclusively on looking for malicious or malformed inputs (i.e., do not rely on a blacklist). A blacklist is likely to miss at least one undesirable input, especially if the code's environment changes. This can give attackers enough room to bypass the intended validation. However, blacklists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright.::PHASE:Architecture and Design:STRATEGY::EFFECTIVENESS::DESCRIPTION:For any security checks that are performed on the client side, ensure that these checks are duplicated on the server side, in order to avoid CWE-602. Attackers can bypass the client-side checks by modifying values after the checks have been performed, or by changing the client to remove the client-side checks entirely. Then, these modified values would be submitted to the server.::PHASE:Architecture and Design:STRATEGY::EFFECTIVENESS::DESCRIPTION:Mitigation of resource exhaustion attacks requires that the target system either: recognizes the attack and denies that user further access for a given amount of time, typically by using increasing time delays uniformly throttles all requests in order to make it more difficult to consume resources more quickly than they can again be freed. The first of these solutions is an issue in itself though, since it may allow attackers to prevent the use of the system by a particular valid user. If the attacker impersonates the valid user, they may be able to prevent the user from accessing the server in question. The second solution can be difficult to effectively institute -- and even when properly done, it does not provide a full solution. It simply requires more resources on the part of the attacker.::PHASE:Architecture and Design:STRATEGY::EFFECTIVENESS::DESCRIPTION:Ensure that protocols have specific limits of scale placed on them.::PHASE:Architecture and Design Implementation:STRATEGY::EFFECTIVENESS::DESCRIPTION:If the program must fail, ensure that it fails gracefully (fails closed). There may be a temptation to simply let the program fail poorly in cases such as low memory conditions, but an attacker may be able to assert control before the software has fully exited. Alternately, an uncontrolled failure could cause cascading problems with other downstream components; for example, the program could send a signal to a downstream process so the process immediately knows that a problem has occurred and has a better chance of recovery. Ensure that all failures in resource allocation place the system into a safe posture.::PHASE:Operation Architecture and Design:STRATEGY:Resource Limitation:EFFECTIVENESS::DESCRIPTION:Use resource-limiting settings provided by the operating system or environment. For example, when managing system resources in POSIX, setrlimit() can be used to set limits for certain types of resources, and getrlimit() can determine how many resources are available. However, these functions are not available on all operating systems. When the current levels get close to the maximum that is defined for the application (see CWE-770), then limit the allocation of further resources to privileged users; alternately, begin releasing resources for less-privileged users. While this mitigation may protect the system from attack, it will not necessarily stop attackers from adversely impacting other users. Ensure that the application performs the appropriate error checks and error handling in case resources become unavailable (CWE-703).::
<h5>观察到的例子</h5>：：REFERENCE：CVE-2009-4017：DESCRIPTION：Language interpreter does not restrict the number of temporary files being created when handling a MIME request with a large number of parts..：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-4017REFERENCE：CVE-2009-2726：DESCRIPTION：Driver does not use a maximum width when invoking sscanf style functions，causing stack consumption.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2726REFERENCE：CVE-2009-2540：DESCRIPTION：Large integer value for a length property in an object causes a large amount of memory allocation.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2540REFERENCE：CVE-2009-2054：DESCRIPTION：Product allows exhaustion of file descriptors when processing a large number of TCP packets.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2054REFERENCE：CVE-2008-5180：DESCRIPTION：Communication product allows memory consumptionwith a large number of SIP requests，which cause many sessions to be created.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-5180REFERENCE：CVE-2008-1700：DESCRIPTION：Product allows attackers to cause a denial of service via a large number of directives，each of which opens a separate window.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-1700REFERENCE：CVE-2005-4650：DESCRIPTION：CMS does not restrict the number of searches that can occur simultaneously，leading to resource exhaustion.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2005-4650
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类名称：cert Java安全编码：条目ID：FIO 04-J：条目名称：关闭不再需要的资源：分类法名称：cert Java安全编码：条目ID：SER12-J：条目名称：在序列化过程中避免内存和资源泄漏：分类法名称：Entry ID：MSC05-J：条目名：不要耗尽堆空间：
<h5>相关的攻击模式</h5>：：121：：125：：130：：147：：197：：229：：230：：231：：469：：82：：99：：
<h5>笔记</h5>类型：维护：注意：资源耗尽(CWE-400)目前被视为一个弱点，尽管它更像是一个类别的弱点，它们都有相同的结果。虽然本条目将CWE-400视为视图1000中的父类，但这种关系可能更适合描述为一个链。：类型：理论：注意：脆弱性理论主要是关于行为和资源如何交互的。资源耗尽可以被看作是一种后果，也可以看作是一种攻击，这取决于视角。本条目试图反映使这些攻击(或后果)得以发生的潜在弱点之一：

