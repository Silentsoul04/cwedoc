# ID: 327 - 使用破损或有风险的密码算法
<h5>名称</h5>使用破损或有风险的密码算法
<h5>弱点抽象</h5>底座
<h5>状态</h5>草案
<h5>描述</h5>使用损坏或有风险的密码算法是不必要的风险，可能导致敏感信息的暴露。
<h5>扩展描述</h5>使用非标准算法是危险的，因为有决心的攻击者可能会破坏该算法并破坏任何已被保护的数据。可能存在一些众所周知的技术来破坏该算法。
<h5>相关的弱点</h5>*性质：子女：CWE ID：693：视图ID：1000：序数：主：性质：PeerOf：CWE ID：311：View ID：1000：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>*加密算法是对数据进行置乱的方法。大多数应用程序都应该使用少数几种被充分理解和深入研究的算法。产生一个安全的算法是相当困难的，即使是高性能的密码专家的算法也被打破了。由于密码学的发展速度如此之快，一种算法通常被认为是不安全的，即使它曾经被认为是强大的。当发现针对该算法的新攻击时，或者如果计算能力增加到密码算法不再提供最初认为的保护量时，就会发生这种情况。
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：建筑和设计：说明：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Confidentiality：TECHNICAL IMPACT：Read Application Data：NOTE：Confidentiality Read Application Data The confidentiality of sensitive data may be compromised by the use of a broken or risky cryptographic algorithm.：：SCOPE：Integrity：TECHNICAL IMPACT：Modify Application Data：NOTE：Integrity Modify Application Data The integrity of sensitive data may be compromised by the use of a broken or risky cryptographic algorithm.：：SCOPE：Accountability：SCOPE：Non-Repudiation：TECHNICAL IMPACT：Hide Activities：NOTE：Accountability Non-Repudiation Hide Activities If the cryptographic algorithm is used to ensure the identity of the source of the data(例如数字签名)，那么一个坏掉的算法就会破坏这一方案，而且无法证明数据的来源：
<h5>检测方法</h5>：：METHOD：Automated Analysis：EFFECTIVENESS：Moderate：DESCRIPTION：Automated methods may be useful for recognizing commonly-used libraries or features that have become obsolete.：：METHOD：Manual Analysis：EFFECTIVENESS：：DESCRIPTION：This weakness can be detected using tools and techniques that require manual(human)analysis，such as penetration testing，threat modeling，and interactive tools that allow the tester to record and modify an active session.：：METHOD：Automated Static Analysis-Binary or Bytecode：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial覆盖范围：字节码弱点分析-包括反汇编程序+源代码弱点分析二进制弱点分析-包括反汇编程序+源代码弱点分析二进制/字节码简单提取器字符串、ELF读取器等：方法：手动静态分析-二进制或字节码：有效性：SOAR部分：描述：根据SOAR，以下检测技术可能有用：部分覆盖成本效益：二进制/字节码反汇编器-然后对漏洞和异常使用手动分析：方法：自动动态分析Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Web Application Scanner Web Services Scanner Database Scanners：：METHOD：Dynamic Analysis with Manual Results Interpretation：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Man-in-the-middle attack tool Cost effective for partial coverage：Framework-based Fuzzer Automated Monitored Execution Monitored Virtual Environment-run potentially malicious code in sandbox/wrapper/virtual machine，see if it does anything suspicious：：METHOD：Manual Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Manual Source Code Review(not inspections)Cost effective for partial coverage：Focused Manual Spotcheck-Focused manual analysis of source：：METHOD：Automated Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Source code Weakness Analyzer Context-configured Source Code Weakness Analyzer：：METHOD：Automated Static分析：SOAR部分：描述：根据SOAR，下列检测技术可能有用：部分覆盖的成本效益：配置检查器：方法：体系结构或设计Review：EFFECTIVENESS：High：DESCRIPTION：According到RAAR，下列检测技术可能有用：高成本效益：形式方法/部分覆盖的建筑成本效益：检查(ieee 1028标准)(可适用于需求、设计、源代码等)：
<h5>潜在的缓解措施</h5>*阶段：架构和设计：战略：库或框架：有效性：描述：当需要存储或传输敏感数据时，使用强大的最新加密算法加密这些数据。选择一个经过良好审查的算法，该算法目前被该领域的专家认为是强大的，并使用经过良好测试的实现。与所有加密机制一样，源代码应该可供分析。例如，美国政府系统要求FIPS 140-2认证.不要开发自定义或私有加密算法。他们很可能会受到密码家非常了解的攻击。逆向工程技术比较成熟。如果攻击者发现该算法是如何工作的，那么该算法就特别薄弱。定期确保密码学不过时。一些较老的算法，曾经被认为需要10亿年的计算时间，现在可以在几天或几个小时内被打破。这包括MD4、MD5、SHA 1、DES和其他曾经被认为是强大的算法。[参考文献267]：阶段：体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Design软件，以便一个密码算法可以被替换为另一个。这将使升级到更强的算法变得更容易。：阶段：体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Carefully管理和保护加密密钥(参见CWE-320)。如果密钥可以猜测或窃取，那么加密本身的强度就无关紧要了。：阶段：体系结构和设计：策略：库或框架：有效性：描述：使用不允许出现此弱点的经过审查的库或框架，或提供更容易避免此弱点的构造。行业标准实现将节省开发时间，并可能更有可能避免在加密算法实现过程中可能发生的错误。考虑ESAPI加密特性。：阶段：使用业界认可的技术实现体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：When，正确使用它们。不要偷工减料，跳过资源密集型的步骤(CWE-325)。这些步骤对于防止常见攻击往往是必不可少的。
<h5>观察到的例子</h5>：：REFERENCE：CVE-2008-3775：DESCRIPTION：Product uses ROT-25 to obfuscate the password in the registry.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-3775REFERENCE：CVE-2007-4150：DESCRIPTION：product only uses XOR to obfuscate sensitive data：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-4150REFERENCE：CVE-2007-5460：DESCRIPTION：product only uses XOR and a fixed key to obfuscate sensitive data：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-5460REFERENCE：CVE-2005-4860：DESCRIPTION：Product substitutes characters with other characters in a fixed way，and also leaves certain input characters unchanged.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2005-4860REFERENCE：CVE-2002-2058：DESCRIPTION：Attackers can infer private IP addresses by dividing each octet by the MD5 hash of‘20’.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2002-2058REFERENCE：CVE-2008-3188：DESCRIPTION：Product uses DES when MD5 has been specified in the configuration，resultingin weaker-than-expected password hashes.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-3188REFERENCE：CVE-2005-2946：DESCRIPTION：Default configuration of product uses MD5 instead of stronger algorithms that are available，simplifying forgery of certificates.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2005-2946REFERENCE：CVE-2007-6013：DESCRIPTION：Product uses the hash of a hash for authentication，allowing attackers to gain privileges if they can obtain the original hash.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-6013
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：CLASP：ENTRY NAME：Using a broken or risky cryptographic algorithm：TAXONOMY NAME：OWASP Top Ten 2004：ENTRY ID：A8：ENTRY NAME：Insecure Storage：MAPPING FIT：CWE More Specific：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：MSC30-C：ENTRY NAME：Do not use the rand()function for generating pseudorandom numbers：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：MSC32-C：ENTRY NAME：Properly seed pseudorandom number generators：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：MSC02-J：ENTRY NAME：Generate strong random numbers：：
<h5>相关的攻击模式</h5>*20：459：473：608：614：97：
<h5>笔记</h5>类型：维护：注意：CWE-310、CWE-326和CWE-327与其所有子女之间的关系需要审查和重组。

