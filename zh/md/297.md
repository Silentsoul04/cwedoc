# ID: 297 - 主机不匹配证书的不正确验证
<h5>名称</h5>主机不匹配证书的不正确验证
<h5>弱点抽象</h5>变体
<h5>状态</h5>不完全
<h5>描述</h5>该软件与提供证书的主机通信，但该软件不能正确地确保证书实际上与该主机相关联。
<h5>扩展描述</h5>即使证书具有良好的格式、签名和遵循信任链，它也可能是与软件交互的站点不同站点的有效证书。如果没有正确检查证书的特定主机数据(例如主题中的公共名称(CN)或X.509证书的Subject Alternative Name(SAN)扩展)，则可能发生重定向或欺骗攻击，从而允许具有有效证书的恶意主机提供数据，模拟受信任的主机。为了确保数据完整性，证书必须是有效的，并且必须与正在访问的站点有关。即使软件试图检查主机名，仍然有可能错误地检查主机名。例如，攻击者可以创建一个证书，其名称以受信任的名称开头，后面跟着NUL字节，这可能导致一些基于字符串的比较只检查包含受信任名称的部分。即使软件使用证书钉扎，如果软件在锁定证书时不验证主机名，也会出现此缺陷。
<h5>相关的弱点</h5>*性质：CWE ID：295：视图ID：1000：大自然：CWE ID：295：视图ID：699：序号：主：自然：子：CWE ID：295：view ID：1003：主：自然：子：CWE ID：923：视图ID：1000：序数：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言独立：语言流行率：待定：Paradign名称：流动：Paradign普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：访问控制：技术影响：获取特权或假定身份：注：访问控制增益特权或假定身份证书从系统中读取的数据可能不是来自预期的system.：：SCOPE：Authentication：SCOPE：Other：TECHNICAL影响：其他：注意：基于恶意证书向有关系统提供的其他信任可能允许欺骗或重定向攻击：
<h5>检测方法</h5>*方法：采用手工结果解释的动态分析：有效性：描述：建立软件将与之连接的不可信端点(例如服务器)。创建使用无效主机名但由可信CA签名的测试证书，并从不受信任的端点提供此证书。如果软件执行任何操作而不是断开连接和报告错误，那么这表明没有检查主机名，并且测试证书已被接受。：方法：黑箱：有效性：描述：当在移动应用程序中使用证书钉扎时，请考虑使用SPINTER[ref-955]等工具。这一方法可扩展到其他技术：
<h5>潜在的缓解措施</h5>*阶段：体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Fully检查证书的主机名，并向用户提供关于问题性质和如何使用proceed.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：If证书钉扎的充分信息，确保证书的所有相关属性在锁定证书之前得到充分验证，包括主机名。
<h5>观察到的例子</h5>::REFERENCE:CVE-2012-5810:DESCRIPTION:Mobile banking application does not verify hostname, leading to financial loss.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5810REFERENCE:CVE-2012-5811:DESCRIPTION:Mobile application for printing documents does not verify hostname, allowing attackers to read sensitive documents.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5811REFERENCE:CVE-2012-5807:DESCRIPTION:Software for electronic checking does not verify hostname, leading to financial loss.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5807REFERENCE:CVE-2012-3446:DESCRIPTION:Cloud-support library written in Python uses incorrect regular expression when matching hostname.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3446REFERENCE:CVE-2009-2408:DESCRIPTION:Web browser does not correctly handle '0' character (NUL) in Common Name, allowing spoofing of https sites.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2408REFERENCE:CVE-2012-0867:DESCRIPTION:Database program truncates the Common Name during hostname verification, allowing spoofing.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0867REFERENCE:CVE-2010-2074:DESCRIPTION:Incorrect handling of '0' character (NUL) in hostname verification allows spoofing.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2074REFERENCE:CVE-2009-4565:DESCRIPTION:Mail server's incorrect handling of '0' character (NUL) in hostname verification allows spoofing.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4565REFERENCE:CVE-2009-3767:DESCRIPTION:LDAP server's incorrect handling of '0' character (NUL) in hostname verification allows spoofing.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3767REFERENCE:CVE-2012-5806:DESCRIPTION:Payment processing module does not verify hostname when connecting to PayPal using PHP fsockopen function.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5806REFERENCE:CVE-2012-2993:DESCRIPTION:Smartphone device does not verify hostname, allowing spoofing of mail services.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2993REFERENCE:CVE-2012-5804:DESCRIPTION:E-commerce module does not verify hostname when connecting to payment site.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5804REFERENCE:CVE-2012-5824:DESCRIPTION:Chat application does not validate hostname, leading to loss of privacy.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5824REFERENCE:CVE-2012-5822:DESCRIPTION:Application uses third-party library that does not validate hostname.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5822REFERENCE:CVE-2012-5819:DESCRIPTION:Cloud storage management application does not validate hostname.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5819REFERENCE:CVE-2012-5817:DESCRIPTION:Java library uses JSSE SSLSocket and SSLEngine classes, which do not verify the hostname.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5817REFERENCE:CVE-2012-5784:DESCRIPTION:SOAP platform does not verify the hostname.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5784REFERENCE:CVE-2012-5782:DESCRIPTION:PHP library for payments does not verify the hostname.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5782REFERENCE:CVE-2012-5780:DESCRIPTION:Merchant SDK for payments does not verify the hostname.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5780REFERENCE:CVE-2003-0355:DESCRIPTION:Web browser does not validate Common Name, allowing spoofing of https sites.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0355
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类法名称：CLASP：Entry Name：未能验证特定主机的证书数据：
<h5>相关的攻击模式</h5>空
<h5>笔记</h5>空

