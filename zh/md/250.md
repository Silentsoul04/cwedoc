# ID: 250 - 使用不必要的特权执行
<h5>名称</h5>使用不必要的特权执行
<h5>弱点抽象</h5>班级，等级
<h5>状态</h5>草案
<h5>描述</h5>该软件以高于所需最低级别的特权级别执行操作，这会产生新的弱点或放大其他弱点的后果。
<h5>扩展描述</h5>可能会暴露新的弱点，因为使用附加权限(如root或Administrator)运行时，可以禁用操作系统或周围环境正在执行的正常安全检查。如果其他预先存在的漏洞在以提升的权限操作时发生，则它们可能会变成安全漏洞。特权管理功能可以一些不太明显的方式运行，它们在不同的平台上有不同的怪癖。如果您要从一个非根用户过渡到另一个非根用户，则这些不一致性特别明显。信号处理程序和派生进程以拥有进程的特权运行，因此，如果在信号触发或子进程执行时进程以根用户身份运行，则信号处理程序或子进程将以根权限进行操作。
<h5>相关的弱点</h5>*性质：子女：CWE ID：657：视图ID：1000：序数：主要：自然：子女：CWE ID：657：视图ID：699：自然：子女：CWE ID：269：视图ID：1000：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言独立：语言流行率：待定：Paradign名称：流动：Paradign普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>：PHASE：Implementation：DESCRIPTION：PHASE：Installation：DESCRIPTION：PHASE：Architecture和Design：DESCRIPTION：PHASE：Operation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Confidentiality：SCOPE：Integrity：SCOPE：Availability：SCOPE：Access控制：技术影响：获取特权或假定身份-执行未经授权的代码或命令-读取应用程序数据DoS：崩溃、退出或重新启动：注意：机密性完整性可用性访问控制获得特权或假定身份执行未经授权的代码或命令读取应用程序数据DoS：崩溃、退出或重新启动攻击者将能够访问额外权限允许的任何资源。常见结果包括执行代码、禁用服务和读取受限数据。：
<h5>检测方法</h5>::METHOD:Manual Analysis:EFFECTIVENESS::DESCRIPTION:This weakness can be detected using tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session.::METHOD:Black Box:EFFECTIVENESS::DESCRIPTION:Use monitoring tools that examine the software's process as it interacts with the operating system and the network. This technique is useful in cases when source code is unavailable, if the software was not developed by you, or if you want to verify that the build phase did not introduce any new weaknesses. Examples include debuggers that directly attach to the running process; system-call tracing utilities such as truss (Solaris) and strace (Linux); system activity monitors such as FileMon, RegMon, Process Monitor, and other Sysinternals utilities (Windows); and sniffers and protocol analyzers that monitor network traffic. Attach the monitor to the process and perform a login. Look for library functions and system calls that indicate when privileges are being raised or dropped. Look for accesses of resources that are restricted to normal users.::METHOD:Automated Static Analysis - Binary or Bytecode:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Compare binary / bytecode to application permission manifest Cost effective for partial coverage: Bytecode Weakness Analysis - including disassembler + source code weakness analysis Binary Weakness Analysis - including disassembler + source code weakness analysis::METHOD:Manual Static Analysis - Binary or Bytecode:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Binary / Bytecode disassembler - then use manual analysis for vulnerabilities & anomalies::METHOD:Dynamic Analysis with Automated Results Interpretation:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Host-based Vulnerability Scanners â Examine configuration for flaws, verifying that audit mechanisms work, ensure host configuration meets certain predefined criteria::METHOD:Dynamic Analysis with Manual Results Interpretation:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Host Application Interface Scanner::METHOD:Manual Static Analysis - Source Code:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Manual Source Code Review (not inspections) Cost effective for partial coverage: Focused Manual Spotcheck - Focused manual analysis of source::METHOD:Automated Static Analysis - Source Code:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Source code Weakness Analyzer Context-configured Source Code Weakness Analyzer::METHOD:Automated Static Analysis:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Configuration Checker Permission Manifest Analysis::METHOD:Architecture or Design Review:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Inspection (IEEE 1028 standard) (can apply to requirements, design, source code, etc.) Formal Methods / Correct-By-Construction Cost effective for partial coverage: Attack Modeling::
<h5>潜在的缓解措施</h5>::PHASE:Architecture and Design Operation:STRATEGY:Environment Hardening:EFFECTIVENESS::DESCRIPTION:Run your code using the lowest privileges that are required to accomplish the necessary tasks [REF-76]. If possible, create isolated accounts with limited privileges that are only used for a single task. That way, a successful attack will not immediately give the attacker access to the rest of the software or its environment. For example, database applications rarely need to run as the database administrator, especially in day-to-day operations.::PHASE:Architecture and Design:STRATEGY:Separation of Privilege:EFFECTIVENESS::DESCRIPTION:Identify the functionality that requires additional privileges, such as access to privileged operating system resources. Wrap and centralize this functionality if possible, and isolate the privileged code as much as possible from other code [REF-76]. Raise privileges as late as possible, and drop them as soon as possible to avoid CWE-271. Avoid weaknesses such as CWE-288 and CWE-420 by protecting all possible communication channels that could interact with the privileged code, such as a secondary socket that is only intended to be accessed by administrators.::PHASE:Architecture and Design:STRATEGY:Attack Surface Reduction:EFFECTIVENESS::DESCRIPTION:Identify the functionality that requires additional privileges, such as access to privileged operating system resources. Wrap and centralize this functionality if possible, and isolate the privileged code as much as possible from other code [REF-76]. Raise privileges as late as possible, and drop them as soon as possible to avoid CWE-271. Avoid weaknesses such as CWE-288 and CWE-420 by protecting all possible communication channels that could interact with the privileged code, such as a secondary socket that is only intended to be accessed by administrators.::PHASE:Implementation:STRATEGY::EFFECTIVENESS::DESCRIPTION:Perform extensive input validation for any privileged code that must be exposed to the user and reject anything that does not fit your strict requirements.::PHASE:Implementation:STRATEGY::EFFECTIVENESS::DESCRIPTION:When dropping privileges, ensure that they have been dropped successfully to avoid CWE-273. As protection mechanisms in the environment get stronger, privilege-dropping calls may fail even if it seems like they would always succeed.::PHASE:Implementation:STRATEGY::EFFECTIVENESS::DESCRIPTION:If circumstances force you to run with extra privileges, then determine the minimum access level necessary. First identify the different permissions that the software and its users will need to perform their actions, such as file read and write permissions, network socket permissions, and so forth. Then explicitly allow those actions while denying all else [REF-76]. Perform extensive input validation and canonicalization to minimize the chances of introducing a separate vulnerability. This mitigation is much more prone to error than dropping the privileges in the first place.::PHASE:Operation System Configuration:STRATEGY:Environment Hardening:EFFECTIVENESS::DESCRIPTION:Ensure that the software runs properly under the Federal Desktop Core Configuration (FDCC) [REF-199] or an equivalent hardening configuration guide, which many organizations use to limit the attack surface and potential risk of deployed software.::
<h5>观察到的例子</h5>参考：CVE-2007-4217：描述：FTP客户端程序在特定操作系统上以setuid权限运行，并且存在缓冲区溢出。Most clients do not need extra privileges，so an overflow is not a vulnerability for those clients.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-4217REFERENCE：CVE-2008-1877：DESCRIPTION：Program runs with privileges and calls another program with the same privileges，which allows read of arbitrary files.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-1877REFERENCE：CVE-2007-5159：DESCRIPTION：OS incorrectly installs a program with setuid privileges，allowing users to gain privileges.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-5159REFERENCE：CVE-2008-4638：DESCRIPTION：Composite：application running with high privileges allows user to specify a restricted file to process，which generates a parsing error that leaks the contents ofthe file.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-4638REFERENCE：CVE-2008-0162：DESCRIPTION：Program does not drop privileges before calling another program，allowing code execution.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-0162REFERENCE：CVE-2008-0368：DESCRIPTION：setuid root program allows creation of arbitrary files through command line argument.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-0368REFERENCE：CVE-2007-3931：DESCRIPTION：Installation script installs some programs as setuid when they shouldn‘t be.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-3931
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类名称：7有害王国：条目名称：经常被滥用：特权管理：分类法名称：cert Java安全编码：条目ID：SER09-J：条目名称：在从特权上下文反序列化之前最小化特权：
<h5>相关的攻击模式</h5>*104：470：69：
<h5>笔记</h5>类型：关系：注：与CWE-653(特权分离不足)有密切关系.CWE-653是为每个特权提供单独的组件；CWE-250是关于确保每个组件拥有尽可能少的特权。：类型：维护：注意：CWE-271、CWE-272和CWE-250都是密切相关的，可能是重叠的。CWE-271可能更适合作为一个类别。社区积极使用CWE-272和CWE-250.最少特权短语有多种解释：

