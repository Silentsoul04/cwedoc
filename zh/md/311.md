# ID: 311 - 敏感数据丢失加密
<h5>名称</h5>敏感数据丢失加密
<h5>弱点抽象</h5>底座
<h5>状态</h5>草案
<h5>描述</h5>软件在存储或传输之前不加密敏感或关键信息。
<h5>扩展描述</h5>由于缺乏适当的数据加密，无法保证加密的机密性、完整性和问责制。
<h5>相关的弱点</h5>*性质：子女：CWE ID：693：视图ID：1000：序数：主：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Operation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：机密性：技术影响：读取应用程序数据：注意：机密性读取应用程序数据-如果应用程序不使用安全通道(如SSL)来交换敏感信息，则访问网络流量的攻击者有可能从连接中嗅探数据包并发现数据。这种攻击在技术上并不困难，但确实需要对敏感数据传输的网络的某些部分进行物理访问。这种访问通常靠近用户连接到网络的某个地方(例如公司网络上的同事)，但可以沿着从用户到最终的路径(server.：：SCOPE：Confidentiality：SCOPE：Integrity：TECHNICAL影响：修改应用程序数据：注意：机密性、完整性、修改应用程序数据、省略在通过任何类型的网络传输数据的程序中使用加密)与发送的数据一样考虑。发送方和接收方的本地网络上的每个用户。更糟糕的是，这一遗漏允许将数据注入到双方之间的通信流中-受害者无法将有效的数据与无效的数据分开。在网络攻击和密码收集嗅探器广泛存在的今天，在任何可能从中受益的系统的设计中省略加密是一种不必要的风险。
<h5>检测方法</h5>*方法：手工分析：有效性：高：描述：敏感数据的特性通常需要特定领域的理解，因此手动方法是有用的。但是，手工工作可能无法在有限的时间限制内实现所需的代码覆盖率。黑匣子方法可能会产生需要人工评估的工件(例如存储的数据或未加密的网络传输)。：方法：自动分析：有效性：描述：输入/输出源熵的自动测量可能表明加密的使用或不加密，但仍然需要人工分析来区分有意未加密的数据(例如元数据)和敏感数据。：方法：手动静态分析-二进制或字节码：有效性：SOAR部分：描述：根据SOAR，以下检测技术可能是有用的：部分覆盖的成本效益：Binary/Bytecode disassembler-then use manual analysis for vulnerabilities&anomalies：：METHOD：Dynamic Analysis with Automated Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Web Application Scanner Web Services Scanner Database Scanners：：METHOD：Dynamic Analysis with Manual Results Interpretation：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Network Sniffer Cost effective for partial coverage：Fuzz Tester Framework-based Fuzzer AutomatedMonitored Execution Man-in-the-middle attack tool：：METHOD：Manual Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Focused Manual Spotcheck-Focused manual analysis of source Manual Source Code Review(not inspections)：：METHOD：Automated Static Analysis-Source Code：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Context-configured Source Code Weakness Analyzer：：METHOD：Architecture or Design Review：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection技术可能是有用的：高成本效益：检查(IEEE 1028标准)(可适用于需求、设计、源代码等)部分覆盖的正式方法/按施工成本调整的有效方法：攻击建模：
<h5>潜在的缓解措施</h5>::PHASE:Requirements:STRATEGY::EFFECTIVENESS::DESCRIPTION:Clearly specify which data or resources are valuable enough that they should be protected by encryption. Require that any transmission or storage of this data/resource should use well-vetted encryption algorithms.::PHASE:Architecture and Design:STRATEGY::EFFECTIVENESS::DESCRIPTION:Ensure that encryption is properly integrated into the system design, including but not necessarily limited to: Encryption that is needed to store or transmit private data of the users of the system Encryption that is needed to protect the system itself from unauthorized disclosure or tampering Identify the separate needs and contexts for encryption: One-way (i.e., only the user or recipient needs to have the key). This can be achieved using public key cryptography, or other techniques in which the encrypting party (i.e., the software) does not need to have access to a private key. Two-way (i.e., the encryption can be automatically performed on behalf of a user, but the key must be available so that the plaintext can be automatically recoverable by that user). This requires storage of the private key in a format that is recoverable only by the user (or perhaps by the operating system) in a way that cannot be recovered by others. Using threat modeling or other techniques, assume that data can be compromised through a separate vulnerability or weakness, and determine where encryption will be most effective. Ensure that data that should be private is not being inadvertently exposed using weaknesses such as insecure permissions (CWE-732). [REF-7]::PHASE:Architecture and Design:STRATEGY:Libraries or Frameworks:EFFECTIVENESS::DESCRIPTION:When there is a need to store or transmit sensitive data, use strong, up-to-date cryptographic algorithms to encrypt that data. Select a well-vetted algorithm that is currently considered to be strong by experts in the field, and use well-tested implementations. As with all cryptographic mechanisms, the source code should be available for analysis. For example, US government systems require FIPS 140-2 certification. Do not develop custom or private cryptographic algorithms. They will likely be exposed to attacks that are well-understood by cryptographers. Reverse engineering techniques are mature. If the algorithm can be compromised if attackers find out how it works, then it is especially weak. Periodically ensure that the cryptography has not become obsolete. Some older algorithms, once thought to require a billion years of computing time, can now be broken in days or hours. This includes MD4, MD5, SHA1, DES, and other algorithms that were once regarded as strong. [REF-267]::PHASE:Architecture and Design:STRATEGY:Separation of Privilege:EFFECTIVENESS::DESCRIPTION:Compartmentalize the system to have safe areas where trust boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the trust boundary and always be careful when interfacing with a compartment outside of the safe area. Ensure that appropriate compartmentalization is built into the system design and that the compartmentalization serves to allow for and further reinforce privilege separation functionality. Architects and designers should rely on the principle of least privilege to decide when it is appropriate to use and to drop system privileges.::PHASE:Implementation Architecture and Design:STRATEGY::EFFECTIVENESS::DESCRIPTION:When using industry-approved techniques, use them correctly. Don't cut corners by skipping resource-intensive steps (CWE-325). These steps are often essential for preventing common attacks.::PHASE:Implementation:STRATEGY:Attack Surface Reduction:EFFECTIVENESS:Defense in Depth:DESCRIPTION:Use naming conventions and strong types to make it easier to spot when sensitive data is being used. When creating structures, objects, or other complex entities, separate the sensitive and non-sensitive data as much as possible.::
<h5>观察到的例子</h5>::REFERENCE:CVE-2009-2272:DESCRIPTION:password and username stored in cleartext in a cookie:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2272REFERENCE:CVE-2009-1466:DESCRIPTION:password stored in cleartext in a file with insecure permissions:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1466REFERENCE:CVE-2009-0152:DESCRIPTION:chat program disables SSL in some circumstances even when the user says to use SSL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0152REFERENCE:CVE-2009-1603:DESCRIPTION:Chain: product uses an incorrect public exponent when generating an RSA key, which effectively disables the encryption:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1603REFERENCE:CVE-2009-0964:DESCRIPTION:storage of unencrypted passwords in a database:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0964REFERENCE:CVE-2008-6157:DESCRIPTION:storage of unencrypted passwords in a database:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-6157REFERENCE:CVE-2008-6828:DESCRIPTION:product stores a password in cleartext in memory:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-6828REFERENCE:CVE-2008-1567:DESCRIPTION:storage of a secret key in cleartext in a temporary file:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1567REFERENCE:CVE-2008-0174:DESCRIPTION:SCADA product uses HTTP Basic Authentication, which is not encrypted:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0174REFERENCE:CVE-2007-5778:DESCRIPTION:login credentials stored unencrypted in a registry key:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5778REFERENCE:CVE-2002-1949:DESCRIPTION:Passwords transmitted in cleartext.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1949REFERENCE:CVE-2008-4122:DESCRIPTION:Chain: Use of HTTPS cookie without secure flag causes it to be transmitted across unencrypted HTTP.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4122REFERENCE:CVE-2008-3289:DESCRIPTION:Product sends password hash in cleartext in violation of intended policy.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3289REFERENCE:CVE-2008-4390:DESCRIPTION:Remote management feature sends sensitive information including passwords in cleartext.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4390REFERENCE:CVE-2007-5626:DESCRIPTION:Backup routine sends password in cleartext in email.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5626REFERENCE:CVE-2004-1852:DESCRIPTION:Product transmits Blowfish encryption key in cleartext.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1852REFERENCE:CVE-2008-0374:DESCRIPTION:Printer sends configuration information, including administrative password, in cleartext.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0374REFERENCE:CVE-2007-4961:DESCRIPTION:Chain: cleartext transmission of the MD5 hash of password enables attacks against a server that is susceptible to replay (CWE-294).:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4961REFERENCE:CVE-2007-4786:DESCRIPTION:Product sends passwords in cleartext to a log server.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4786REFERENCE:CVE-2005-3140:DESCRIPTION:Product sends file with cleartext passwords in e-mail message intended for diagnostic purposes.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3140
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：CLASP：ENTRY NAME：Failure to encrypt data：TAXONOMY NAME：OWASP Top Ten 2007：ENTRY ID：A8：ENTRY NAME：Insecure Cryptographic Storage：MAPPING FIT：CWE More Specific：TAXONOMY NAME：OWASP Top Ten 2007：ENTRY ID：A9：ENTRY NAME：Insecure Communications：MAPPING FIT：CWE More Specific：TAXONOMY NAME：OWASP Top Ten 2004：ENTRY ID：A8：ENTRY NAME：Insecure Storage：MAPPING FIT：CWE More Specific：TAXONOMY NAME：WASC：ENTRY ID：4：ENTRY NAME：Insufficient Transport Layer Protection：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：MSC00-J：ENTRY NAME：Use SSLSocket rather than Socket for secure data exchange：TAXONOMY NAME：Software Fault Patterns：ENTRY ID：SFP23：ENTRY NAME：Exposed Data：：
<h5>相关的攻击模式</h5>：：155：：157：：158：：204：：258：：259：：260：：31：：37：：383：：384：：385：：386：：387：：388：：389：：477：：65：：
<h5>笔记</h5>类型：关系：注：敏感信息的不安全存储(CWE-922)与敏感信息的缺失加密(CWE-311)之间存在重叠关系。加密通常用于防止攻击者读取敏感数据。但是，加密并不阻止攻击者擦除或覆盖数据。：

