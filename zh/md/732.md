# ID: 732 - 关键资源的权限分配不正确
<h5>名称</h5>关键资源的权限分配不正确
<h5>弱点抽象</h5>班级，等级
<h5>状态</h5>草案
<h5>描述</h5>该软件以允许意外行为者读取或修改该资源的方式指定安全关键资源的权限。
<h5>扩展描述</h5>当资源被授予权限设置，允许访问范围超出要求的行为者时，它可能导致敏感信息的泄露，或非预期缔约方对该资源的修改。当资源与程序配置、执行或敏感用户数据相关时，这尤其危险。
<h5>相关的弱点</h5>*性质：子女：CWE ID：285：视图ID：1000：序数：主：自然：子女：CWE ID：668：视图ID：1000：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：PHASE：Installation：DESCRIPTION：PHASE：Operation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：机密性：技术影响：读取应用程序数据读取文件或目录：注意：机密性读取应用程序数据读取文件或目录攻击者可能能够从相关资源中读取敏感信息，例如存储在文件中的凭据或配置信息。：范围：访问控制：技术影响：获取特权或假定身份：注意：访问控制获取特权或假定身份攻击者可能能够修改相关资源的关键属性以获得特权，例如替换具有特洛伊木马的世界可写可执行文件。：范围：完整性：范围：其他：技术影响：修改应用程序数据其他：注意：完整性其他修改应用程序数据其他攻击者可能能够破坏或损坏相关资源中的关键数据，例如从数据库中删除记录：
<h5>检测方法</h5>::METHOD:Automated Static Analysis:EFFECTIVENESS::DESCRIPTION:Automated static analysis may be effective in detecting permission problems for system resources such as files, directories, shared memory, device interfaces, etc. Automated techniques may be able to detect the use of library functions that modify permissions, then analyze function calls for arguments that contain potentially insecure values. However, since the software's intended security policy might allow loose permissions for certain operations (such as publishing a file on a web server), automated static analysis may produce some false positives - i.e., warnings that do not have any security consequences or require any code changes. When custom permissions models are used - such as defining who can read messages in a particular forum in a bulletin board system - these can be difficult to detect using automated static analysis. It may be possible to define custom signatures that identify any custom functions that implement the permission checks and assignments.::METHOD:Automated Dynamic Analysis:EFFECTIVENESS::DESCRIPTION:Automated dynamic analysis may be effective in detecting permission problems for system resources such as files, directories, shared memory, device interfaces, etc. However, since the software's intended security policy might allow loose permissions for certain operations (such as publishing a file on a web server), automated dynamic analysis may produce some false positives - i.e., warnings that do not have any security consequences or require any code changes. When custom permissions models are used - such as defining who can read messages in a particular forum in a bulletin board system - these can be difficult to detect using automated dynamic analysis. It may be possible to define custom signatures that identify any custom functions that implement the permission checks and assignments.::METHOD:Manual Analysis:EFFECTIVENESS::DESCRIPTION:This weakness can be detected using tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session.::METHOD:Manual Static Analysis:EFFECTIVENESS::DESCRIPTION:Manual static analysis may be effective in detecting the use of custom permissions models and functions. The code could then be examined to identifying usage of the related functions. Then the human analyst could evaluate permission assignments in the context of the intended security model of the software.::METHOD:Manual Dynamic Analysis:EFFECTIVENESS::DESCRIPTION:Manual dynamic analysis may be effective in detecting the use of custom permissions models and functions. The program could then be executed with a focus on exercising code paths that are related to the custom permissions. Then the human analyst could evaluate permission assignments in the context of the intended security model of the software.::METHOD:Fuzzing:EFFECTIVENESS::DESCRIPTION:Fuzzing is not effective in detecting this weakness.::METHOD:Black Box:EFFECTIVENESS::DESCRIPTION:Use monitoring tools that examine the software's process as it interacts with the operating system and the network. This technique is useful in cases when source code is unavailable, if the software was not developed by you, or if you want to verify that the build phase did not introduce any new weaknesses. Examples include debuggers that directly attach to the running process; system-call tracing utilities such as truss (Solaris) and strace (Linux); system activity monitors such as FileMon, RegMon, Process Monitor, and other Sysinternals utilities (Windows); and sniffers and protocol analyzers that monitor network traffic. Attach the monitor to the process and watch for library functions or system calls on OS resources such as files, directories, and shared memory. Examine the arguments to these calls to infer which permissions are being used.::METHOD:Automated Static Analysis - Binary or Bytecode:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Inter-application Flow Analysis::METHOD:Manual Static Analysis - Binary or Bytecode:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Binary / Bytecode disassembler - then use manual analysis for vulnerabilities & anomalies::METHOD:Dynamic Analysis with Automated Results Interpretation:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Host-based Vulnerability Scanners â Examine configuration for flaws, verifying that audit mechanisms work, ensure host configuration meets certain predefined criteria Web Application Scanner Web Services Scanner Database Scanners::METHOD:Dynamic Analysis with Manual Results Interpretation:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Host Application Interface Scanner Cost effective for partial coverage: Fuzz Tester Framework-based Fuzzer Automated Monitored Execution Forced Path Execution::METHOD:Manual Static Analysis - Source Code:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Manual Source Code Review (not inspections) Cost effective for partial coverage: Focused Manual Spotcheck - Focused manual analysis of source::METHOD:Automated Static Analysis - Source Code:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Context-configured Source Code Weakness Analyzer::METHOD:Automated Static Analysis:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Configuration Checker::METHOD:Architecture or Design Review:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Formal Methods / Correct-By-Construction Cost effective for partial coverage: Inspection (IEEE 1028 standard) (can apply to requirements, design, source code, etc.)::
<h5>潜在的缓解措施</h5>：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：When using a critical resource such as a configuration file，check to see if the resource has insecure permissions(such as being modifiable by any regular user)[REF-62]，and generate an error or even exit the software if there is a possibility that the resource could have been modified by an unauthorized party.：：PHASE：Architecture and Design：STRATEGY：：EFFECTIVENESS：Moderate：DESCRIPTION：Divide the software into anonymous，normal，privileged，and administrative areas.通过仔细定义不同的用户组、特权和/或角色来减少攻击面。根据数据、功能和相关资源映射这些数据。然后相应地设置权限。这将使您能够维护对资源的更细粒度的控制。[参考文献207]：阶段：体系结构和设计操作：策略：沙箱或监狱：有效性：有限：描述：在监狱或类似沙箱环境中运行代码，该环境强制执行进程和操作系统之间的严格边界。这可以有效地限制可以在特定目录中访问哪些文件或软件可以执行哪些命令。OS级别的例子包括Unixchroot监狱、AppArmor和SELinux。一般来说，托管代码可能提供一些保护。例如，JavaSecurityManager中的java.io.FilePermission允许软件指定对文件操作的限制。这可能不是一个可行的解决方案，它只会限制对操作系统的影响；应用程序的其余部分可能仍然会受到影响。小心避免CWE-243和其他与监狱相关的弱点。：阶段：实现Installation：STRATEGY：：EFFECTIVENESS：High：DESCRIPTION：During程序启动，显式地设置默认权限或umask到最严格的设置。还可以在程序安装期间设置适当的权限。This will prevent you from inheriting insecure permissions from any user who installs or runs the program.：：PHASE：System Configuration：STRATEGY：：EFFECTIVENESS：High：DESCRIPTION：For all configuration files，executables，and libraries，make sure that they are only readable and writable by the software‘s administrator.：：PHASE：Documentation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Do not suggest insecure configuration changes in documentation，especially if those configurations can extend to resources and other programs that are outside the scope of the application.：：PHASE：Installation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Do not assume that a system administrator will手动将配置更改为软件手册中建议的设置。：阶段：操作系统配置：策略：环境强化：有效性：描述：确保软件在联邦桌面核心配置(FDCC)[参考-199]或等效强化配置指南下正常运行，许多组织使用该指南来限制部署软件的攻击面和潜在风险：
<h5>观察到的例子</h5>::REFERENCE:CVE-2009-3482:DESCRIPTION:Anti-virus product sets insecure Everyone: Full Control permissions for files under the Program Files folder, allowing attackers to replace executables with Trojan horses.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3482REFERENCE:CVE-2009-3897:DESCRIPTION:Product creates directories with 0777 permissions at installation, allowing users to gain privileges and access a socket used for authentication.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3897REFERENCE:CVE-2009-3489:DESCRIPTION:Photo editor installs a service with an insecure security descriptor, allowing users to stop or start the service, or execute commands as SYSTEM.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3489REFERENCE:CVE-2009-3289:DESCRIPTION:Library function copies a file to a new target and uses the source file's permissions for the target, which is incorrect when the source file is a symbolic link, which typically has 0777 permissions.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3289REFERENCE:CVE-2009-0115:DESCRIPTION:Device driver uses world-writable permissions for a socket file, allowing attackers to inject arbitrary commands.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0115REFERENCE:CVE-2009-1073:DESCRIPTION:LDAP server stores a cleartext password in a world-readable file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1073REFERENCE:CVE-2009-0141:DESCRIPTION:Terminal emulator creates TTY devices with world-writable permissions, allowing an attacker to write to the terminals of other users.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0141REFERENCE:CVE-2008-0662:DESCRIPTION:VPN product stores user credentials in a registry key with Everyone: Full Control permissions, allowing attackers to steal the credentials.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0662REFERENCE:CVE-2008-0322:DESCRIPTION:Driver installs its device interface with Everyone: Write permissions.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0322REFERENCE:CVE-2009-3939:DESCRIPTION:Driver installs a file with world-writable permissions.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3939REFERENCE:CVE-2009-3611:DESCRIPTION:Product changes permissions to 0777 before deleting a backup; the permissions stay insecure for subsequent backups.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3611REFERENCE:CVE-2007-6033:DESCRIPTION:Product creates a share with Everyone: Full Control permissions, allowing arbitrary program execution.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6033REFERENCE:CVE-2007-5544:DESCRIPTION:Product uses Everyone: Full Control permissions for memory-mapped files (shared memory) in inter-process communication, allowing attackers to tamper with a session.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5544REFERENCE:CVE-2005-4868:DESCRIPTION:Database product uses read/write permissions for everyone for its shared memory, allowing theft of credentials.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4868REFERENCE:CVE-2004-1714:DESCRIPTION:Security product uses Everyone: Full Control permissions for its configuration files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1714REFERENCE:CVE-2001-0006:DESCRIPTION:Everyone: Full Control permissions assigned to a mutex allows users to disable network connectivity.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0006REFERENCE:CVE-2002-0969:DESCRIPTION:Chain: database product contains buffer overflow that is only reachable through a .ini configuration file - which has Everyone: Full Control permissions.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0969
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：FIO03-J：ENTRY NAME：Create files with appropriate access permission：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：SEC01-J：ENTRY NAME：Do not allow tainted variables in privileged blocks：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：ENV03-J：ENTRY NAME：Do not grant dangerous combinations of permissions：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：FIO06-C：ENTRY NAME：Create files with appropriate access permissions：：
<h5>相关的攻击模式</h5>*1：122：127：17：180：234：60：61：62：
<h5>笔记</h5>类型：维护：注意：权限、权限和参与者(例如用户和组)之间的关系需要在Research视图中进一步细化。一个复杂的问题是，这些概念适用于两个不同的支柱，即资源控制(CWE-664)和保护机制故障(CWE-396)：

