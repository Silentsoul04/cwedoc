# ID: 667 - 不当锁定
<h5>名称</h5>不当锁定
<h5>弱点抽象</h5>底座
<h5>状态</h5>草案
<h5>描述</h5>软件没有正确地获取资源上的锁，或者没有正确地释放资源上的锁，从而导致意外的资源状态更改和行为。
<h5>扩展描述</h5>空
<h5>相关的弱点</h5>*性质：子女：CWE ID：662：视图ID：1000：序数：初级：自然：子女：CWE ID：662：视图ID：699：序号：主要：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>空
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：可用性：技术影响：DoS：资源消耗(CPU)：注：可用性DoS：资源消耗(CPU)不一致的锁定规则可能导致死锁。
<h5>检测方法</h5>空
<h5>潜在的缓解措施</h5>*阶段：实施：战略：库或框架：有效性：说明：使用行业标准API实现锁定机制。
<h5>观察到的例子</h5>::REFERENCE:CVE-2009-0935:DESCRIPTION:Attacker provides invalid address to a memory-reading function, causing a mutex to be unlocked twice:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0935REFERENCE:CVE-2010-4210:DESCRIPTION:function in OS kernel unlocks a mutex that was not previously locked, causing a panic or overwrite of arbitrary memory.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4210REFERENCE:CVE-2008-4302:DESCRIPTION:Chain: OS kernel does not properly handle a failure of a function call (CWE-755), leading to an unlock of a resource that was not locked (CWE-832), with resultant crash.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4302REFERENCE:CVE-2009-1243:DESCRIPTION:OS kernel performs an unlock in some incorrect circumstances, leading to panic.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1243REFERENCE:CVE-2009-2857:DESCRIPTION:OS deadlock:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2857REFERENCE:CVE-2009-1961:DESCRIPTION:OS deadlock involving 3 separate functions:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1961REFERENCE:CVE-2009-2699:DESCRIPTION:deadlock in library:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2699REFERENCE:CVE-2009-4272:DESCRIPTION:deadlock triggered by packets that force collisions in a routing table:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4272REFERENCE:CVE-2002-1850:DESCRIPTION:read/write deadlock between web server and script:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1850REFERENCE:CVE-2004-0174:DESCRIPTION:web server deadlock involving multiple listening connections:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0174REFERENCE:CVE-2009-1388:DESCRIPTION:multiple simultaneous calls to the same function trigger deadlock.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1388REFERENCE:CVE-2006-5158:DESCRIPTION:chain: other weakness leads to NULL pointer dereference (CWE-476) or deadlock (CWE-833).:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5158REFERENCE:CVE-2006-4342:DESCRIPTION:deadlock when an operation is performed on a resource while it is being removed.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4342REFERENCE:CVE-2006-2374:DESCRIPTION:Deadlock in device driver triggered by using file handle of a related device.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-2374REFERENCE:CVE-2006-2275:DESCRIPTION:Deadlock when large number of small messages cannot be processed quickly enough.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-2275REFERENCE:CVE-2005-3847:DESCRIPTION:OS kernel has deadlock triggered by a signal during a core dump.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3847REFERENCE:CVE-2005-3106:DESCRIPTION:Race condition leads to deadlock.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3106REFERENCE:CVE-2005-2456:DESCRIPTION:Chain: array index error (CWE-129) leads to deadlock (CWE-833):LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2456REFERENCE:CVE-2001-0682:DESCRIPTION:Program can not execute when attacker obtains a mutex.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0682REFERENCE:CVE-2002-1914:DESCRIPTION:Program can not execute when attacker obtains a lock on a critical output file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1914REFERENCE:CVE-2002-1915:DESCRIPTION:Program can not execute when attacker obtains a lock on a critical output file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1915REFERENCE:CVE-2002-0051:DESCRIPTION:Critical file can be opened with exclusive read access by user, preventing application of security policy. Possibly related to improper permissions, large-window race condition.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0051REFERENCE:CVE-2000-0338:DESCRIPTION:Chain: predictable file names used for locking, allowing attacker to create the lock beforehand. Resultant from permissions and randomness.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0338REFERENCE:CVE-2000-1198:DESCRIPTION:Chain: Lock files with predictable names. Resultant from randomness.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1198REFERENCE:CVE-2002-1869:DESCRIPTION:Product does not check if it can write to a log file, allowing attackers to avoid logging by accessing the file using an exclusive lock. Overlaps unchecked error condition. This is not quite CWE-412, but close.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1869
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：CON31-C：ENTRY NAME：Do not destroy a mutex while it is locked：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：POS48-C：ENTRY NAME：Do not unlock or destroy another POSIX thread‘s mutex：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：VNA00-J：ENTRY NAME：Ensure visibility when accessing shared primitive variables：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：VNA02-J：ENTRY NAME：Ensure that compound operations on shared variables are atomic：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：VNA05-J：ENTRY NAME：Ensure atomicity when reading并编写64位值：分类法名称：CET Java安全编码：条目ID：LCK 06-J：条目名称：不要使用实例锁来保护共享的静态数据：分类法名称：软件故障模式：条目ID：SFP 19：条目名称：缺失锁：
<h5>相关的攻击模式</h5>*25：26：27：
<h5>笔记</h5>空

