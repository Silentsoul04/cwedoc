# ID: 427 - 无控制搜索路径元素
<h5>名称</h5>无控制搜索路径元素
<h5>弱点抽象</h5>底座
<h5>状态</h5>草案
<h5>描述</h5>该产品使用固定的或受控的搜索路径来查找资源，但是该路径中的一个或多个位置可以由非预期的参与者控制。
<h5>扩展描述</h5>尽管在任何类型的资源中都可能出现此缺陷，但当产品使用目录搜索路径查找可执行文件或代码库时，经常会引入此缺陷，但该路径包含攻击者可以修改的目录，如/tmp或当前工作目录。在基于Windows的系统中，当使用不包含完全限定路径的DLL名称调用LoadLibrary或LoadLibrary aryEx函数时，该函数遵循搜索顺序，其中包含两个可能不受控制的路径元素：程序已从其中加载到当前工作目录的目录。在某些情况下，攻击可以远程进行，例如当使用SMB或WebDAV网络共享时。在一些基于Unix的系统中，可能会创建包含空元素的路径，例如将空变量拼接到路径中。此空元素可解释为等效于当前工作目录，该目录可能是不受信任的搜索元素。
<h5>相关的弱点</h5>*性质：子女：CWE ID：668：视图ID：1000：序数：主：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言独立：语言流行率：未确定：操作系统类：操作系统无关：操作系统流行率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>*术语：DLL预加载：描述：该术语是用于描述Windows系统中不受信任搜索路径元素的利用的几个术语之一，2010年8月受到广泛关注。从弱点的角度来看，这个术语不精确，因为它可以同时适用于CWE-426和CWE-427。：术语：二进制种植：描述：这个术语是用来描述Windows系统中不可信搜索路径元素的利用的几个术语之一，2010年8月受到广泛关注。从弱点的角度来看，这个术语是不精确的，因为它可以同时适用于CWE-426和CWE-427。：术语：不安全的库加载：描述：这个术语是用于描述Windows系统中不受信任的搜索路径元素的利用的几个术语之一，该术语在2010年8月受到广泛关注。从弱点的角度来看，这个术语不准确，因为它可以同时适用于CWE-426和CWE-427。
<h5>模式的介绍</h5>*阶段：执行：说明：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Confidentiality：SCOPE：Integrity：SCOPE：Availability：TECHNICAL影响：执行未经授权的代码或命令：
<h5>检测方法</h5>空
<h5>潜在的缓解措施</h5>阶段：体系结构和设计实现：策略：攻击Reduction：EFFECTIVENESS：：DESCRIPTION：Hard-code搜索路径到一组已知的安全值(如系统目录)，或者只允许管理员在配置文件中指定它们。不允许外部方修改这些设置。小心避免相关的弱点，如CWE-426和CWE-428.：：PHASE：Implementation：STRATEGY：Attack表面缩减：有效性：描述：当调用其他程序时，使用完全限定的路径名指定那些程序。虽然这是一种有效的方法，但使用完全限定路径名的代码可能无法移植到其他不使用相同路径名的系统。可移植性可以通过在源代码中集中的、易于修改的位置上定位完全限定的路径来改进，并让代码引用这些路径。：阶段：实现：策略：攻击表面还原：有效性：描述：在调用其他程序之前删除或限制所有环境设置。这包括PATH环境变量、LD_LIBRARY_PATH和其他标识代码库位置的设置，以及在使用和删除任何可能不安全的元素(如当前工作目录或临时文件目录)之前，使用和删除任何特定于应用程序的搜索路径(paths.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Check)。因为这是一种黑名单方法，所以它可能不是一个完整的solution.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Use其他需要显式路径的函数。使用其他任何需要显式路径的可用函数都是避免此问题的安全方法。例如，C中的system()不需要完整的路径，因为shell可以使用PATH环境变量来查找程序，而execl()和execv()则需要一个完整的路径。
<h5>观察到的例子</h5>::REFERENCE:CVE-2010-3402:DESCRIPTION:DLL hijacking issue in document editor.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3402REFERENCE:CVE-2010-3397:DESCRIPTION:DLL hijacking issue in encryption software.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3397REFERENCE:CVE-2010-3138:DESCRIPTION:DLL hijacking issue in library used by multiple media players.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3138REFERENCE:CVE-2010-3152:DESCRIPTION:DLL hijacking issue in illustration program.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3152REFERENCE:CVE-2010-3147:DESCRIPTION:DLL hijacking issue in address book.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3147REFERENCE:CVE-2010-3135:DESCRIPTION:DLL hijacking issue in network monitoring software.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3135REFERENCE:CVE-2010-3131:DESCRIPTION:DLL hijacking issue in web browser.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3131REFERENCE:CVE-2010-1795:DESCRIPTION:DLL hijacking issue in music player/organizer.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1795REFERENCE:CVE-2002-1576:DESCRIPTION:Product uses the current working directory to find and execute a program, which allows local users to gain privileges by creating a symlink that points to a malicious version of the program.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1576REFERENCE:CVE-1999-1461:DESCRIPTION:Product trusts the PATH environmental variable to find and execute a program, which allows local users to obtain root access by modifying the PATH to point to a malicous version of that program.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1461REFERENCE:CVE-1999-1318:DESCRIPTION:Software uses a search path that includes the current working directory (.), which allows local users to gain privileges via malicious programs.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1318REFERENCE:CVE-2003-0579:DESCRIPTION:Admin software trusts the user-supplied -uv.install command line option to find and execute the uv.install program, which allows local users to gain privileges by providing a pathname that is under control of the user.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0579REFERENCE:CVE-2000-0854:DESCRIPTION:When a document is opened, the directory of that document is first used to locate DLLs , which could allow an attacker to execute arbitrary commands by inserting malicious DLLs into the same directory as the document.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0854REFERENCE:CVE-2001-0943:DESCRIPTION:Database trusts the PATH environment variable to find and execute programs, which allows local users to modify the PATH to point to malicious programs.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0943REFERENCE:CVE-2001-0942:DESCRIPTION:Database uses an environment variable to find and execute a program, which allows local users to execute arbitrary programs by changing the environment variable.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0942REFERENCE:CVE-2001-0507:DESCRIPTION:Server uses relative paths to find system files that will run in-process, which allows local users to gain privileges via a malicious file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0507REFERENCE:CVE-2002-2017:DESCRIPTION:Product allows local users to execute arbitrary code by setting an environment variable to reference a malicious program.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-2017REFERENCE:CVE-1999-0690:DESCRIPTION:Product includes the current directory in root's PATH variable.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0690REFERENCE:CVE-2001-0912:DESCRIPTION:Error during packaging causes product to include a hard-coded, non-standard directory in search path.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0912REFERENCE:CVE-2001-0289:DESCRIPTION:Product searches current working directory for configuration file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0289REFERENCE:CVE-2005-1705:DESCRIPTION:Product searches current working directory for configuration file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1705REFERENCE:CVE-2005-1307:DESCRIPTION:Product executable other program from current working directory.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1307REFERENCE:CVE-2002-2040:DESCRIPTION:Untrusted path.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-2040REFERENCE:CVE-2005-2072:DESCRIPTION:Modification of trusted environment variable leads to untrusted path vulnerability.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2072REFERENCE:CVE-2005-1632:DESCRIPTION:Product searches /tmp for modules before other paths.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1632
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类法名称：plover：条目名称：不受控制的搜索路径元素：
<h5>相关的攻击模式</h5>*38：471：
<h5>笔记</h5>类型：关系：注：不信任搜索路径(CWE-426)本质上涉及对控制范围的定义(即修改搜索路径)的控制，该条目涉及一个固定的控制范围，其中部分区域可能处于攻击者控制之下(即，搜索路径不能由攻击者修改，但路径的一个元素可以由攻击者控制)：类型：维护：注意：在CWE-668中，这个弱点并不是完全合适的。或表示控制球模型可能需要改进或澄清的CWE-610。

