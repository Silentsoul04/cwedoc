# ID: 807 - 在安全决策中依赖不可信输入
<h5>名称</h5>在安全决策中依赖不可信输入
<h5>弱点抽象</h5>底座
<h5>状态</h5>不完全
<h5>描述</h5>应用程序使用依赖于输入的存在或值的保护机制，但输入可以由不受信任的参与者以绕过保护机制的方式进行修改。
<h5>扩展描述</h5>开发人员可能会假设不能修改Cookie、环境变量和隐藏表单字段等输入。但是，攻击者可以使用自定义客户端或其他攻击来更改这些输入。可能无法检测到此更改。当基于这些输入的值进行身份验证和授权等安全决策时，攻击者可以绕过软件的安全性。如果没有足够的加密、完整性检查或其他机制，来自外部的任何输入都不能被信任。
<h5>相关的弱点</h5>*性质：子女：CWE ID：693：视图ID：1000：序数：主：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：机密性：范围：访问Control：SCOPE：Availability：SCOPE：Other：TECHNICAL影响：绕过保护机制增益特权或假定身份因上下文而异：注：机密性访问控制可用性其他旁路保护机制获得特权或假定身份因上下文不同而有所不同攻击者可以绕过安全决定访问受保护的任何内容。其后果将取决于相关的功能，但它们可以从授予不受信任用户的附加权限到绕过重要的安全检查。最终，这一弱点可能导致暴露或修改敏感数据、系统崩溃或执行任意代码。
<h5>检测方法</h5>*方法：手动静态分析：有效性：高：描述：由于此弱点通常不经常出现在单个软件包中，如果所有可能易受攻击的操作都能在有限的时间内进行评估，手动白盒技术可能能够提供足够的代码覆盖率和减少错误阳性。：方法：自动静态分析-二进制或字节码：有效性：SOAR部分：描述：根据SOAR，以下检测技术可能是有用的：部分覆盖的成本效益：字节码弱点分析-包括反汇编+source code weakness analysis Binary Weakness Analysis-including disassembler+source code weakness analysis：：METHOD：Manual Static Analysis-Binary or Bytecode：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Binary/Bytecode disassembler-then use manual analysis for vulnerabilities&anomalies：：METHOD：Dynamic Analysis with Automated Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Web Application Scanner Web Services Scanner Database Scanners：：METHOD：Dynamic Analysis with Manual Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Fuzz Tester Framework-based Fuzzer Monitored Virtual Environment-run potentially malicious code in sandbox/wrapper/virtual machine，see if it does anything suspicious：：METHOD：Manual Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：手工源代码审查(非检查)：方法：自动静态分析-源代码：有效性：SOAR部分：描述：根据SOAR，以下检测技术可能是有用的：部分覆盖的成本效益：源代码弱点分析器上下文-配置的源代码弱点分析器：方法：架构或设计Review：EFFECTIVENESS：High：DESCRIPTION：According到SAAR，以下检测技术可能是有用的：高成本效益：检查(IEEE1028标准)(可以适用于需求、设计、源代码等)。部分覆盖的正式方法/按施工成本调整的有效方法：攻击建模：
<h5>潜在的缓解措施</h5>::PHASE:Architecture and Design:STRATEGY:Attack Surface Reduction:EFFECTIVENESS::DESCRIPTION:Store state information and sensitive data on the server side only. Ensure that the system definitively and unambiguously keeps track of its own state and user state and has rules defined for legitimate state transitions. Do not allow any application user to affect state directly in any way other than through legitimate actions leading to state transitions. If information must be stored on the client, do not do so without encryption and integrity checking, or otherwise having a mechanism on the server side to catch tampering. Use a message authentication code (MAC) algorithm, such as Hash Message Authentication Code (HMAC) [REF-529]. Apply this against the state or sensitive data that you has to be exposed, which can guarantee the integrity of the data - i.e., that the data has not been modified. Ensure that a strong hash function is used (CWE-328).::PHASE:Architecture and Design:STRATEGY:Libraries or Frameworks:EFFECTIVENESS::DESCRIPTION:Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid. With a stateless protocol such as HTTP, use a framework that maintains the state for you. Examples include ASP.NET View State [REF-756] and the OWASP ESAPI Session Management feature [REF-45]. Be careful of language features that provide state support, since these might be provided as a convenience to the programmer and may not be considering security.::PHASE:Architecture and Design:STRATEGY::EFFECTIVENESS::DESCRIPTION:For any security checks that are performed on the client side, ensure that these checks are duplicated on the server side, in order to avoid CWE-602. Attackers can bypass the client-side checks by modifying values after the checks have been performed, or by changing the client to remove the client-side checks entirely. Then, these modified values would be submitted to the server.::PHASE:Operation Implementation:STRATEGY:Environment Hardening:EFFECTIVENESS::DESCRIPTION:When using PHP, configure the application so that it does not use register_globals. During implementation, develop the application so that it does not rely on this feature, but be wary of implementing a register_globals emulation that is subject to weaknesses such as CWE-95, CWE-621, and similar issues.::PHASE:Architecture and Design Implementation:STRATEGY:Attack Surface Reduction:EFFECTIVENESS::DESCRIPTION:Understand all the potential areas where untrusted inputs can enter your software: parameters or arguments, cookies, anything read from the network, environment variables, reverse DNS lookups, query results, request headers, URL components, e-mail, files, filenames, databases, and any external systems that provide data to the application. Remember that such inputs may be obtained indirectly through API calls. Identify all inputs that are used for security decisions and determine if you can modify the design so that you do not have to rely on submitted inputs at all. For example, you may be able to keep critical information about the user's session on the server side instead of recording it within external data.::
<h5>观察到的例子</h5>：：REFERENCE：CVE-2009-1549：DESCRIPTION：Attacker can bypass authentication by setting a cookie to a specific value.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-1549REFERENCE：CVE-2009-1619：DESCRIPTION：Attacker can bypass authentication and gain admin privileges by setting an admin cookie to 1.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-1619REFERENCE：CVE-2009-0864：DESCRIPTION：Content management system allows admin privileges by setting a login cookie to OK.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-0864REFERENCE：CVE-2008-5784：DESCRIPTION：e-dating application allows admin privileges by setting the admin cookie to 1.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-5784REFERENCE：CVE-2008-6291：DESCRIPTION：Web-based email list manager allows attackers to gain admin privileges by setting a login cookie to admin.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-6291
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类法名称：certJava安全编码：条目ID：SEC09-J：条目名称：不要将安全检查建立在不受信任的源上：
<h5>相关的攻击模式</h5>空
<h5>笔记</h5>空

