# ID: 765 - 关键资源的多个解锁
<h5>名称</h5>关键资源的多个解锁
<h5>弱点抽象</h5>变体
<h5>状态</h5>不完全
<h5>描述</h5>该软件对关键资源的解锁次数超过预期，导致系统中出现意外状态。
<h5>扩展描述</h5>当软件在并发环境中运行并反复解锁关键资源时，其后果将根据锁的类型、锁的实现和受保护的资源而有所不同。在某些情况下，例如使用信号量，资源将被池化，而额外的解锁调用将增加可用资源数量的计数，在系统接近容量时可能会导致崩溃或不可预测的行为。
<h5>相关的弱点</h5>*性质：子女：CWE ID：667：视图ID：1000：序数：基本：自然：子女：CWE ID：667：视图ID：699：序数：主：自然：CWE ID：675：视图ID：1000：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>空
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：执行：说明：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Availability：SCOPE：Integrity：TECHNICAL影响：DoS：崩溃、退出或重新启动修改内存意外状态：
<h5>检测方法</h5>空
<h5>潜在的缓解措施</h5>：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：When锁定和解锁一个资源，试着确保资源被锁定的代码中的所有控制路径一次或多次对应于相同数量的解锁。如果软件获得了一个锁，然后确定它无法执行它的预期行为，请确保在等待条件改善之前释放锁。在再次尝试之前重新获取锁。：
<h5>观察到的例子</h5>：：REFERENCE：CVE-2009-0935：DESCRIPTION：Attacker向内存读取函数提供无效地址，导致互斥锁twice：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-0935被解锁。
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类名称：软件故障模式：条目ID：SFP 21：条目名称：多个锁/解锁：
<h5>相关的攻击模式</h5>空
<h5>笔记</h5>类型：维护：注意：考虑此弱点的另一种方法是控制流中的锁/解锁数量之间的不平衡。在执行过程中，如果每个锁调用之后没有在合理的时间内进行随后的解锁调用，则如果存在对锁的竞争，则系统性能可能会降低，或者至少在低于峰值的水平上运行。这一条目可能需要修改，以反映今后的这些概念：

