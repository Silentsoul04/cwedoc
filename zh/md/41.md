# ID: 41 - 路径等价的不正确分解
<h5>名称</h5>路径等价的不正确分解
<h5>弱点抽象</h5>底座
<h5>状态</h5>不完全
<h5>描述</h5>系统或应用程序很容易通过路径等价方式公开文件系统内容。路径等价涉及在文件和目录名称中使用特殊字符。相关操作的目的是为同一个对象生成多个名称。
<h5>扩展描述</h5>路径等效通常用于规避使用不完整的文件名或文件路径表示的访问控制。这与路径遍历不同，其中执行操作是为了为不同的对象生成名称。
<h5>相关的弱点</h5>*性质：子女：CWE ID：706：视图ID：1000：序数：主：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：执行：说明：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Confidentiality：SCOPE：Integrity：SCOPE：Access控制：技术影响：读取文件或目录，修改文件或目录，旁路保护机制：注意：机密完整性访问控制，读取文件或目录，修改文件或目录，旁路保护机制，攻击者可能能够遍历文件系统到意想不到的位置，并读取或覆盖意外文件的内容。如果文件用于安全机制，攻击者可能会绕过该机制。：
<h5>检测方法</h5>：：METHOD：Automated Static Analysis-Binary or Bytecode：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Bytecode Weakness Analysis-including disassembler+source code weakness analysis：：METHOD：Manual Static Analysis-Binary or Bytecode：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Binary/Bytecode disassembler-then use manual analysis for vulnerabilities&anomalies：：METHOD：Dynamic Analysis with AutomatedResults Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Web Application Scanner Web Services Scanner Database Scanners：：METHOD：Dynamic Analysis with Manual Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Fuzz Tester Framework-based Fuzzer：：METHOD：Manual Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Focused Manual Spotcheck-Focused manual analysis of source Manual Source Code Review(not inspections)：：METHOD：Automated Static Analysis-Source Code：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Source code Weakness Analyzer Context-configured Source Code Weakness Analyzer：：METHOD：Architecture or Design Review：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Formal Methods/Correct-By-Construction Cost effective for partial coverage：Inspection(IEEE 1028 standard)(can apply to requirements，design，source code，etc.)：：
<h5>潜在的缓解措施</h5>*阶段：实施：战略：输入验证：有效性：描述：假设所有输入都是恶意的。使用接受已知的良好输入验证策略，即使用严格符合规范的可接受输入的白名单。拒绝任何不严格符合规范的输入，或将其转换为符合规范的输入。在执行输入验证时，要考虑所有可能相关的属性，包括长度、输入类型、可接受值的全部范围、缺少或额外的输入、语法、相关字段之间的一致性以及对业务规则的一致性。作为业务规则逻辑的一个示例，船在语法上可能是有效的，因为它只包含字母数字字符，但如果输入只包含红色或蓝色等颜色，则无效。不要完全依赖于寻找恶意或格式错误的输入(即，不要依赖黑名单)。黑名单可能至少漏掉一个不受欢迎的输入，特别是当代码的环境发生变化时。这可以让攻击者有足够的空间绕过预期的验证。但是，黑名单可以用于检测潜在的攻击或确定哪些输入格式非常错误，应该拒绝outright.：：PHASE：Implementation：STRATEGY：Output编码：有效性：描述：使用和指定一个输出编码，该输出编码可以由正在读取输出的下游组件处理。常见编码包括ISO-8859-1、UTF-7和UTF-8.当未指定编码时，下游组件可以通过假设默认编码或自动推断正在使用哪种编码来选择不同的编码，这可能是错误的。当编码不一致时，下游组件可能会将某些字符或字节序列视为特殊，即使它们在原始编码中并不特殊。然后，攻击者可以利用这一差异并进行注入攻击；他们甚至可以绕过假定下游component.：：PHASE：Implementation：STRATEGY：Input验证也使用原始编码的保护机制：有效性：描述：输入应该在验证之前解码并规范化到应用程序当前的内部表示(CWE-180)。确保应用程序不会对相同的输入进行两次解码(CWE-174)。此类错误可用于绕过白名单验证方案，在检查后引入危险输入：
<h5>观察到的例子</h5>::REFERENCE:CVE-2000-1114:DESCRIPTION:Source code disclosure using trailing dot:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1114REFERENCE:CVE-2002-1986,:DESCRIPTION:Source code disclosure using trailing dot:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1986,REFERENCE:CVE-2004-2213:DESCRIPTION:Source code disclosure using trailing dot or trailing encoding space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2213REFERENCE:CVE-2005-3293:DESCRIPTION:Source code disclosure using trailing dot:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3293REFERENCE:CVE-2004-0061:DESCRIPTION:Bypass directory access restrictions using trailing dot in URL:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0061REFERENCE:CVE-2000-1133:DESCRIPTION:Bypass directory access restrictions using trailing dot in URL:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1133REFERENCE:CVE-2001-1386:DESCRIPTION:Bypass check for .lnk extension using .lnk.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1386REFERENCE:CVE-2001-0693:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0693REFERENCE:CVE-2001-0778:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0778REFERENCE:CVE-2001-1248:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1248REFERENCE:CVE-2004-0280:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0280REFERENCE:CVE-2005-0622:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0622REFERENCE:CVE-2005-1656:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1656REFERENCE:CVE-2002-1603:DESCRIPTION:Source disclosure via trailing encoded space %20:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1603REFERENCE:CVE-2001-0054:DESCRIPTION:Multi-Factor Vulnerability (MVF). directory traversal and other issues in FTP server using Web encodings such as %20; certain manipulations have unusual side effects.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0054REFERENCE:CVE-2002-1451:DESCRIPTION:Trailing space (+ in query string) leads to source code disclosure.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1451REFERENCE:CVE-2000-0293:DESCRIPTION:Filenames with spaces allow arbitrary file deletion when the product does not properly quote them; some overlap with path traversal.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0293REFERENCE:CVE-2001-1567:DESCRIPTION:+ characters in query string converted to spaces before sensitive file/extension (internal space), leading to bypass of access restrictions to the file.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1567REFERENCE:CVE-2002-0253:DESCRIPTION:Overlaps infoleak:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0253REFERENCE:CVE-2001-0446:DESCRIPTION:Application server allows remote attackers to read source code for .jsp files by appending a / to the requested URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0446REFERENCE:CVE-2004-0334:DESCRIPTION:Bypass Basic Authentication for files using trailing /:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0334REFERENCE:CVE-2001-0893:DESCRIPTION:Read sensitive files with trailing /:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0893REFERENCE:CVE-2001-0892:DESCRIPTION:Web server allows remote attackers to view sensitive files under the document root (such as .htpasswd) via a GET request with a trailing /.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0892REFERENCE:CVE-2004-1814:DESCRIPTION:Directory traversal vulnerability in server allows remote attackers to read protected files via .. (dot dot) sequences in an HTTP request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1814REFERENCE:BID:3518:DESCRIPTION:Source code disclosure:LINK:http://www.securityfocus.com/bid/3518REFERENCE:CVE-2002-1483:DESCRIPTION:Read files with full pathname using multiple internal slash.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1483REFERENCE:CVE-1999-1456:DESCRIPTION:Server allows remote attackers to read arbitrary files via a GET request with more than one leading / (slash) character in the filename.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1456REFERENCE:CVE-2004-0578:DESCRIPTION:Server allows remote attackers to read arbitrary files via leading slash (//) characters in a URL request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0578REFERENCE:CVE-2002-0275:DESCRIPTION:Server allows remote attackers to bypass authentication and read restricted files via an extra / (slash) in the requested URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0275REFERENCE:CVE-2004-1032:DESCRIPTION:Product allows local users to delete arbitrary files or create arbitrary empty files via a target filename with a large number of leading slash (/) characters.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1032REFERENCE:CVE-2002-1238:DESCRIPTION:Server allows remote attackers to bypass access restrictions for files via an HTTP request with a sequence of multiple / (slash) characters such as http://www.example.com///file/.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1238REFERENCE:CVE-2004-1878:DESCRIPTION:Product allows remote attackers to bypass authentication, obtain sensitive information, or gain access via a direct request to admin/user.pl preceded by // (double leading slash).:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1878REFERENCE:CVE-2005-1365:DESCRIPTION:Server allows remote attackers to execute arbitrary commands via a URL with multiple leading / (slash) characters and .. sequences.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1365REFERENCE:CVE-2000-1050:DESCRIPTION:Access directory using multiple leading slash.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1050REFERENCE:CVE-2001-1072:DESCRIPTION:Bypass access restrictions via multiple leading slash, which causes a regular expression to fail.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1072REFERENCE:CVE-2004-0235:DESCRIPTION:Archive extracts to arbitrary files using multiple leading slash in filenames in the archive.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0235REFERENCE:CVE-2002-1078:DESCRIPTION:Directory listings in web server using multiple trailing slash:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1078REFERENCE:CVE-2004-0847:DESCRIPTION:ASP.NET allows remote attackers to bypass authentication for .aspx files in restricted directories via a request containing a (1) (backslash) or (2) %5C (encoded backslash), aka Path Validation Vulnerability.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0847REFERENCE:CVE-2000-0004:DESCRIPTION:Server allows remote attackers to read source code for executable files by inserting a . (dot) into the URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0004REFERENCE:CVE-2002-0304:DESCRIPTION:Server allows remote attackers to read password-protected files via a /./ in the HTTP request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0304REFERENCE:BID:6042:DESCRIPTION:Input Validation error:LINK:http://www.securityfocus.com/bid/6042REFERENCE:CVE-1999-1083:DESCRIPTION:Possibly (could be a cleansing error):LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1083REFERENCE:CVE-2004-0815:DESCRIPTION:/./////etc cleansed to .///etc then /etc:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0815REFERENCE:CVE-2002-0112:DESCRIPTION:Server allows remote attackers to view password protected files via /./ in the URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0112REFERENCE:CVE-2004-0696:DESCRIPTION:List directories using desired path and *:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-0696REFERENCE:CVE-2002-0433:DESCRIPTION:List files in web server using *.ext:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0433REFERENCE:CVE-2001-1152:DESCRIPTION:Proxy allows remote attackers to bypass blacklist restrictions and connect to unauthorized web servers by modifying the requested URL, including (1) a // (double slash), (2) a /SUBDIR/.. where the desired file is in the parentdir, (3) a /./, or (4) URL-encoded characters.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1152REFERENCE:CVE-2000-0191:DESCRIPTION:application check access for restricted URL before canonicalization:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0191REFERENCE:CVE-2005-1366:DESCRIPTION:CGI source disclosure using dirname/../cgi-bin:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1366REFERENCE:CVE-1999-0012:DESCRIPTION:Multiple web servers allow restriction bypass using 8.3 names instead of long names:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-0012REFERENCE:CVE-2001-0795:DESCRIPTION:Source code disclosure using 8.3 file name.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0795REFERENCE:CVE-2005-0471:DESCRIPTION:Multi-Factor Vulnerability. Product generates temporary filenames using long filenames, which become predictable in 8.3 format.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0471
<h5>功能区域</h5>空
<h5>影响资源</h5>档案或目录：
<h5>分类法映射</h5>分类名称：plover：条目名称：路径等效：分类法名称：cert C安全编码：条目ID：FIO 02-C：入口名称：来自不可信源的规范化路径名称：
<h5>相关的攻击模式</h5>*3：4：
<h5>笔记</h5>类型：关系：注意：其中一些操作在路径遍历问题上也可能是有效的。：

