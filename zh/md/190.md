# ID: 190 - 整数溢出或环绕
<h5>名称</h5>整数溢出或环绕
<h5>弱点抽象</h5>底座
<h5>状态</h5>不完全
<h5>描述</h5>当逻辑假定结果值总是大于原始值时，该软件执行可能产生整数溢出或环绕的计算。当计算用于资源管理或执行控制时，这可能会带来其他缺陷。
<h5>扩展描述</h5>当一个整数值增加到一个太大而不能存储在关联表示中的值时，就会发生整数溢出或环绕。当发生这种情况时，该值可能被包装成一个非常小的或负数。虽然在依赖包装的情况下，这可能是有意的行为，但如果包装是意外的，则会产生安全后果。如果可以使用用户提供的输入触发整数溢出，情况尤其如此。当结果用于控制循环、作出安全决策或确定内存分配、复制、连接等行为中的偏移量或大小时，这就变得非常重要。
<h5>相关的弱点</h5>：：NATURE：ChildOf：CWE ID：682：VIEW ID：1000：ORDINAL：Primary：：NATURE：ChildOf：CWE ID：682：VIEW ID：699：ORDINAL：Primary：：NATURE：ChildOf：CWE ID：682：VIEW ID：1003：ORDINAL：Primary：：NATURE：ChildOf：CWE ID：20：VIEW ID：700：ORDINAL：Primary：：NATURE：CanPrecede：CWE ID：119：VIEW ID：1000：CHAIN ID：680：：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：执行：说明：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：可用性：技术影响：DoS：崩溃、退出或重新启动DoS：资源消耗(CPU)DoS：资源消耗(内存)DoS：不稳定性：注意：可用性DoS：崩溃、退出或重新启动DoS：资源消耗(CPU)DoS：资源消耗(内存)DoS：不稳定通常会导致未定义的行为，因此崩溃。在涉及循环索引变量的溢出情况下，无限循环的可能性也很高。：范围：完整性：技术影响：修改内存：注意：完整性修改内存，如果所讨论的值对数据(相对于流)很重要，则发生了简单的数据损坏。此外，如果包装导致缓冲区溢出等其他情况，则进一步的内存损坏可能导致occur.：：SCOPE：Confidentiality：SCOPE：Availability：SCOPE：Access控制：技术影响：执行未经授权的代码或命令旁路保护机制：注意：机密性可用性访问控制执行未经授权的代码或命令旁路保护机制-该漏洞有时会触发缓冲区溢出，可用于执行任意代码。这通常超出程序隐式安全策略的范围。：
<h5>检测方法</h5>*方法：自动静态分析：有效性：高：描述：这一弱点经常可以使用自动静态分析工具检测到。许多现代工具使用数据流分析或基于约束的技术，以尽量减少错误阳性的数量。：方法：可以使用动态工具和技术来检测该弱点的黑色Box：EFFECTIVENESS：Moderate：DESCRIPTION：Sometimes，证据，这些工具和技术使用具有多种输入的大型测试套件与软件交互，例如模糊测试(Fuzming)、健壮性测试和故障注入。软件的操作可能会减慢，但不应变得不稳定、崩溃或产生不正确的结果。：方法：手动分析：有效性：高：描述：可以使用需要人工(人工)分析的工具和技术来检测该弱点，例如渗透测试、威胁建模和允许测试人员记录和修改活动会话的交互式工具。具体来说，手动静态分析对于评估分配计算的正确性非常有用。This can be useful for detecting overflow conditions(CWE-190)or similar weaknesses that might have serious security impacts on the program.：：METHOD：Automated Static Analysis-Binary or Bytecode：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Bytecode Weakness Analysis-including disassembler+source code weakness analysis Binary Weakness Analysis-including disassembler+source code weakness analysis：：METHOD：Dynamic Analysis with Manual Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，thefollowing detection techniques may be useful：Cost effective for partial coverage：Fuzz Tester Framework-based Fuzzer：：METHOD：Manual Static Analysis-Source Code：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Manual Source Code Review(not inspections)：：METHOD：Automated Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Source code Weakness Analyzer Context-configured Source Code Weakness Analyzer：：METHOD：Architecture or Design Review：EFFECTIVENESS：High：DESCRIPTION：According为了实现快速增长，以下检测技术可能是有用的：高成本效益：形式方法/对部分覆盖有效的建筑成本校正：检查(IEEE 1028标准)(可适用于需求、设计、源代码等)：
<h5>潜在的缓解措施</h5>：：PHASE：Requirements：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Ensure：所有协议都是严格定义的，因此可以简单地识别所有超出范围的行为，并要求严格遵守protocol.：：PHASE：Requirements：STRATEGY：Language选择：有效性：描述：使用一种不允许出现此弱点的语言或提供更容易避免此弱点的构造。如果可能，请选择执行自动边界检查的语言或编译器。：阶段：体系结构和设计：策略：库或框架：有效性：描述：使用不允许出现此缺陷的经过审查的库或框架，或提供更容易避免此弱点的构造。使用库或框架，使处理数字更容易，而不会产生意外的后果。示例包括安全整数处理包，如SafeInt(C+)或IntegerLib(C或C+)。[REF-106]：：PHASE：Implementation：STRATEGY：Input验证：有效性：Description：通过确保输入在预期范围内，对任何数字输入执行输入验证。强制执行输入满足预期范围的最小和最大要求。尽可能使用无符号整数。这样就可以更容易地对整数溢出执行正常检查。当需要有符号整数时，请确保范围检查包括最小值和最大values.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Understand(编程语言的底层表示形式)以及它与数值计算的交互方式(CWE-681)。密切关注字节大小的差异、精度、有符号/无符号的区别、类型之间的截断、转换和转换、非数字计算，以及语言如何处理对其基本表示来说太大或太小的数字。[参考文献7]也要注意考虑32位、64位和其他可能影响数字表示的潜在差异。：Stage：Architecture和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：For-任何在客户端执行的安全检查，确保这些检查在服务器端重复，以避免CWE-602。攻击者可以绕过客户端检查，在执行检查后修改值，或者更改客户端以完全删除客户端检查。然后，将这些修改后的值提交给server.：：PHASE：Implementation：STRATEGY：Compilation或构建强化：有效性：Description：仔细检查编译器警告，并消除潜在的安全问题，例如内存操作中有符号/无符号不匹配，或者使用未初始化的变量。即使这一弱点很少被利用，单一的失败也可能导致整个系统的妥协。
<h5>观察到的例子</h5>：：REFERENCE：CVE-2010-2753：DESCRIPTION：chain：integer overflow leads to use-after-free：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2010-2753REFERENCE：CVE-2002-0391：DESCRIPTION：Integer overflow via a large number of arguments.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2002-0391REFERENCE：CVE-2002-0639：DESCRIPTION：Integer overflow in OpenSSH as listed in the demonstrative examples.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2002-0639REFERENCE：CVE-2005-1141：DESCRIPTION：Image with large width and height leads to integer overflow.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2005-1141REFERENCE：CVE-2005-0102：DESCRIPTION：Length value of-1 leads to allocation of 0 bytes and resultant heap overflow.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2005-0102REFERENCE：CVE-2004-2013：DESCRIPTION：Length value of-1 leads to allocation of 0 bytes and resultant heap overflow.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2004-2013REFERENCE：CVE-2017-1000121：DESCRIPTION：chain：unchecked message size metadata allows integer overflow(CWE-190)leading to buffer overflow(CWE-119).：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2017-1000121
<h5>功能区域</h5>*号码处理-记忆管理计数
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：PLOVER：ENTRY NAME：Integer overflow(wrap or wraparound)：TAXONOMY NAME：7 Pernicious Kingdoms：ENTRY NAME：Integer Overflow：TAXONOMY NAME：CLASP：ENTRY NAME：Integer overflow：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：INT18-C：ENTRY NAME：Evaluate integer expressions in a larger size before comparing or assigning to that size：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：INT30-C：ENTRY NAME：Ensure that unsigned integer operations do not wrap：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：INT32-C：ENTRY NAME：Ensure that operations on signed integers do not result in overflow：MAPPING FIT：Imprecise：TAXONOMYNAME：CERT C Secure Coding：ENTRY ID：INT35-C：ENTRY NAME：Evaluate integer expressions in a larger size before comparing or assigning to that size：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：MEM07-C：ENTRY NAME：Ensure that the arguments to calloc()，when multiplied，do not wrap：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：MEM35-C：ENTRY NAME：Allocate sufficient memory for an object：TAXONOMY NAME：WASC：ENTRY ID：3：ENTRY NAME：Integer Overflows：TAXONOMY NAME：Software Fault Patterns：ENTRY ID：SFP1：ENTRY NAME：Glitch in computation：：
<h5>相关的攻击模式</h5>92：
<h5>笔记</h5>类型：关系：注：整数溢出可能是缓冲区溢出的主要原因。：类型：术语：注意：整数溢出有时用于覆盖几种类型的错误，包括签名错误，或涉及操作整数数据类型而不是字符的缓冲区溢出。混淆的部分原因是0xffffff在签名上下文中是-1。其他混淆也是由于整数溢出在链中所起的作用。

