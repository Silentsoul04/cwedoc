# ID: 134 - 使用外部控制的格式字符串
<h5>名称</h5>使用外部控制的格式字符串
<h5>弱点抽象</h5>底座
<h5>状态</h5>草案
<h5>描述</h5>该软件使用一个函数，该函数接受格式字符串作为参数，但格式字符串来自外部源。
<h5>扩展描述</h5>当攻击者可以修改外部控制的格式字符串时，这可能会导致缓冲区溢出、拒绝服务或数据表示问题。应该注意的是，在某些情况下，例如国际化，格式字符串集是由设计外部控制的。如果这些格式字符串的源是可信的(例如，仅包含在只能由系统管理员修改的库文件中)，则外部控件本身可能不会造成漏洞。
<h5>相关的弱点</h5>*性质：子女：CWE ID：74：视图ID：1000：序数：初级：自然：子女：CWE ID：74：视图ID：699：主：自然：CWE ID：74：视图ID：1003：序数：主：自然：PeerOf：CWE ID：123：View ID：1000：大自然：CWE ID：20：View ID：700：序数：PRIMARE：CWE ID：123：View ID：1000：大自然：CWE ID：20：View ID：700：序数：
<h5>弱点规律</h5>*序号：主要：说明：
<h5>适用的平台</h5>*语言名称：C：语言流行率：常：语言名称：C+：语言流行率：语言名称：Perl：语言流行率：很少：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>：PHASE：Implementation：DESCRIPTION：PHASE：Implementation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：机密性：技术影响：读取内存：注意：机密性读取内存格式字符串问题允许信息泄露，这会严重简化program.：：SCOPE：Integrity：SCOPE：Confidentiality：SCOPE：Availability：TECHNICAL影响的利用：执行未经授权的代码或命令：注意：完整性保密性可用性执行未经授权的代码或命令格式字符串问题可能导致任意代码的执行。
<h5>检测方法</h5>*方法：自动静态分析：有效性：描述：这一弱点经常可以使用自动静态分析工具检测到。许多现代工具使用数据流分析或基于约束的技术来最小化错误阳性的数量。：方法：黑匣子：有效性：有限：描述：由于格式字符串经常发生在很少发生的错误条件下(例如，对于错误消息记录)，它们很难使用黑匣子方法来检测。很可能在没有相关源代码(或等效源代码)的可执行文件中存在许多潜在的问题。：方法：自动静态分析-二进制或Bytecode：EFFECTIVENESS：High：DESCRIPTION：According以快速上升，以下检测技术可能是有用的：高成本效益：字节码弱点分析-包括反汇编程序+源代码弱点分析二进制弱点分析-包括反汇编程序+源代码弱点分析部分覆盖的成本效益：二进制/字节码简单extractorâstrings，ELF readers，etc.：：METHOD：Manual Static Analysis-Binary or Bytecode：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Binary/Bytecode disassembler-then use manual analysis for vulnerabilities&anomalies：：METHOD：Dynamic Analysis with Automated Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Web Application Scanner Web Services Scanner Database Scanners：：METHOD：Dynamic Analysis withManual Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Fuzz Tester Framework-based Fuzzer：：METHOD：Manual Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Manual Source Code Review(not inspections)Cost effective for partial coverage：Focused Manual Spotcheck-Focused manual analysis of source：：METHOD：Automated Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques可能有用：高成本效益：源代码缺陷分析器上下文-配置的源代码缺陷分析器对部分覆盖的成本效益：警告标志：方法：架构或设计Review：EFFECTIVENESS：High：DESCRIPTION：According以突飞猛进，以下检测技术可能有用：高成本效益：形式方法/部分覆盖的结构成本效益：检查(IEEE1028标准)(可适用于需求、设计、源代码等)：
<h5>潜在的缓解措施</h5>：：PHASE：Requirements：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Choose是一种不受此flaw.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Ensure约束的语言，所有格式字符串函数都被传递给一个静态字符串，该字符串不能由用户控制，并且始终向该函数发送适当数量的参数。如果可能，请使用格式字符串中不支持%n运算符的函数。[参考文献116][参考文献117]：阶段：生成和Compilation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Heed编译器和链接器的警告，因为它们可能会警告您使用不当。：
<h5>观察到的例子</h5>：：REFERENCE：CVE-2002-1825：DESCRIPTION：format string in Perl program：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2002-1825REFERENCE：CVE-2001-0717：DESCRIPTION：format string in bad call to syslog function：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2001-0717REFERENCE：CVE-2002-0573：DESCRIPTION：format string in bad call to syslog function：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2002-0573REFERENCE：CVE-2002-1788：DESCRIPTION：format strings in NNTP server responses：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2002-1788REFERENCE：CVE-2006-2480：DESCRIPTION：Format string vulnerability exploited by triggering errors or warnings，as demonstrated via format string specifiers in a.bmp filename.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2006-2480REFERENCE：CVE-2007-2027：DESCRIPTION：Chain：untrusted search path enabling resultant format string by loading malicious internationalization messages：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-2027
<h5>功能区域</h5>*LoggingError HandlingString处理
<h5>影响资源</h5>记忆：
<h5>分类法映射</h5>TAXONOMY NAME：PLOVER：ENTRY NAME：Format string vulnerability：TAXONOMY NAME：7 Pernicious Kingdoms：ENTRY NAME：Format String：TAXONOMY NAME：CLASP：ENTRY NAME：Format string problem：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：FIO30-C：ENTRY NAME：Exclude user input from format strings：MAPPING FIT：Exact：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：FIO47-C：ENTRY NAME：Use valid format strings：MAPPING FIT：CWE More Specific：TAXONOMY NAME：OWASP Top Ten 2004：ENTRY ID：A1：ENTRY NAME：Unvalidated Input：MAPPING FIT：CWE More Specific：TAXONOMY NAME：WASC：ENTRY ID：6：ENTRY NAME：Format String：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：IDS06-J：ENTRY NAME：Exclude user input from format strings：TAXONOMY NAME：CERT Perl Secure Coding：ENTRY ID：IDS30-PL：ENTRY NAME：Exclude user从格式字符串输入：映射匹配：精确：分类名称：软件故障模式：条目ID：SFP 24：入口名称：受污染的命令输入：
<h5>相关的攻击模式</h5>135：67：
<h5>笔记</h5>类型：适用平台：注意：在任何支持格式字符串的编程语言中都可能存在此缺陷。：类型：其他：注意：虽然格式字符串漏洞通常属于缓冲区溢出类别，但在技术上它们不是溢出缓冲区。格式字符串漏洞是一个相当新的漏洞(大约在1999年左右)，其原因是一个函数没有实际的方法来使用可变数量的参数来确定传入了多少个参数。使用可变数量的参数(包括C-运行时函数)的最常见函数是printf()系列调用。格式字符串问题以多种方式出现。没有格式说明符的*printf()调用是危险的，可能被利用。例如，printf(输入)；是可利用的，而printf(y，put)；在这种情况下是不可利用的。第一次调用的结果(使用不当)允许攻击者查看堆栈内存，因为输入字符串将用作格式说明符。攻击者可以使用格式说明符填充输入字符串，并开始读取堆栈值，因为其余参数将从堆栈中提取。最糟糕的情况是，这种不当的使用可能会提供足够的控制，允许将任意值(或在利用程序的情况下的值)写入正在运行的程序的内存中。通常的目标实体是文件名、进程名、标识符。格式字符串问题是一个典型的C/C+问题，由于发现容易，现在很少出现这种问题。可利用格式字符串漏洞的一个主要原因是%n运算符造成的。%n运算符将迄今已由格式字符串打印的字符数写入其参数所指向的内存。通过熟练地创建格式字符串，恶意用户可能会使用堆栈上的值来创建写什么-哪里的条件。一旦实现了这一点，他们就可以执行任意代码。其他操作符也可以使用；例如，一个99 s操作符也可能触发缓冲区溢出，或者在fprintf等文件格式化函数中使用时，它可以产生比预期大得多的输出。：类型：Research Gap：Format String问题正在研究中-研究的语言不是C.内存或磁盘消耗、控制流或变量更改，数据损坏可能是在用Perl、PHP、Python等其他语言编写的应用程序中利用格式字符串造成的。

