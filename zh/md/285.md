# ID: 285 - 不当授权
<h5>名称</h5>不当授权
<h5>弱点抽象</h5>班级，等级
<h5>状态</h5>草案
<h5>描述</h5>当参与者试图访问资源或执行操作时，软件不会执行或不正确地执行授权检查。
<h5>扩展描述</h5>假设具有给定身份的用户，授权是根据用户的权限和任何权限或其他应用于资源的访问控制规范来确定该用户是否可以访问给定资源的过程。当访问控制检查没有一致地应用时-或者根本不适用-用户就能够访问数据或执行不应该被允许执行的操作。这可能导致广泛的问题，包括信息暴露、拒绝服务和任意代码执行。
<h5>相关的弱点</h5>*性质：子女：CWE ID：284：视图ID：1000：序数：基本：自然：子类ID：284：视图ID：699：序号：基本：自然ID：284：视图ID：1003：序数：PRIMARE：COWE ID：284：视图ID：1003：PRIMARE：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言独立：语言流行率：待定：技术名称：Web服务器：技术流行率：经常：技术名称：数据库服务器：技术流行率：经常：
<h5>背景细节</h5>*访问控制列表(ACL)表示对给定对象具有权限的人/对象。不同的操作系统以不同的方式实现(ACL)。在UNIX中，有三种类型的权限：读、写和执行。用户分为三个文件访问类：Owner、GroupOwner和所有其他用户，每个类都有一个单独的权限集。在WindowsNT中，文件的权限有四种基本类型：无访问权限、读取访问权限、更改访问权限和完全控制权限。Windows NT扩展了UNIX中三种类型用户的概念，包括用户和组的列表及其相关权限。用户可以创建对象(文件)并为该对象分配指定的权限。：
<h5>替代条款</h5>*术语：AuthZ：Description：AuthZ通常用作Web应用程序安全社区中授权的缩写。它还有别于AuthC，AuthC是身份验证的缩写。不鼓励使用Auth作为缩写，因为它可以用于身份验证或授权。
<h5>模式的介绍</h5>：PHASE：Implementation：DESCRIPTION：PHASE：Architecture和Design：DESCRIPTION：PHASE：Operation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：机密性：技术影响：读取应用程序数据读取文件或目录：注意：机密性读取应用程序数据读取文件或目录-攻击者可以通过直接从未受到适当限制的数据存储读取数据，或者通过访问保护不足的特权功能来读取数据。：范围：完整性：技术影响：修改应用程序数据修改文件或目录：注意：完整性修改应用程序数据修改文件或目录攻击者可以通过写入敏感数据修改敏感数据数据直接进入未受到适当限制的数据存储区，或通过访问保护不足的特权功能来写入数据。：范围：访问控制：技术影响：获取特权或假定身份：注意：访问控制增益特权或假定身份攻击者可以通过直接修改或读取关键数据或访问保护不足的特权功能获得特权：
<h5>检测方法</h5>*方法：自动静态Analysis：EFFECTIVENESS：Limited：DESCRIPTION：Automated静态分析用于检测常用的用于授权的成语.工具可以分析相关的配置文件，例如ApacheWeb服务器中的.htaccess，或者检测常用授权库的使用情况。通常，自动静态分析工具难以检测自定义授权方案。此外，该软件的设计可能包括一些可供任何用户访问且不需要授权检查的功能；检测没有授权的自动化技术可能报告错误。：方法：自动动态分析：有效性：描述：自动动态分析可以找到许多或所有可能的不需要授权的接口，但是需要手动分析才能确定缺乏授权是否违反了业务逻辑：方法：手动的Analysis：EFFECTIVENESS：Moderate：DESCRIPTION：This弱点。使用需要手动(人工)分析的工具和技术检测，例如渗透测试、威胁建模和交互式工具，这些工具允许测试人员记录和修改活动会话。Specifically，manual static analysis is useful for evaluating the correctness of custom authorization mechanisms.：：METHOD：Manual Static Analysis-Binary or Bytecode：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Binary/Bytecode disassembler-then use manual analysis for vulnerabilities&anomalies：：METHOD：Dynamic Analysis with Automated Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Web ApplicationScanner Web Services Scanner Database Scanners：：METHOD：Dynamic Analysis with Manual Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Host Application Interface Scanner Fuzz Tester Framework-based Fuzzer Forced Path Execution Monitored Virtual Environment-run potentially malicious code in sandbox/wrapper/virtual machine，see if it does anything suspicious：：METHOD：Manual Static Analysis-Source Code：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniquesmay be useful：Cost effective for partial coverage：Focused Manual Spotcheck-Focused manual analysis of source Manual Source Code Review(not inspections)：：METHOD：Automated Static Analysis-Source Code：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Context-configured Source Code Weakness Analyzer：：METHOD：Architecture or Design Review：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Formal Methods/Correct-By-Construction Cost effective for部分覆盖：检查(IEEE 1028标准)(可适用于需求、设计、源代码等)：
<h5>潜在的缓解措施</h5>阶段：架构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Divide软件进入匿名、正常、特权和管理领域。通过仔细映射数据和功能的角色来减少攻击面。使用基于角色的访问控制(RBAC)在适当的边界强制执行角色.请注意，这种方法可能无法防止横向授权，即，它不会保护用户免受具有与业务逻辑相关的访问控制检查的角色相同的其他用户的攻击。：阶段：体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Ensure。这些检查可能与应用于更一般资源(如文件、连接、进程、内存和数据库记录)的访问控制检查不同。例如，数据库可能会限制特定数据库用户对医疗记录的访问，但每个记录可能只打算供患者和病人的医生访问。：阶段：体系结构和设计：策略：库或框架：有效性：描述：使用经过审查的库或框架，该库或框架不允许出现此缺陷，或提供更容易避免此弱点的构造。例如，考虑使用授权框架，如JAAS授权框架[ref-233]和OWASESAPI访问控制功能[ref-45].：Stage：Architecture和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：For Web应用程序，确保访问控制机制在每个页面的服务器端得到正确的执行。用户不能仅仅通过请求直接访问该页面来访问任何未经授权的功能或信息。这样做的一种方法是确保所有包含敏感信息的页面都不被缓存，并且所有此类页面都限制对与具有访问该页所需权限的用户相关联的活动的、经过身份验证的会话令牌的请求的访问。：阶段：System Configuration Installation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Use您的操作系统和服务器环境的访问控制功能，并相应地定义您的访问控制列表。在定义这些ACL时使用默认的拒绝策略。：
<h5>观察到的例子</h5>::REFERENCE:CVE-2009-3168:DESCRIPTION:Web application does not restrict access to admin scripts, allowing authenticated users to reset administrative passwords.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3168REFERENCE:CVE-2009-2960:DESCRIPTION:Web application does not restrict access to admin scripts, allowing authenticated users to modify passwords of other users.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2960REFERENCE:CVE-2009-3597:DESCRIPTION:Web application stores database file under the web root with insufficient access control (CWE-219), allowing direct request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3597REFERENCE:CVE-2009-2282:DESCRIPTION:Terminal server does not check authorization for guest access.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2282REFERENCE:CVE-2009-3230:DESCRIPTION:Database server does not use appropriate privileges for certain sensitive operations.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3230REFERENCE:CVE-2009-2213:DESCRIPTION:Gateway uses default Allow configuration for its authorization settings.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2213REFERENCE:CVE-2009-0034:DESCRIPTION:Chain: product does not properly interpret a configuration option for a system group, allowing users to gain privileges.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0034REFERENCE:CVE-2008-6123:DESCRIPTION:Chain: SNMP product does not properly parse a configuration option for which hosts are allowed to connect, allowing unauthorized IP addresses to connect.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-6123REFERENCE:CVE-2008-5027:DESCRIPTION:System monitoring software allows users to bypass authorization by creating custom forms.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5027REFERENCE:CVE-2008-7109:DESCRIPTION:Chain: reliance on client-side security (CWE-602) allows attackers to bypass authorization using a custom client.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-7109REFERENCE:CVE-2008-3424:DESCRIPTION:Chain: product does not properly handle wildcards in an authorization policy list, allowing unintended access.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3424REFERENCE:CVE-2009-3781:DESCRIPTION:Content management system does not check access permissions for private files, allowing others to view those files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3781REFERENCE:CVE-2008-4577:DESCRIPTION:ACL-based protection mechanism treats negative access rights as if they are positive, allowing bypass of intended restrictions.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4577REFERENCE:CVE-2008-6548:DESCRIPTION:Product does not check the ACL of a page accessed using an include directive, allowing attackers to read unauthorized files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-6548REFERENCE:CVE-2007-2925:DESCRIPTION:Default ACL list for a DNS server does not set certain ACLs, allowing unauthorized DNS queries.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-2925REFERENCE:CVE-2006-6679:DESCRIPTION:Product relies on the X-Forwarded-For HTTP header for authorization, allowing unintended access by spoofing the header.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6679REFERENCE:CVE-2005-3623:DESCRIPTION:OS kernel does not check for a certain privilege before setting ACLs for files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3623REFERENCE:CVE-2005-2801:DESCRIPTION:Chain: file-system code performs an incorrect comparison (CWE-697), preventing default ACLs from being properly applied.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2801REFERENCE:CVE-2001-1155:DESCRIPTION:Chain: product does not properly check the result of a reverse DNS lookup because of operator precedence (CWE-783), allowing bypass of DNS-based access restrictions.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1155
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：7 Pernicious Kingdoms：ENTRY NAME：Missing Access Control：TAXONOMY NAME：OWASP Top Ten 2007：ENTRY ID：A10：ENTRY NAME：Failure to Restrict URL Access：MAPPING FIT：CWE More Specific：TAXONOMY NAME：OWASP Top Ten 2004：ENTRY ID：A2：ENTRY NAME：Broken Access Control：MAPPING FIT：CWE More Specific：TAXONOMY NAME：Software Fault Patterns：ENTRY ID：SFP35：ENTRY NAME：Insecure resource access：：
<h5>相关的攻击模式</h5>：：1：：104：：127：：13：：17：：39：：45：：51：：59：：60：：76：：77：：87：：
<h5>笔记</h5>空

