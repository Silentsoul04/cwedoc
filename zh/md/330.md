# ID: 330 - 不充分随机值的使用
<h5>名称</h5>不充分随机值的使用
<h5>弱点抽象</h5>班级，等级
<h5>状态</h5>可用
<h5>描述</h5>软件可能在依赖不可预测的数字的安全上下文中使用不够随机的数字或值。
<h5>扩展描述</h5>当软件在需要不可预测性的上下文中生成可预测值时，攻击者可能会猜测将生成的下一个值，并使用此猜测模拟另一个用户或访问敏感信息。
<h5>相关的弱点</h5>空
<h5>弱点规律</h5>*序号：主要：说明：
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>*计算机是确定性机器，因此无法产生真正的随机性。伪随机数发生器(PRNG)近似随机数的算法，从一个种子开始计算后续的值。PRNG有两种类型：统计和密码学。统计PRNG提供了有用的统计属性，但是它们的输出是高度可预测的，并且形成了一个易于再现的数字流，在安全性依赖于生成的值不可预测的情况下，这种流不适合使用。密码PRNG通过产生更难以预测的输出来解决这个问题。要使一个值具有密码安全性，攻击者必须不可能或极不可能将其与真正的随机值区分开来。
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：架构和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：机密性：范围：其他技术影响：注意：当保护机制依赖随机值限制对敏感资源的访问时，如会话ID或用于生成加密密钥的种子，则可以通过猜测ID或密钥来访问受保护的资源。：范围：访问控制：范围：其他：技术影响：旁路保护机制：注意：如果软件依赖唯一、不可猜测的ID来识别资源，则攻击者可以访问其他的访问控制旁路保护机制。可能能够猜测另一个用户拥有的资源的ID。然后，攻击者可以读取资源，或预先创建具有相同ID的资源，以防止合法程序正确地将资源发送给预期用户。例如，产品可能在基于用户名的文件中维护会话信息。攻击者可以为受害用户预先创建此文件，然后设置权限，以便应用程序无法为受害者生成会话，从而防止受害者使用应用程序。：范围：访问控制：技术影响：绕过保护机制获得特权或假定身份：注意：访问控制旁路保护机制获得特权，或者在授权或身份验证机制依赖随机值限制对受限功能(如会话)的访问时假定身份。用于生成加密密钥的ID或种子，则攻击者可以通过猜测ID或密钥来访问受限的功能。：
<h5>检测方法</h5>*方法：黑匣子：有效性：说明：使用监测工具，检查软件与操作系统和网络交互时的过程。如果源代码不可用，或者软件不是由您开发的，或者您想要验证构建阶段没有引入任何新的弱点，这种技术是非常有用的。示例包括直接附加到正在运行的进程的调试器；系统调用跟踪实用程序(如桁架(Solaris)和strace(Linux)；系统活动监视器(如Filemon、RegMon、ProcessMonitor和其他Sysinals实用程序(Windows)；监视网络流量的嗅探器和协议分析器。将监视器附加到进程，并查找指示何时使用随机性的库函数。多次运行该进程，以查看种子是否更改。查找通常用于强(或弱)随机性的设备或等效资源的访问，例如Linux上的/dev/urandom。Look for library or system calls that access predictable information such as process IDs and system time.：：METHOD：Automated Static Analysis-Binary or Bytecode：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Bytecode Weakness Analysis-including disassembler+source code weakness analysis Binary Weakness Analysis-including disassembler+source code weakness analysis：：METHOD：Manual Static Analysis-Binary or Bytecode：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，thefollowing detection techniques may be useful：Cost effective for partial coverage：Binary/Bytecode disassembler-then use manual analysis for vulnerabilities&anomalies：：METHOD：Dynamic Analysis with Manual Results Interpretation：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Man-in-the-middle attack tool：：METHOD：Manual Static Analysis-Source Code：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Focused Manual Spotcheck-Focused manualanalysis of source Manual Source Code Review(not inspections)：：METHOD：Automated Static Analysis-Source Code：EFFECTIVENESS：SOAR Partial：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Cost effective for partial coverage：Source code Weakness Analyzer Context-configured Source Code Weakness Analyzer：：METHOD：Architecture or Design Review：EFFECTIVENESS：High：DESCRIPTION：According to SOAR，the following detection techniques may be useful：Highly cost effective：Inspection(IEEE 1028 standard)(can apply to requirements，design，source code，etc.)：：
<h5>潜在的缓解措施</h5>阶段：架构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Use-一种经过良好审查的算法，目前被该领域的专家认为很强，并选择具有足够长度种子的经过良好测试的实现。一般来说，如果伪随机数生成器没有被宣传为密码安全，那么它很可能是一个统计PRNG，不应该在安全敏感的上下文中使用。伪随机数发生器可以产生可预测的数字，如果生成器是已知的，种子可以猜测。一个256位的种子是一个很好的起点，可以产生一个足够随机的number.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Consider，它可以根据需要从高质量的伪随机输出源(例如针对这种弱点的硬件devices.：：PHASE：Testing：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Use自动静态分析工具)重新播种自己。许多现代技术使用数据流分析来减少假阳性的数量。这不是一个完美的解决方案，因为100%的准确性和覆盖率是不可行的。：阶段：体系结构和设计需求：策略：库或框架：有效性：描述：使用符合FIPS 140-2[参考文献-267]的产品或模块来避免明显的熵问题。参考FIPS 140-2附件C(批准的随机数Generators).：：PHASE：Testing：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Use工具和需要人工(人)分析的技术，例如渗透测试、威胁建模以及允许测试人员记录和修改活动会话的交互式工具。这些技术可能比严格自动化的技术更有效。与设计和业务规则有关的弱点尤其如此：
<h5>观察到的例子</h5>：：REFERENCE：CVE-2009-3278：DESCRIPTION：Crypto product uses rand()library function to generate a recovery key，making it easier to conduct brute force attacks.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-3278REFERENCE：CVE-2009-3238：DESCRIPTION：Random number generator can repeatedly generate the same value.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-3238REFERENCE：CVE-2009-2367：DESCRIPTION：Web application generates predictable session IDs，allowing session hijacking.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2367REFERENCE：CVE-2009-2158：DESCRIPTION：Password recovery utility generates a relatively small number of random passwords，simplifying brute force attacks.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2158REFERENCE：CVE-2009-0255：DESCRIPTION：Cryptographic key created with a seed based on the system time.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-0255REFERENCE：CVE-2008-5162：DESCRIPTION：Kernel function does not have a good entropy source just after boot.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-5162REFERENCE：CVE-2008-4905：DESCRIPTION：Bloggingsoftware uses a hard-coded salt when calculating a password hash.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-4905REFERENCE：CVE-2008-4929：DESCRIPTION：Bulletin board application uses insufficiently random names for uploaded files，allowing other users to access private files.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-4929REFERENCE：CVE-2008-3612：DESCRIPTION：Handheld device uses predictable TCP sequence numbers，allowing spoofing or hijacking of TCP connections.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-3612REFERENCE：CVE-2008-2433：DESCRIPTION：Web management console generates session IDs based on the login time，making it easier to conduct session hijacking.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-2433REFERENCE：CVE-2008-0166：DESCRIPTION：SSL library uses a weak random number generator that only generates 65，536 unique keys.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-0166REFERENCE：CVE-2008-2108：DESCRIPTION：Chain：insufficientprecision causes extra zero bits to be assigned，reducing entropy for an API function that generates random numbers.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-2108REFERENCE：CVE-2008-2020：DESCRIPTION：CAPTCHA implementation does not produce enough different images，allowing bypass using a database of all possible checksums.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-2020REFERENCE：CVE-2008-0087：DESCRIPTION：DNS client uses predictable DNS transaction IDs，allowing DNS spoofing.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-0087REFERENCE：CVE-2008-0141：DESCRIPTION：Application generates passwords that are based on the time of day.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-0141
<h5>功能区域</h5>*密码认证-分离管理
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：PLOVER：ENTRY NAME：Randomness and Predictability：TAXONOMY NAME：7 Pernicious Kingdoms：ENTRY NAME：Insecure Randomness：TAXONOMY NAME：OWASP Top Ten 2004：ENTRY ID：A2：ENTRY NAME：Broken Access Control：MAPPING FIT：CWE More Specific：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：CON33-C：ENTRY NAME：Avoid race conditions when using library functions：MAPPING FIT：Imprecise：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：MSC30-C：ENTRY NAME：Do not use the rand()function for generating pseudorandom numbers：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：CERT C Secure Coding：ENTRY ID：MSC32-C：ENTRY NAME：Properly seed pseudorandom number generators：MAPPING FIT：CWE More Abstract：TAXONOMY NAME：WASC：ENTRY ID：11：ENTRY NAME：Brute Force：TAXONOMY NAME：WASC：ENTRYID：18：条目名称：凭证/会话预测：分类法名称：CET Java安全编码：条目ID：MSC02-J：条目名称：生成强随机数：
<h5>相关的攻击模式</h5>*112：485：59：
<h5>笔记</h5>类型：关系：注意：这可能是许多其他缺陷的主要原因，如密码错误、身份验证错误、符号链接跟踪、信息泄漏等。

