# ID: 838 - 不适当的输出上下文编码
<h5>名称</h5>不适当的输出上下文编码
<h5>弱点抽象</h5>底座
<h5>状态</h5>不完全
<h5>描述</h5>软件在向下游组件生成输出时使用或指定编码，但指定的编码与下游组件所期望的编码不同。
<h5>扩展描述</h5>这一弱点可能导致下游组件使用一种解码方法，该解码方法产生与软件打算发送的数据不同的数据。当使用错误的编码时-即使关系密切-下游组件可能对数据进行错误的解码。当提供的控件和数据之间的边界被无意中打破时，这可能会产生安全后果，因为结果数据可能会引入控制字符或软件未发送的特殊元素。由此产生的数据可以用于绕过保护机制，如输入验证，并启用注入攻击。虽然使用输出编码对于确保组件之间的通信是准确的至关重要，但使用错误的编码-即使是密切相关-可能会导致下游组件误解输出。例如，HTML实体编码用于网页HTML主体中的元素。但是，程序员在为HTML标记的属性中使用的输出生成输出时可能使用实体编码，该属性可能包含不受HTML编码影响的函数Javascript。虽然Web应用程序在这个问题上得到了最广泛的关注，但这种弱点可能适用于任何类型的软件，这些软件使用的通信流可以支持多个编码。
<h5>相关的弱点</h5>*性质：子女：CWE ID：116：视图ID：1000：序数：初级：自然：子女：CWE ID：116：视图ID：699：序号：主：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>空
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Integrity：SCOPE：Confidentiality：SCOPE：Availability：TECHNICAL影响：修改应用程序数据执行未经授权的代码或命令：注意：完整性机密性可用性修改应用程序数据执行未经授权的代码或命令攻击者可以修改发送到下游组件的消息或数据的结构，可能是注入命令：
<h5>检测方法</h5>空
<h5>潜在的缓解措施</h5>*阶段：实施：战略：输出编码：有效性：说明：使用上下文感知编码。也就是说，了解下游组件使用的是哪种编码，并确保使用了这种编码。如果可以指定编码，请这样做，而不是假设默认编码与下游组件假定的默认编码相同。：阶段：体系结构和设计：策略：输出编码：有效性：描述：在可能的情况下，使用通信协议或数据格式，在控制和数据之间提供严格的边界。如果这不可行，请确保协议或格式允许通信组件显式地声明正在使用的编码/解码方法。一些模板框架提供内置支持。：阶段：体系结构和设计：策略：库或框架：有效性：描述：使用经过审查的库或框架，该库或框架不允许出现此弱点，或提供更容易避免此弱点的构造。例如，考虑使用ESAPI编码控件[ref-45]或类似的工具、库或框架。这将有助于程序员以一种不容易出错的方式对输出进行编码。请注意，一些模板机制为适当的编码提供了内置支持。
<h5>观察到的例子</h5>*参考：cve-2009-2814：说明：服务器没有正确处理不包含utf-8数据的请求；浏览器假定utf-8，允许XSS.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2814
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类法名称：certJava安全编码：条目ID：IDS13-J：条目名称：在文件或网络的两侧使用兼容编码IO：
<h5>相关的攻击模式</h5>*468：
<h5>笔记</h5>空

