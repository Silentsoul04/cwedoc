# ID: 400 - 不受控制的资源消耗(“资源枯竭”)
<h5>名称</h5>不受控制的资源消耗(“资源枯竭”)
<h5>弱点抽象</h5>班级，等级
<h5>状态</h5>不完全
<h5>描述</h5>软件没有适当地限制参与者请求或影响的资源的大小或数量，这些资源可以用于消耗比预期更多的资源。
<h5>扩展描述</h5>有限的资源包括内存、文件系统存储、数据库连接池条目或CPU。如果攻击者可以触发这些有限资源的分配，但无法控制资源的数量或大小，则攻击者可能导致拒绝服务，从而消耗所有可用资源。这将阻止有效用户访问软件，并可能对周围环境产生影响。例如，针对应用程序的内存耗尽攻击可能会减慢应用程序及其主机操作系统的速度。资源耗尽问题至少有两个共同的原因：错误条件和其他异常情况，对于程序的哪一部分负责释放资源的混淆。
<h5>相关的弱点</h5>*性质：子女：CWE ID：664：视图ID：1000：序数：主：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>：PHASE：Operation：DESCRIPTION：PHASE：Architecture和Design：DESCRIPTION：PHASE：Implementation：DESCRIPTION：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>*范围：可用性：技术影响：DoS：崩溃、退出或重新启动DoS：资源消耗(CPU)DoS：资源消耗(内存)DoS：资源消耗(其他)：注意：可用性DoS：崩溃、退出或重新启动DoS：资源消耗(CPU)DoS：资源消耗(内存)DoS：资源耗尽(其他)最常见的结果是拒绝服务。该软件可能因未处理的错误而减速、崩溃，或锁定合法用户。：范围：访问控制：范围：其他：技术影响：旁路保护机制其他：注意：访问控制其他旁路保护机制-在某些情况下，可能会在资源耗尽时强制该软件无法打开。然后，软件的状态-可能还有安全功能-可能会受到损害。：
<h5>检测方法</h5>*方法：自动静态Analysis：EFFECTIVENESS：Limited：DESCRIPTION：Automated静态分析在识别资源耗尽问题方面通常具有有限的效用，但与程序无关的系统资源(如文件、套接字和进程)除外。对于系统资源，自动静态分析可以检测资源过期后未释放的情况。自动分析配置文件可以检测没有指定最大值的设置。自动静态分析工具不适用于检测自定义资源的耗尽，例如一个预定的安全策略，在该策略中，公告板用户每天只能发布数量有限的帖子。：方法：自动动态Analysis：EFFECTIVENESS：Moderate：DESCRIPTION：Certain自动动态分析技术可能有效地发现资源耗尽问题，特别是在进程、内存和连接等资源中。该技术可能涉及在短时间内生成大量对软件的请求，frame.：：METHOD：Fuzzing：EFFECTIVENESS：Opportunistic：DESCRIPTION：While模糊化通常是为了查找低级别的实现错误，它可能无意中发现资源耗尽问题。当Fuzzer生成大量测试用例但在测试用例之间没有重新启动目标软件时，就会发生这种情况。如果单个测试用例产生崩溃，但不可靠，则无法处理资源耗尽可能是原因。
<h5>潜在的缓解措施</h5>阶段：体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Design节流机制进入系统架构。最好的保护措施是限制未经授权的用户可能导致的资源消耗。一个强大的身份验证和访问控制模型首先将有助于防止此类攻击的发生。登录应用程序应尽可能防止DoS攻击。限制数据库访问，也许通过缓存结果集，可以帮助最小化所消耗的资源。要进一步限制DoS攻击的可能性，请考虑跟踪从用户收到的请求的速率和阻止超过定义速率阈值的请求。：阶段：资源耗尽攻击的体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Mitigation要求目标系统要么识别攻击，要么在给定的时间内拒绝用户进一步访问，或者统一限制所有请求，以便更快地消耗资源，而不是再次释放资源。但是，这些解决方案中的第一个本身就是一个问题，因为它可能允许攻击者阻止特定有效用户使用系统。如果攻击者冒充有效用户，则可能会阻止用户访问有关服务器。第二个解决方案很难有效地实施-即使做得好，也不能提供一个完整的解决方案。它只是使得攻击者需要更多的资源。：Stage：Architecture和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Ensure-协议对them.：：PHASE：Implementation：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：Ensure设置了特定的规模限制-所有资源分配的失败都将系统置于一个安全的状态。：
<h5>观察到的例子</h5>：：REFERENCE：CVE-2009-2874：DESCRIPTION：Product allows attackers to cause a crash via a large number of connections.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2874REFERENCE：CVE-2009-1928：DESCRIPTION：Malformed request triggers uncontrolled recursion，leading to stack exhaustion.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-1928REFERENCE：CVE-2009-2858：DESCRIPTION：Chain：memory leak(CWE-404)leads to resource exhaustion.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2858REFERENCE：CVE-2009-2726：DESCRIPTION：Driver does not use a maximum width when invoking sscanf style functions，causing stack consumption.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2726REFERENCE：CVE-2009-2540：DESCRIPTION：Large integer value for a length property in an object causes a large amount of memory allocation.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2540REFERENCE：CVE-2009-2299：DESCRIPTION：Web application firewall consumes excessive memory when an HTTP request contains a largeContent-Length value but no POST data.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2299REFERENCE：CVE-2009-2054：DESCRIPTION：Product allows exhaustion of file descriptors when processing a large number of TCP packets.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2009-2054REFERENCE：CVE-2008-5180：DESCRIPTION：Communication product allows memory consumption with a large number of SIP requests，which cause many sessions to be created.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-5180REFERENCE：CVE-2008-2121：DESCRIPTION：TCP implementation allows attackers to consume CPU and prevent new connections using a TCP SYN flood attack.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-2121REFERENCE：CVE-2008-2122：DESCRIPTION：Port scan triggers CPU consumption with processes that attempt to read data from closed sockets.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-2122REFERENCE：CVE-2008-1700：DESCRIPTION：Product allows attackers tocause a denial of service via a large number of directives，each of which opens a separate window.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-1700REFERENCE：CVE-2007-4103：DESCRIPTION：Product allows resource exhaustion via a large number of calls that do not complete a 3-way handshake.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-4103REFERENCE：CVE-2006-1173：DESCRIPTION：Mail server does not properly handle deeply nested multipart MIME messages，leading to stack exhaustion.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2006-1173REFERENCE：CVE-2007-0897：DESCRIPTION：Chain：anti-virus product encounters a malformed file but returns from a function without closing a file descriptor(CWE-775)leading to file descriptor consumption(CWE-400)and failed scans.：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2007-0897
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>TAXONOMY NAME：CLASP：ENTRY NAME：Resource exhaustion(file descriptor，disk space，sockets，.)：TAXONOMY NAME：OWASP Top Ten 2004：ENTRY ID：A9：ENTRY NAME：Denial of Service：MAPPING FIT：CWE More Specific：TAXONOMY NAME：WASC：ENTRY ID：10：ENTRY NAME：Denial of Service：TAXONOMY NAME：WASC：ENTRY ID：41：ENTRY NAME：XML Attribute Blowup：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：SER12-J：ENTRY NAME：Avoid memory and resource leaks during serialization：TAXONOMY NAME：CERT Java Secure Coding：ENTRY ID：MSC05-J：ENTRY NAME：Do not exhaust heap space：TAXONOMY NAME：Software Fault Patterns：ENTRY ID：SFP13：ENTRY NAME：Unrestricted Consumption：：
<h5>相关的攻击模式</h5>*147：197：2：82：
<h5>笔记</h5>类型：其他：注意：需要很长时间处理的数据库查询是很好的DoS目标。攻击者必须编写几行Perl代码才能生成足够的通信量，从而超出站点的跟踪能力。这将有效地防止授权用户使用网站。可以简单地通过确保目标机器必须完成更多的工作和消耗更多的资源来满足请求，而不是攻击者启动请求时所做的工作。这方面的一个主要例子可以在易受macof攻击的旧交换机中找到(以DugSong开发的工具命名)。这些攻击淹没了一个带有随机IP和MAC地址组合的交换机，因此耗尽了交换机的缓存，该缓存保存了哪个端口对应于哪个MAC地址的信息。一旦此缓存耗尽，交换机将以不安全的方式失败，并开始简单地充当集线器，在所有端口上广播所有通信量，并允许进行基本的嗅探攻击。：

