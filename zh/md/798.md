# ID: 798 - 使用硬编码凭据
<h5>名称</h5>使用硬编码凭据
<h5>弱点抽象</h5>底座
<h5>状态</h5>不完全
<h5>描述</h5>该软件包含硬编码凭据，如密码或加密密钥，用于自己的入站身份验证、与外部组件的出站通信或内部数据加密。
<h5>扩展描述</h5>硬编码凭据通常会造成一个严重的漏洞，使得攻击者能够绕过软件管理员配置的身份验证。系统管理员可能很难检测到此漏洞。即使检测到，也很难修复，因此管理员可能被迫完全禁用该产品。有两个主要的变体：入站：该软件包含一种身份验证机制，它根据硬编码的凭证集检查输入凭据。出站：该软件连接到另一个系统或组件，并包含连接到该组件的硬编码凭据。在入站变体中，将创建一个默认的管理帐户，并将一个简单的密码硬编码到产品中，并与该帐户相关联。这个硬编码密码对于产品的每个安装都是相同的，如果不手动修改程序或对软件进行修补，系统管理员通常无法更改或禁用该密码。如果密码被发现或发布(这在互联网上很常见)，那么任何知道这个密码的人都可以访问该产品。最后，由于软件的所有安装都将具有相同的密码，即使是跨不同的组织，这使得大规模的攻击，如蠕虫发生。出站变体适用于使用后端服务进行身份验证的前端系统。后端服务可能需要一个可以很容易发现的固定密码。程序员可以简单地将那些后端凭证硬编码到前端软件中。该程序的任何用户都可以提取密码。具有硬编码密码的客户端系统构成更大的威胁，因为从二进制文件中提取密码通常非常简单。
<h5>相关的弱点</h5>*性质：子女：CWE ID：287：视图ID：1000：序数：基本：自然：子女：ID：344：视图ID：1000：自然：CWE ID：671：视图ID：1000：大自然：PeerOf：CWE ID：257：View ID：1000：
<h5>弱点规律</h5>*序号：主要：说明：
<h5>适用的平台</h5>*语言类：语言独立：语言流行率：待定：Paradign名称：流动：Paradign普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：建筑和设计：说明：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Access Control：TECHNICAL IMPACT：Bypass Protection Mechanism：NOTE：Access Control Bypass Protection Mechanism If hard-coded passwords are used，it is almost certain that malicious users will gain access to the account in question.：：SCOPE：Integrity：SCOPE：Confidentiality：SCOPE：Availability：SCOPE：Access Control：SCOPE：Other：TECHNICAL IMPACT：Read Application Data Gain Privileges or Assume Identity Execute Unauthorized Code or Commands Other：NOTE：Integrity Confidentiality Availability Access Control Other Read Application Data Gain Privileges or Assume Identity Execute Unauthorized Code or Commands Other This weakness can lead to the exposure提供给非预期行为者的资源或功能，可能为攻击者提供敏感信息，甚至执行任意代码。
<h5>检测方法</h5>::METHOD:Black Box:EFFECTIVENESS:Moderate:DESCRIPTION:Credential storage in configuration files is findable using black box methods, but the use of hard-coded credentials for an incoming authentication routine typically involves an account that is not visible outside of the code.::METHOD:Automated Static Analysis:EFFECTIVENESS::DESCRIPTION:Automated white box techniques have been published for detecting hard-coded credentials for incoming authentication, but there is some expert disagreement regarding their effectiveness and applicability to a broad range of methods.::METHOD:Manual Static Analysis:EFFECTIVENESS::DESCRIPTION:This weakness may be detectable using manual code analysis. Unless authentication is decentralized and applied throughout the software, there can be sufficient time for the analyst to find incoming authentication routines and examine the program logic looking for usage of hard-coded credentials. Configuration files could also be analyzed.::METHOD:Manual Dynamic Analysis:EFFECTIVENESS::DESCRIPTION:For hard-coded credentials in incoming authentication: use monitoring tools that examine the software's process as it interacts with the operating system and the network. This technique is useful in cases when source code is unavailable, if the software was not developed by you, or if you want to verify that the build phase did not introduce any new weaknesses. Examples include debuggers that directly attach to the running process; system-call tracing utilities such as truss (Solaris) and strace (Linux); system activity monitors such as FileMon, RegMon, Process Monitor, and other Sysinternals utilities (Windows); and sniffers and protocol analyzers that monitor network traffic. Attach the monitor to the process and perform a login. Using call trees or similar artifacts from the output, examine the associated behaviors and see if any of them appear to be comparing the input to a fixed string or value.::METHOD:Automated Static Analysis - Binary or Bytecode:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Bytecode Weakness Analysis - including disassembler + source code weakness analysis Binary Weakness Analysis - including disassembler + source code weakness analysis::METHOD:Manual Static Analysis - Binary or Bytecode:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Binary / Bytecode disassembler - then use manual analysis for vulnerabilities & anomalies::METHOD:Dynamic Analysis with Manual Results Interpretation:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Network Sniffer Forced Path Execution::METHOD:Manual Static Analysis - Source Code:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Focused Manual Spotcheck - Focused manual analysis of source Manual Source Code Review (not inspections)::METHOD:Automated Static Analysis - Source Code:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Source code Weakness Analyzer Context-configured Source Code Weakness Analyzer::METHOD:Automated Static Analysis:EFFECTIVENESS:SOAR Partial:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Cost effective for partial coverage: Configuration Checker::METHOD:Architecture or Design Review:EFFECTIVENESS:High:DESCRIPTION:According to SOAR, the following detection techniques may be useful: Highly cost effective: Inspection (IEEE 1028 standard) (can apply to requirements, design, source code, etc.) Formal Methods / Correct-By-Construction::
<h5>潜在的缓解措施</h5>阶段：体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：For出站身份验证：将密码、密钥和其他凭据保存在代码之外，保存在受强保护的加密配置文件或数据库中，防止所有外部人员(包括同一系统上的其他本地用户)访问。正确保护钥匙(CWE-320)。如果不能使用加密来保护文件，那么请确保权限尽可能具有限制性[ref-7]。In Windows environments，the Encrypted File System(EFS)may provide some protection.：：PHASE：Architecture and Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：For inbound authentication：Rather than hard-code a default username and password，key，or other authentication credentials for first time logins，utilize a first login mode that requires the user to enter a unique strong password or key.：：PHASE：Architecture and Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：If the software must contain hard-coded credentials or they cannot be removed，perform access control checks and limit which实体可以访问需要硬编码凭据的功能。例如，一个特性可能只能通过系统控制台而不是通过网络连接来启用。：阶段：体系结构和使用密码的Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：For入站身份验证：对密码应用强单向散列，并将这些散列存储在具有适当访问控制的配置文件或数据库中。这样，窃取文件/数据库仍然需要攻击者尝试破解密码。在身份验证期间处理传入密码时，获取密码的散列，并将其与保存的哈希进行比较。对生成的每个单独的散列使用随机分配的盐类。这增加了攻击者进行强力攻击所需的计算量，这可能限制了彩虹表方法的有效性。：相位：体系结构和Design：STRATEGY：：EFFECTIVENESS：：DESCRIPTION：For前端到后端连接：三种解决方案是可能的，尽管没有完全的解决方案。第一个建议涉及使用生成的密码或密钥，这些密码或密钥必须由系统管理员在给定的时间间隔内自动更改。这些密码将保存在内存中，并且只在时间间隔内有效。接下来，应该将密码或密钥限制在后端，仅执行对前端有效的操作，而不是完全访问。最后，发送的消息应该使用时间敏感值进行标记和校验，以防止重播式攻击。：
<h5>观察到的例子</h5>：：REFERENCE：CVE-2010-2772：DESCRIPTION：SCADA system uses a hard-coded password to protect back-end database containing authorization information，exploited by Stuxnet worm：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2010-2772REFERENCE：CVE-2010-2073：DESCRIPTION：FTP server library uses hard-coded usernames and passwords for three default accounts：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2010-2073REFERENCE：CVE-2010-1573：DESCRIPTION：Chain：Router firmware uses hard-coded username and password for access to debug functionality，which can be used to execute arbitrary code：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2010-1573REFERENCE：CVE-2008-2369：DESCRIPTION：Server uses hard-coded authentication key：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-2369REFERENCE：CVE-2008-0961：DESCRIPTION：Backup product uses hard-coded username and password，allowing attackers to bypass authentication via the RPC interface：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-0961REFERENCE：CVE-2008-1160：DESCRIPTION：Security appliance uses hard-codedpassword allowing attackers to gain root access：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2008-1160REFERENCE：CVE-2006-7142：DESCRIPTION：Drive encryption product stores hard-coded cryptographic keys for encrypted configuration files in executable programs：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2006-7142REFERENCE：CVE-2005-3716：DESCRIPTION：VoIP product uses unchangeable hard-coded public credentials that cannot be changed，which allows attackers to obtain sensitive information：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2005-3716REFERENCE：CVE-2005-3803：DESCRIPTION：VoIP product uses hard coded public and private SNMP community strings that cannot be changed，which allows remote attackers to obtain sensitive information：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2005-3803REFERENCE：CVE-2005-0496：DESCRIPTION：Backup product contains hard-coded credentials that effectively serve as a back door，，它允许远程攻击者访问文件system：LINK：https：//cve.mitre.org/cgi-bin/cvename.cgi？name=CVE-2005-0496。
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类名称：CET Java安全编码：条目ID：MSC 03-J：条目名称：从不硬编码敏感信息：
<h5>相关的攻击模式</h5>*190：191：70：
<h5>笔记</h5>空

