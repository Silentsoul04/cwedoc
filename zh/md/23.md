# ID: 23 - 相对路径遍历
<h5>名称</h5>相对路径遍历
<h5>弱点抽象</h5>底座
<h5>状态</h5>草案
<h5>描述</h5>该软件使用外部输入来构造一个路径名，该路径名应该位于受限制的目录中，但它不能正确地中和可以解析到该目录之外的位置的序列，例如.。
<h5>扩展描述</h5>这允许攻击者遍历文件系统访问受限目录之外的文件或目录。
<h5>相关的弱点</h5>*性质：子女：CWE ID：22：视图ID：1000：序数：初级：自然：子女：CWE ID：22：视图ID：699：序号：主：
<h5>弱点规律</h5>空
<h5>适用的平台</h5>*语言类：语言-独立：语言普及率：未定：
<h5>背景细节</h5>空
<h5>替代条款</h5>空
<h5>模式的介绍</h5>*阶段：执行：说明：
<h5>剥削因素</h5>空
<h5>利用的可能性</h5>空
<h5>常见的后果</h5>：：SCOPE：Integrity：SCOPE：Confidentiality：SCOPE：Availability：TECHNICAL影响：执行未经授权的代码或命令：注意：完整性机密性可用性执行未经授权的代码或命令攻击者可能能够创建或覆盖用于执行代码的关键文件，如程序或库。：范围：完整性：技术影响：修改文件或目录：注意：完整性修改文件或目录攻击者可能能够覆盖或创建关键文件，如程序、库或重要数据。如果目标文件用于安全机制，则攻击者可以绕过该机制。例如，在密码文件末尾追加一个新帐户可能允许攻击者绕过authentication.：：SCOPE：Confidentiality：TECHNICAL影响：读取文件或目录：注意：机密性读取文件或目录攻击者可能能够读取意外文件的内容并公开敏感数据。如果目标文件用于安全机制，则攻击者可以绕过该机制。例如，通过读取密码文件，攻击者可以进行强行密码猜测攻击，以便侵入系统上的帐户。：范围：可用性：技术影响：DoS：崩溃、退出或重新启动：注意：可用性DoS：崩溃、退出或重新启动攻击者可能能够覆盖、删除或损坏程序、库或重要数据等意外的关键文件。这可能会使软件根本无法工作，在认证等保护机制的情况下，软件有可能锁定软件的每个用户。
<h5>检测方法</h5>空
<h5>潜在的缓解措施</h5>*阶段：实施：战略：输入验证：有效性：描述：假设所有输入都是恶意的。使用接受已知的良好输入验证策略，即使用严格符合规范的可接受输入的白名单。拒绝任何不严格符合规范的输入，或将其转换为符合规范的输入。在执行输入验证时，要考虑所有可能相关的属性，包括长度、输入类型、可接受值的全部范围、缺少或额外的输入、语法、相关字段之间的一致性以及对业务规则的一致性。作为业务规则逻辑的一个示例，船在语法上可能是有效的，因为它只包含字母数字字符，但如果输入只包含红色或蓝色等颜色，则无效。不要完全依赖于寻找恶意或格式错误的输入(即，不要依赖黑名单)。黑名单可能至少漏掉一个不受欢迎的输入，特别是当代码的环境发生变化时。这可以让攻击者有足够的空间绕过预期的验证。然而，黑名单可能有助于检测潜在的攻击，或确定哪些输入格式非常错误，应该立即予以拒绝。验证文件名时，请使用严格的白名单来限制要使用的字符集。如果可行，只允许文件名中只有一个.字符以避免诸如CWE-23之类的缺陷，并排除目录分隔符(例如/以避免CWE-36)。使用允许的文件扩展名白名单，这将有助于避免CWE-434。不要完全依赖删除潜在危险字符的筛选机制。这相当于一份可能不完整的黑名单(CWE-184)。例如，如果文件系统也支持使用“作为目录分隔符”，则筛选/保护不足。另一个可能的错误是，当应用过滤时仍然会产生危险的数据(CWE-182)。例如，如果./序列以顺序的方式从./字符串中删除，则./的两个实例将从原始字符串中删除，但剩余的字符仍将形成./String.：阶段：实现：输入验证：有效性：描述：输入应该在验证之前解码并规范化到应用程序当前的内部表示(CWE-180)。确保应用程序不会对相同的输入进行两次解码(CWE-174)。这些错误可以用来绕过白名单验证方案，在检查后引入危险的输入。使用内建路径规范化函数(如C中的realpath()，生成路径名称的规范版本，从而有效地删除.序列和符号链接(CWE-23，CWE-59)。这包括：C中的realpath()，JavaGetFullPath()中的getCanonicalPath()，ASP.NET中的GetFullPath()，或者PHP中Perl realpath()中的abs_path()：
<h5>观察到的例子</h5>::REFERENCE:CVE-2002-0298:DESCRIPTION:Server allows remote attackers to cause a denial of service via certain HTTP GET requests containing a %2e%2e (encoded dot-dot), several /../ sequences, or several ../ in a URI.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0298REFERENCE:CVE-2002-0661:DESCRIPTION:not in blacklist for web server, allowing path traversal attacks when the server is run in Windows and other OSes.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0661REFERENCE:CVE-2002-0946:DESCRIPTION:Arbitrary files may be read files via .. (dot dot) sequences in an HTTP request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0946REFERENCE:CVE-2002-1042:DESCRIPTION:Directory traversal vulnerability in search engine for web server allows remote attackers to read arbitrary files via .. sequences in queries.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1042REFERENCE:CVE-2002-1209:DESCRIPTION:Directory traversal vulnerability in FTP server allows remote attackers to read arbitrary files via .. sequences in a GET request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1209REFERENCE:CVE-2002-1178:DESCRIPTION:Directory traversal vulnerability in servlet allows remote attackers to execute arbitrary commands via .. sequences in an HTTP request.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1178REFERENCE:CVE-2002-1987:DESCRIPTION:Protection mechanism checks for /.. but doesn't account for Windows-specific .. allowing read of arbitrary files.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-1987REFERENCE:CVE-2005-2142:DESCRIPTION:Directory traversal vulnerability in FTP server allows remote authenticated attackers to list arbitrary directories via a .. sequence in an LS command.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2142REFERENCE:CVE-2002-0160:DESCRIPTION:The administration function in Access Control Server allows remote attackers to read HTML, Java class, and image files outside the web root via a .... sequence in the URL to port 2002.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0160REFERENCE:CVE-2001-0467:DESCRIPTION:... in web server:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0467REFERENCE:CVE-2001-0963:DESCRIPTION:... in cd command in FTP server:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0963REFERENCE:CVE-2001-1193:DESCRIPTION:... in cd command in FTP server:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1193REFERENCE:CVE-2001-1131:DESCRIPTION:... in cd command in FTP server:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-1131REFERENCE:CVE-2001-0480:DESCRIPTION:read of arbitrary files and directories using GET or CD with ... in Windows-based FTP server.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0480REFERENCE:CVE-2002-0288:DESCRIPTION:read files using . and Unicode-encoded / or characters in the URL.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-0288REFERENCE:CVE-2003-0313:DESCRIPTION:Directory listing of web server using ...:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-0313REFERENCE:CVE-2005-1658:DESCRIPTION:Triple dot:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1658REFERENCE:CVE-2000-0240:DESCRIPTION:read files via /........../ in URL:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0240REFERENCE:CVE-2000-0773:DESCRIPTION:read files via .... in web server:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0773REFERENCE:CVE-1999-1082:DESCRIPTION:read files via ...... in web server (doubled triple dot?):LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1082REFERENCE:CVE-2004-2121:DESCRIPTION:read files via ...... in web server (doubled triple dot?):LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2121REFERENCE:CVE-2001-0491:DESCRIPTION:multiple attacks using .., ..., and .... in different commands:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0491REFERENCE:CVE-2001-0615:DESCRIPTION:... or .... in chat server:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0615REFERENCE:CVE-2005-2169:DESCRIPTION:chain: .../...// bypasses protection mechanism using regexp's that remove ../ resulting in collapse into an unsafe value ../ (CWE-182) and resultant path traversal.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2169REFERENCE:CVE-2005-0202:DESCRIPTION:.../..../// bypasses regexp's that remove ./ and ../:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0202REFERENCE:CVE-2004-1670:DESCRIPTION:Mail server allows remote attackers to create arbitrary directories via a .. or rename arbitrary files via a ....// in user supplied parameters.:LINK:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-1670
<h5>功能区域</h5>空
<h5>影响资源</h5>空
<h5>分类法映射</h5>分类名称：plover：条目名称：相对路径遍历：分类法名称：软件故障模式：条目ID：SFP 16：条目名称：路径遍历：
<h5>相关的攻击模式</h5>*139：23：76：
<h5>笔记</h5>空

